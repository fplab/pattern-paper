% !TEX root = ./patterns-paper.tex
\begin{figure}[h]
$\arraycolsep=4pt\begin{array}{lll}
\tau & ::= &
  \tnum ~\vert~
  \tarr{\tau_1}{\tau_2} ~\vert~
  \tprod{\tau_1}{\tau_2} ~\vert~
  \tsum{\tau_1}{\tau_2} ~\vert~
  \tunit ~\vert~
  \tvoid \\
e & ::= &
  x ~\vert~
  \hnum{n} \\
  & ~\vert~ &
  \hlam{x}{\tau}{e} ~\vert~
  \hap{e_1}{e_2} \\
  & ~\vert~ &
  \hpair{e_1}{e_2} ~\vert~
  \htriv \\
  & ~\vert~ &
  \hinl{\tau}{e} ~\vert~
  \hinr{\tau}{e} ~\vert~
  \hmatch{e}{rs} \\
rs & ::= &
  \cdot ~\vert~ \hrules{r}{rs'} \\
r & ::= &
  \hrul{p}{e} \\
p & ::= &
  x ~\vert~
  \_ ~\vert~
  \hpair{p_1}{p_2} ~\vert~
  \htriv ~\vert~
  \hinlp{p} ~\vert~
  \hinrp{p}
\end{array}$
\end{figure}

\begin{figure}[h]
\fbox{$\hexptyp{\Gamma}{e}{\tau}$}
\begin{subequations}
\begin{equation}
  \inferrule[VAR]{ }{
    \hexptyp{\Gamma, x : \tau}{x}{\tau}
  }
\end{equation}
\begin{equation}
\inferrule[LAM]{
  \hexptyp{\Gamma, x : \tau_1}{e}{\tau_2}
}{
  \hexptyp{\Gamma}{\hlam{x}{\tau_1}{e}}{\tarr{\tau_1}{\tau_2}}
}
\end{equation}
\begin{equation}
\inferrule[AP]{
  \hexptyp{\Gamma}{e_1}{\tarr{\tau_2}{\tau}} \\
  \hexptyp{\Gamma}{e_2}{\tau_2}
}{
  \hexptyp{\Gamma}{\hap{e_1}{e_2}}{\tau}
}
\end{equation}
\begin{equation}
\inferrule[PAIR]{
  \hexptyp{\Gamma}{e_1}{\tau_1} \\
  \hexptyp{\Gamma}{e_2}{\tau_2}
}{
  \hexptyp{\Gamma}{\hpair{e_1}{e_2}}{\tprod{\tau_1}{\tau_2}}
}
\end{equation}
\begin{equation}
\inferrule[TRIV]{ }{
  \hexptyp{\Gamma}{\htriv}{\tunit}
}
\end{equation}
\begin{equation}
\inferrule[INL]{
  \hexptyp{\Gamma}{e}{\tau_1}
}{
  \hexptyp{\Gamma}{\hinl{\tau_2}{e}}{\tsum{\tau_1}{\tau_2}}
}
\end{equation}
\begin{equation}
\inferrule[INR]{
  \hexptyp{\Gamma}{e}{\tau_2}
}{
  \hexptyp{\Gamma}{\hinr{\tau_1}{e}}{\tsum{\tau_1}{\tau_2}}
}
\end{equation}
\begin{equation}
\inferrule[MATCH]{
  \hexptyp{\Gamma}{e_1}{\tau_1} \\
  \hexptyp{\Gamma}{rs}{\trul{\tau_1}{\tau}}
}{
  \hexptyp{\Gamma}{\hmatch{e_1}{rs}}{\tau}
}
\end{equation}
\end{subequations}
\end{figure}

\begin{figure}[h]
\fbox{$\hexptyp{\Gamma}{rs}{\hrul{\tau_1}{\tau_2}}$}
\begin{subequations}
\begin{equation}
\inferrule[RULE]{
  \hpattyp{p}{\tau_1}{\Gamma'} \\
  \hexptyp{\Gamma \uplus \Gamma'}{e}{\tau_2}
}{
  \hexptyp{\Gamma}{\hrul{p}{e}}{\hrul{\tau_1}{\tau_2}}
}
\end{equation}
\begin{equation}
\inferrule[RULES]{
  \hexptyp{\Gamma}{r}{\hrul{\tau_1}{\tau_2}} \\
  \hexptyp{\Gamma}{rs'}{\hrul{\tau_1}{\tau_2}}
}{
  \hexptyp{\Gamma}{\hrules{r}{rs'}}{\hrul{\tau_1}{\tau_2}}
}
\end{equation}
\end{subequations}
\end{figure}

\begin{figure}[h]
\fbox{$\hpattyp{p}{\tau}{\Gamma}$}
\begin{subequations}
\begin{equation}
\inferrule[VAR]{ }{
  \hpattyp{x}{\tau}{x : \tau}
}
\end{equation}
\begin{equation}
\inferrule[WILD]{ }{
  \hpattyp{\_}{\tau}{\cdot}
}
\end{equation}
\begin{equation}
\inferrule[PAIR]{
  \hpattyp{p_1}{\tau_1}{\Gamma_1} \\
  \hpattyp{p_2}{\tau_2}{\Gamma_2}
}{
  \hpattyp{\hpair{p_1}{p_2}}{\tprod{\tau_1}{\tau_2}}{\Gamma_1 \uplus \Gamma_2}
}
\end{equation}
\begin{equation}
\inferrule[TRIV]{ }{
  \hpattyp{\htriv}{\tunit}{\cdot}
}
\end{equation}
\begin{equation}
\inferrule[INL]{
  \hpattyp{p}{\tau_1}{\Gamma}
}{
  \hpattyp{\hinlp{p}}{\tsum{\tau_1}{\tau_2}}{\Gamma}
}
\end{equation}
\begin{equation}
\inferrule[INR]{
  \hpattyp{p}{\tau_2}{\Gamma}
}{
  \hpattyp{\hinrp{p}}{\tsum{\tau_1}{\tau_2}}{\Gamma}
}
\end{equation}
\end{subequations}
\end{figure}