\section{Dynamic Semantics}
\judgboxa{\isVal{e}}{$e$ is a value}
\begin{subequations}\label{rules:Value}
\begin{equation}\label{rule:VNum}
\inferrule[VNum]{ }{
  \isVal{\hnum{n}}
}
\end{equation}
\begin{equation}\label{rule:VLam}
\inferrule[VLam]{ }{
  \isVal{\hlam{x}{\tau}{e}}
}
\end{equation}
\begin{equation}\label{rule:VPair}
\inferrule[VPair]{
  \isVal{e_1} \\
  \isVal{e_2}
}{\isVal{\hpair{e_1}{e_2}}}
\end{equation}
\begin{equation}\label{rule:VInl}
\inferrule[VInl]{
  \isVal{e}
}{
  \isVal{\hinl{\tau}{e}}
}
\end{equation}
\begin{equation}\label{rule:VInr}
\inferrule[VInr]{
  \isVal{e}
}{
  \isVal{\hinr{\tau}{e}}
}
\end{equation}
\end{subequations}

\judgboxa{\isIndet{e}}{$e$ is indeterminate}
\begin{subequations}\label{rules:Indet}
\begin{equation}\label{rule:IEHole}
\inferrule[IEHole]{ }{
  \isIndet{\hehole{u}}
}
\end{equation}
\begin{equation}\label{rule:IHole}
\inferrule[IHole]{
  \isFinal{e}
}{
  \isIndet{\hhole{e}{u}}
}
\end{equation}
\begin{equation}\label{rule:IAp}
\inferrule[IAp]{
  \isIndet{e_1} \\ \isFinal{e_2}
}{
  \isIndet{\hap{e_1}{e_2}}
}
\end{equation}
\begin{equation}\label{rule:IPairL}
\inferrule[IPairL]{
  \isIndet{e_1} \\ \isVal{e_2}
}{
  \isIndet{\hpair{e_1}{e_2}}
}
\end{equation}
\begin{equation}\label{rule:IPairR}
\inferrule[IPairR]{
  \isVal{e_1} \\
  \isIndet{e_2}
}{
  \isIndet{\hpair{e_1}{e_2}}
}
\end{equation}
\begin{equation}\label{rule:IPair}
\inferrule[IPair]{
  \isIndet{e_1} \\ \isIndet{e_2}
}{
  \isIndet{\hpair{e_1}{e_2}}
}
\end{equation}
\begin{equation}\label{rule:IPrl}
\inferrule[IPrl]{
  \isIndet{e}
}{
  \isIndet{\hprl{e}}
}
\end{equation}
\begin{equation}\label{rule:IPrr}
\inferrule[IPrr]{
  \isIndet{e}
}{
  \isIndet{\hprr{e}}
}
\end{equation}
\begin{equation}\label{rule:IInl}
\inferrule[IInL]{
  \isIndet{e}
}{
  \isIndet{\hinl{\tau}{e}}
}
\end{equation}
\begin{equation}\label{rule:IInr}
\inferrule[IInR]{
  \isIndet{e}
}{
  \isIndet{\hinr{\tau}{e}}
}
\end{equation}
\begin{equation}\label{rule:IMatch}
\inferrule[IMatch]{
  \isFinal{e} \\
  \hmaymatch{e}{p_r}
}{
  \isIndet{
    \hmatch{e}{\zruls{rs_{pre}}{\hrulP{p_r}{e_r}}{rs_{post}}}
  }
}
\end{equation}
\end{subequations}

\judgboxa{\isFinal{e}}{$e$ is final}
\begin{subequations}\label{rules:Final}
  \begin{equation}\label{rule:FVal}
\inferrule[FVal]{
  \isVal{e}
}{
  \isFinal{e}
}
\end{equation}
\begin{equation}\label{rule:FIndet}
\inferrule[FIndet]{
  \isIndet{e}
}{
  \isFinal{e}
}
\end{equation}
\end{subequations}

\judgboxa{
  \notIntro{e}
}{
  $e$ cannot be a value syntactically
}
\begin{subequations}\label{rules:notintro}
\begin{equation}\label{rule:NVEHole}
\inferrule[NVEHole]{ }{
  \notIntro{\hehole{u}}
}
\end{equation}
\begin{equation}\label{rule:NVHole}
\inferrule[NVHole]{ }{
  \notIntro{\hhole{e}{u}}
}
\end{equation}
\begin{equation}\label{rule:NVAp}
\inferrule[NVAp]{ }{
  \notIntro{\hap{e_1}{e_2}}
}
\end{equation}
\begin{equation}\label{rule:NVMatch}
\inferrule[NVMatch]{ }{
  \notIntro{\hmatch{e}{\zrules}}
}
\end{equation}
\begin{equation}\label{rule:NVPrl}
\inferrule[NVPrl]{ }{
  \notIntro{\hprl{e}}
}
\end{equation}
\begin{equation}\label{rule:NVPrr}
\inferrule[NVPrr]{ }{
  \notIntro{\hprr{e}}
}
\end{equation}
\end{subequations}

\judgboxa{
  \inValues{e'}{e}
}{
  $e'$ is one of the possible values of $e$
}
\begin{subequations}\label{rules:inValues}
  \begin{equation}\label{rule:IVVal}
    \inferrule[IVVal]{
      \isVal{e} \\
      \hexptyp{\cdot}{\Delta}{e}{\tau}
    }{
      \inValues{e}{e}
    }
  \end{equation}
  \begin{equation}\label{rule:IVIndet}
    \inferrule[IVIndet]{
      \notIntro{e} \\
      \hexptyp{\cdot}{\Delta}{e}{\tau} \\
      \isVal{e'} \\
      \hexptyp{\cdot}{\Delta}{e'}{\tau}
    }{
      \inValues{e'}{e}
    }
  \end{equation}
  \begin{equation}\label{rule:IVInl}
    \inferrule[IVInl]{
      \isIndet{\hinl{\tau_2}{e_1}} \\
      \hexptyp{\cdot}{\Delta}{\hinl{\tau_2}{e_1}}{\tau} \\
      \inValues{e_1'}{e_1} \\
    }{ 
      \inValues{\hinl{\tau_2}{e_1'}}{\hinl{\tau_2}{e_1}}
    }
  \end{equation}
  \begin{equation}\label{rule:IVInr}
    \inferrule[IVInr]{
      \isIndet{\hinr{\tau_1}{e_2}} \\
      \hexptyp{\cdot}{\Delta}{\hinr{\tau_1}{e_2}}{\tau} \\
      \inValues{e_2'}{e_2} \\
    }{ 
      \inValues{\hinr{\tau_1}{e_2'}}{\hinr{\tau_1}{e_2}}
    }
  \end{equation}
  \begin{equation}\label{rule:IVPair}
    \inferrule[IVPair]{
      \isIndet{\hpair{e_1}{e_2}} \\
      \hexptyp{\cdot}{\Delta}{\hpair{e_1}{e_2}}{\tau} \\
      \inValues{e_1'}{e_1} \\
      \inValues{e_2'}{e_2}
    }{
      \inValues{\hpair{e_1'}{e_2'}}{\hpair{e_1}{e_2}}
    }
  \end{equation}
\end{subequations}

\begin{lemma}
  \label{lem:complete-not-satormay}
  If $\isIndet{e}$ and $\hexptyp{\cdot}{\Delta}{e}{\tau}$ and $\ctyp{\hxi}{\tau}$ and $\cnotsatisfyormay{e}{\hxi}$
  then $\cnotsatisfyormay{e'}{\hxi}$ for all $e'\in\expcomplete{e}$.
\end{lemma}
\begin{proof}
  \begin{pfsteps*}
  \item $\isIndet{e}$ \BY{assumption} \pflabel{eindet}
  \item $\hexptyp{\cdot}{\Delta}{e}{\tau}$ \BY{assumption} \pflabel{etyp}
  \item $\ctyp{\hxi}{\tau}$ \BY{assumption} \pflabel{ctyp}
  \item $\cnotsatisfyormay{e}{\hxi}$ \BY{assumption} \pflabel{not-satormay}
  \end{pfsteps*}
  By rule induction over \rulesref{rules:CTyp} on \pfref{ctyp}.
  \begin{byCases}
    \savelocalsteps{0}
    \item[\text{(\ref{rule:CTTruth})}]
    \begin{pfsteps*}
    \item $\hxi = \ctruth$ \BY{assumption}
    \item $\csatisfy{e}{\ctruth}$ \BY{\ruleref{rule:CSTruth}} \pflabel{[truth]sat}
    \item $\csatisfyormay{e}{\ctruth}$ \BY{\ruleref{rule:CSMSSat} on \pfref{[truth]sat}}
    \end{pfsteps*}
    Contradicts \pfref{not-satormay}.
    \restorelocalsteps{0}
    \item[\text{(\ref{rule:CTUnknown})}]
    \begin{pfsteps*}
    \item $\hxi = \cunknown$ \BY{assumption}
    \item $\cmaysatisfy{e}{\cunknown}$ \BY{\ruleref{rule:CMSUnknown}} \pflabel{[unknown]maysat}
    \item $\csatisfyormay{e}{\cunknown}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[unknown]maysat}}
    \end{pfsteps*}
    Contradicts \pfref{not-satormay}.
    \restorelocalsteps{0}
    \item[\text{(\ref{rule:CTNum})}]
    \begin{pfsteps*}
    \item $\hxi = \cnum{n}$ \BY{assumption}
    \item $\tau = \tnum$ \BY{assumption}
    \item $\refutable{\cnum{n}}$ \BY{\ruleref{rule:RXNum}} \pflabel{[num]refutable}
    \end{pfsteps*}
    By rule induction over \rulesref{rules:Indet} on \pfref{eindet}.
    \begin{byCases}
      \savelocalsteps{1}
      \item[\text{(\ref{rule:IEHole})}]
      \begin{pfsteps*}
      \item $e=\hehole{u}$ \BY{assumption}
      \item $\notIntro{\hehole{u}}$ \BY{\ruleref{rule:NVEHole}} \pflabel{[ehole]notintro}
      \item $\cmaysatisfy{\hehole{u}}{\cnum{n}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[ehole]notintro} and \pfref{[num]refutable}} \pflabel{[ehole][num]maysat}
      \item $\csatisfyormay{\hehole{u}}{\cnum{n}}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[ehole][num]maysat}}
      \end{pfsteps*}
      Contradicts \pfref{not-satormay}.
      \restorelocalsteps{1}
      \item[\text{(\ref{rule:IHole})}]
      \begin{pfsteps*}
      \item $e=\hhole{e_1}{u}$ \BY{assumption}
      \item $\notIntro{\hhole{e_1}{u}}$ \BY{\ruleref{rule:NVHole}} \pflabel{[hole]notintro}
      \item $\cmaysatisfy{\hhole{e_1}{u}}{\cnum{n}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[hole]notintro} and \pfref{[num]refutable}} \pflabel{[hole][num]maysat}
      \item $\csatisfyormay{\hhole{e_1}{u}}{\cnum{n}}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[hole][num]maysat}}
      \end{pfsteps*} 
      Contradicts \pfref{not-satormay}.
      \restorelocalsteps{1}
      \item[\text{(\ref{rule:IAp})}]
      \begin{pfsteps*}
      \item $e=\hap{e_1}{e_2}$ \BY{assumption}
      \item $\notIntro{\hap{e_1}{e_2}}$ \BY{\ruleref{rule:NVAp}} \pflabel{[ap]notintro}
      \item $\cmaysatisfy{\hap{e_1}{e_2}}{\cnum{n}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[ap]notintro} and \pfref{[num]refutable}} \pflabel{[ap][num]maysat}
      \item $\csatisfyormay{\hap{e_1}{e_2}}{\cnum{n}}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[ap][num]maysat}}
      \end{pfsteps*} 
      Contradicts \pfref{not-satormay}.
      \restorelocalsteps{1}
      \item[\text{(\ref{rule:IPrl})}]
      \begin{pfsteps*}
      \item $e=\hprl{e_1}$ \BY{assumption}
      \item $\notIntro{\hprl{e_1}}$ \BY{\ruleref{rule:NVPrl}} \pflabel{[prl]notintro}
      \item $\cmaysatisfy{\hprl{e_1}}{\cnum{n}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[prl]notintro} and \pfref{[num]refutable}} \pflabel{[prl][num]maysat}
      \item $\csatisfyormay{\hprl{e_1}}{\cnum{n}}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[prl][num]maysat}}
      \end{pfsteps*} 
      Contradicts \pfref{not-satormay}.
      \restorelocalsteps{1}
      \item[\text{(\ref{rule:IPrr})}]
      \begin{pfsteps*}
      \item $e=\hprr{e_1}$ \BY{assumption}
      \item $\notIntro{\hprr{e_1}}$ \BY{\ruleref{rule:NVPrr}} \pflabel{[prr]notintro}
      \item $\cmaysatisfy{\hprr{e_1}}{\cnum{n}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[prr]notintro} and \pfref{[num]refutable}} \pflabel{[prr][num]maysat}
      \item $\csatisfyormay{\hprr{e_1}}{\cnum{n}}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[prr][num]maysat}}
      \end{pfsteps*} 
      Contradicts \pfref{not-satormay}.
      \restorelocalsteps{1}
      \item[\text{(\ref{rule:IMatch})}]
      \begin{pfsteps*}
      \item $e=\hmatch{e_1}{\zrules}$ \BY{assumption}
      \item $\notIntro{\hmatch{e_1}{\zrules}}$ \BY{\ruleref{rule:NVMatch}} \pflabel{[match]notintro}
      \item $\cmaysatisfy{\hmatch{e_1}{\zrules}}{\cnum{n}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[match]notintro} and \pfref{[num]refutable}} \pflabel{[match][num]maysat}
      \item $\csatisfyormay{\hmatch{e_1}{\zrules}}{\cnum{n}}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[match][num]maysat}}
      \end{pfsteps*} 
      Contradicts \pfref{not-satormay}.
      \restorelocalsteps{1}
      \item[\text{(\ref{rule:IPairL}), (\ref{rule:IPairR}), (\ref{rule:IPair})}] 
      \begin{pfsteps*}
      \item $e=\hpair{e_1}{e_2}$ \BY{assumption}
      \end{pfsteps*} 
      By rule induction over \rulesref{rules:TExp} on \pfref{etyp}, no rule applies due to syntactic contradiction.
      \restorelocalsteps{1}
      \item[\text{(\ref{rule:IInl})}] 
      \begin{pfsteps*}
      \item $e=\hinl{\tau_2}{e_1}$ \BY{assumption}
      \end{pfsteps*} 
      By rule induction over \rulesref{rules:TExp} on \pfref{etyp}, no rule applies due to syntactic contradiction.
      \restorelocalsteps{1}
      \item[\text{(\ref{rule:IInr})}] 
      \begin{pfsteps*}
      \item $e=\hinr{\tau_1}{e_2}$ \BY{assumption}
      \end{pfsteps*} 
      By rule induction over \rulesref{rules:TExp} on \pfref{etyp}, no rule applies due to syntactic contradiction.
    \end{byCases}
    \restorelocalsteps{0}
    \item[\text{(\ref{rule:CTInl})}]
    \begin{pfsteps*}
      \item $\hxi = \cinl{\hxi_1}$ \BY{assumption}
      \item $\tau = \tsum{\tau_1}{\tau_2}$ \BY{assumption}
      \item $\ctyp{\hxi_1}{\tau_1}$ \BY{assumption} \pflabel{[inl]c1typ}
      \item $\refutable{\cinl{\hxi_1}}$ \BY{\ruleref{rule:RXInl}} \pflabel{[inl]refutable}
      \end{pfsteps*}
      By rule induction over \rulesref{rules:Indet} on \pfref{eindet}.
      \begin{byCases}
        \savelocalsteps{1}
        \item[\text{(\ref{rule:IEHole})}]
        \begin{pfsteps*}
        \item $e=\hehole{u}$ \BY{assumption}
        \item $\notIntro{\hehole{u}}$ \BY{\ruleref{rule:NVEHole}} \pflabel{[ehole][inl]notintro}
        \item $\cmaysatisfy{\hehole{u}}{\cinl{\hxi_1}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[ehole][inl]notintro} and \pfref{[inl]refutable}} \pflabel{[ehole][inl]maysat}
        \item $\csatisfyormay{\hehole{u}}{\cinl{\hxi_1}}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[ehole][inl]maysat}}
        \end{pfsteps*}
        Contradicts \pfref{not-satormay}.
        \restorelocalsteps{1}
        \item[\text{(\ref{rule:IHole})}]
        \begin{pfsteps*}
        \item $e=\hhole{e_1}{u}$ \BY{assumption}
        \item $\notIntro{\hhole{e_1}{u}}$ \BY{\ruleref{rule:NVHole}} \pflabel{[hole][inl]notintro}
        \item $\cmaysatisfy{\hhole{e_1}{u}}{\cinl{\hxi_1}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[hole][inl]notintro} and \pfref{[inl]refutable}} \pflabel{[hole][inl]maysat}
        \item $\csatisfyormay{\hhole{e_1}{u}}{\cinl{\hxi_1}}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[hole][inl]maysat}}
        \end{pfsteps*} 
        Contradicts \pfref{not-satormay}.
        \restorelocalsteps{1}
        \item[\text{(\ref{rule:IAp})}]
        \begin{pfsteps*}
        \item $e=\hap{e_1}{e_2}$ \BY{assumption}
        \item $\notIntro{\hap{e_1}{e_2}}$ \BY{\ruleref{rule:NVAp}} \pflabel{[ap][inl]notintro}
        \item $\cmaysatisfy{\hap{e_1}{e_2}}{\cinl{\hxi_1}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[ap][inl]notintro} and \pfref{[inl]refutable}} \pflabel{[ap][inl]maysat}
        \item $\csatisfyormay{\hap{e_1}{e_2}}{\cinl{\hxi_1}}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[ap][inl]maysat}}
        \end{pfsteps*} 
        Contradicts \pfref{not-satormay}.
        \restorelocalsteps{1}
        \item[\text{(\ref{rule:IPrl})}]
        \begin{pfsteps*}
        \item $e=\hprl{e_1}$ \BY{assumption}
        \item $\notIntro{\hprl{e_1}}$ \BY{\ruleref{rule:NVPrl}} \pflabel{[prl][inl]notintro}
        \item $\cmaysatisfy{\hprl{e_1}}{\cinl{\hxi_1}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[prl][inl]notintro} and \pfref{[inl]refutable}} \pflabel{[prl][inl]maysat}
        \item $\csatisfyormay{\hprl{e_1}}{\cinl{\hxi_1}}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[prl][inl]maysat}}
        \end{pfsteps*} 
        Contradicts \pfref{not-satormay}.
        \restorelocalsteps{1}
        \item[\text{(\ref{rule:IPrr})}]
        \begin{pfsteps*}
        \item $e=\hprr{e_1}$ \BY{assumption}
        \item $\notIntro{\hprr{e_1}}$ \BY{\ruleref{rule:NVPrr}} \pflabel{[prr][inl]notintro}
        \item $\cmaysatisfy{\hprr{e_1}}{\cinl{\hxi_1}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[prr][inl]notintro} and \pfref{[inl]refutable}} \pflabel{[prr][inl]maysat}
        \item $\csatisfyormay{\hprr{e_1}}{\cinl{\hxi_1}}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[prr][inl]maysat}}
        \end{pfsteps*} 
        Contradicts \pfref{not-satormay}.
        \restorelocalsteps{1}
        \item[\text{(\ref{rule:IMatch})}]
        \begin{pfsteps*}
        \item $e=\hmatch{e_1}{\zrules}$ \BY{assumption}
        \item $\notIntro{\hmatch{e_1}{\zrules}}$ \BY{\ruleref{rule:NVMatch}} \pflabel{[match][inl]notintro}
        \item $\cmaysatisfy{\hmatch{e_1}{\zrules}}{\cinl{\hxi_1}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[match][inl]notintro} and \pfref{[inl]refutable}} \pflabel{[match][inl]maysat}
        \item $\csatisfyormay{\hmatch{e_1}{\zrules}}{\cinl{\hxi_1}}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[match][inl]maysat}}
        \end{pfsteps*} 
        Contradicts \pfref{not-satormay}.
        \restorelocalsteps{1}
        \item[\text{(\ref{rule:IPairL}), (\ref{rule:IPairR}), (\ref{rule:IPair})}] 
        \begin{pfsteps*}
        \item $e=\hpair{e_1}{e_2}$ \BY{assumption}
        \end{pfsteps*} 
        By rule induction over \rulesref{rules:Indet} on \pfref{eindet}, no rule applies due to syntactic contradiction.
        \restorelocalsteps{1}
        \item[\text{(\ref{rule:IInl})}] 
        \begin{pfsteps*}
        \item $e=\hinl{\tau_2'}{e_1}$ \BY{assumption}
        \item $\isIndet{e_1}$ \BY{assumption} \pflabel{[inl]e1indet}
        \end{pfsteps*} 
        By rule induction over \rulesref{rules:TExp} on \pfref{etyp}, only one rule applies.
        \begin{byCases}
          \item[\text{(\ref{rule:TInl})}]
          \begin{pfsteps*}
          \item $\tau_2'=\tau_2$ \BY{assumption}
          \item $\hexptyp{\cdot}{\Delta}{e_1}{\tau_1}$ \BY{assumption} \pflabel{[inl]e1typ}
          \item $\cnotsatisfyormay{e_1}{\hxi_1}$ \BY{\autoref{lem:satormay-inl} on \pfref{not-satormay}} \pflabel{[inl]not-satormay1}
          \item if $\inValues{e_1'}{e_1}$ then $\cnotsatisfyormay{e_1'}{\hxi_1}$ \BY{IH on \pfref{[inl]e1indet} and \pfref{[inl]e1typ} and \pfref{[inl]c1typ} and \pfref{[inl]not-satormay1}} \pflabel{[inl]forall1}
          \end{pfsteps*} 
          To show if $\inValues{e'}{\hinl{\tau_2}{e_1}}$ then $\cnotsatisfyormay{e'}{\cinl{\hxi_1}}$, we assume $\inValues{e'}{\hinl{\tau_2}{e_1}}$.
          \begin{pfsteps*}
          \item $\inValues{e'}{\hinl{\tau_2}{e_1}}$ \BY{assumption} \pflabel{[inl]invalues}
          \end{pfsteps*}
          By rule induction over \rulesref{rules:inValues} on \pfref{[inl]invalues}.
          \begin{byCases}
            \savelocalsteps{2}
            \item[\text{(\ref{rule:IVVal})}]
            \begin{pfsteps*}
            \item $\isVal{\hinl{\tau_2}{e_1}}$ \BY{assumption}
            \end{pfsteps*} 
            Contradicts \pfref{eindet} by \autoref{lem:val-not-indet}.
            \restorelocalsteps{2} 
            \item[\text{(\ref{rule:IVIndet})}] 
            \begin{pfsteps*}
            \item $\notIntro{\hinl{\tau_2}{e_1}}$ \BY{assumption}
            \end{pfsteps*} 
            Contradicts \autoref{lem:no-inl-notintro}
            \restorelocalsteps{2}
            \item[\text{(\ref{rule:IVInl})}] 
            \begin{pfsteps*}
            \item $e'=\hinl{\tau_2}{e_1'}$ \BY{assumption}
            \item $\inValues{e_1'}{e_1}$ \BY{assumption} \pflabel{[inl]invalues1}
            \item $\cnotsatisfyormay{e_1'}{\hxi_1}$ \BY{\pfref{[inl]forall1} on \pfref{[inl]invalues1}} \pflabel{[inl]not-satormay1'}
            \item $\cnotsatisfyormay{\hinl{\tau_2}{e_1'}}{\cinl{\hxi_1}}$ \BY{\autoref{lem:satormay-inl} on \pfref{[inl]not-satormay1'}}
            \end{pfsteps*} 
          \end{byCases}
        \end{byCases}
        \restorelocalsteps{1}
        \item[\text{(\ref{rule:IInr})}] 
        \begin{pfsteps*}
        \item $e=\hinr{\tau_1}{e_2}$ \BY{assumption}
        \end{pfsteps*}
        To show if $\inValues{e'}{\hinr{\tau_1}{e_2}}$ then $\cnotsatisfyormay{e'}{\cinl{\hxi_1}}$, we assume $\inValues{e'}{\hinr{\tau_1}{e_2}}$.
        \begin{pfsteps*}
        \item $\inValues{e'}{\hinr{\tau_1}{e_2}}$ \BY{assumption} \pflabel{[inr]invalues}
        \end{pfsteps*}
        By rule induction over \rulesref{rules:inValues} on \pfref{[inr]invalues}.
        \begin{byCases}
          \savelocalsteps{2}
          \item[\text{(\ref{rule:IVVal})}]
          \begin{pfsteps*}
          \item $\isVal{\hinr{\tau_1}{e_2}}$ \BY{assumption}
          \end{pfsteps*} 
          Contradicts \pfref{eindet} by \autoref{lem:val-not-indet}.
          \restorelocalsteps{2} 
          \item[\text{(\ref{rule:IVIndet})}] 
          \begin{pfsteps*}
          \item $\notIntro{\hinr{\tau_1}{e_2}}$ \BY{assumption}
          \end{pfsteps*} 
          Contradicts \autoref{lem:no-inr-notintro}
          \restorelocalsteps{2}
          \item[\text{(\ref{rule:IVInr})}] 
          \begin{pfsteps*}
          \item $e'=\hinr{\tau_1}{e_2'}$ \BY{assumption}
          \item $\cnotsatisfyormay{\hinr{\tau_1}{e_2'}}{\cinl{\hxi_1}}$ \BY{\autoref{lem:inr-notsatormay-inl}}
          \end{pfsteps*} 
        \end{byCases}
      \end{byCases} 
    \restorelocalsteps{0}
    \item[\text{(\ref{rule:CTInr})}]
    \begin{pfsteps*}
      \item $\hxi = \cinr{\hxi_2}$ \BY{assumption}
      \item $\tau = \tsum{\tau_1}{\tau_2}$ \BY{assumption}
      \item $\ctyp{\hxi_2}{\tau_2}$ \BY{assumption} \pflabel{[inr]c2typ}
      \item $\refutable{\cinr{\hxi_2}}$ \BY{\ruleref{rule:RXInr}} \pflabel{[inr]refutable}
      \end{pfsteps*}
      By rule induction over \rulesref{rules:Indet} on \pfref{eindet}.
      \begin{byCases}
        \savelocalsteps{1}
        \item[\text{(\ref{rule:IEHole})}]
        \begin{pfsteps*}
        \item $e=\hehole{u}$ \BY{assumption}
        \item $\notIntro{\hehole{u}}$ \BY{\ruleref{rule:NVEHole}} \pflabel{[ehole][inr]notintro}
        \item $\cmaysatisfy{\hehole{u}}{\cinr{\hxi_2}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[ehole][inr]notintro} and \pfref{[inr]refutable}} \pflabel{[ehole][inr]maysat}
        \item $\csatisfyormay{\hehole{u}}{\cinr{\hxi_2}}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[ehole][inr]maysat}}
        \end{pfsteps*}
        Contradicts \pfref{not-satormay}.
        \restorelocalsteps{1}
        \item[\text{(\ref{rule:IHole})}]
        \begin{pfsteps*}
        \item $e=\hhole{e_1}{u}$ \BY{assumption}
        \item $\notIntro{\hhole{e_1}{u}}$ \BY{\ruleref{rule:NVHole}} \pflabel{[hole][inr]notintro}
        \item $\cmaysatisfy{\hhole{e_1}{u}}{\cinr{\hxi_2}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[hole][inr]notintro} and \pfref{[inr]refutable}} \pflabel{[hole][inr]maysat}
        \item $\csatisfyormay{\hhole{e_1}{u}}{\cinr{\hxi_2}}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[hole][inr]maysat}}
        \end{pfsteps*} 
        Contradicts \pfref{not-satormay}.
        \restorelocalsteps{1}
        \item[\text{(\ref{rule:IAp})}]
        \begin{pfsteps*}
        \item $e=\hap{e_1}{e_2}$ \BY{assumption}
        \item $\notIntro{\hap{e_1}{e_2}}$ \BY{\ruleref{rule:NVAp}} \pflabel{[ap][inr]notintro}
        \item $\cmaysatisfy{\hap{e_1}{e_2}}{\cinr{\hxi_2}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[ap][inr]notintro} and \pfref{[inr]refutable}} \pflabel{[ap][inr]maysat}
        \item $\csatisfyormay{\hap{e_1}{e_2}}{\cinr{\hxi_2}}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[ap][inr]maysat}}
        \end{pfsteps*} 
        Contradicts \pfref{not-satormay}.
        \restorelocalsteps{1}
        \item[\text{(\ref{rule:IPrl})}]
        \begin{pfsteps*}
        \item $e=\hprl{e_1}$ \BY{assumption}
        \item $\notIntro{\hprl{e_1}}$ \BY{\ruleref{rule:NVPrl}} \pflabel{[prl][inr]notintro}
        \item $\cmaysatisfy{\hprl{e_1}}{\cinr{\hxi_2}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[prl][inr]notintro} and \pfref{[inr]refutable}} \pflabel{[prl][inr]maysat}
        \item $\csatisfyormay{\hprl{e_1}}{\cinr{\hxi_2}}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[prl][inr]maysat}}
        \end{pfsteps*} 
        Contradicts \pfref{not-satormay}.
        \restorelocalsteps{1}
        \item[\text{(\ref{rule:IPrr})}]
        \begin{pfsteps*}
        \item $e=\hprr{e_1}$ \BY{assumption}
        \item $\notIntro{\hprr{e_1}}$ \BY{\ruleref{rule:NVPrr}} \pflabel{[prr][inr]notintro}
        \item $\cmaysatisfy{\hprr{e_1}}{\cinr{\hxi_2}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[prr][inr]notintro} and \pfref{[inr]refutable}} \pflabel{[prr][inr]maysat}
        \item $\csatisfyormay{\hprr{e_1}}{\cinr{\hxi_2}}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[prr][inr]maysat}}
        \end{pfsteps*} 
        Contradicts \pfref{not-satormay}.
        \restorelocalsteps{1}
        \item[\text{(\ref{rule:IMatch})}]
        \begin{pfsteps*}
        \item $e=\hmatch{e_1}{\zrules}$ \BY{assumption}
        \item $\notIntro{\hmatch{e_1}{\zrules}}$ \BY{\ruleref{rule:NVMatch}} \pflabel{[match][inr]notintro}
        \item $\cmaysatisfy{\hmatch{e_1}{\zrules}}{\cinr{\hxi_2}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[match][inr]notintro} and \pfref{[inr]refutable}} \pflabel{[match][inr]maysat}
        \item $\csatisfyormay{\hmatch{e_1}{\zrules}}{\cinr{\hxi_2}}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[match][inr]maysat}}
        \end{pfsteps*} 
        Contradicts \pfref{not-satormay}.
        \restorelocalsteps{1}
        \item[\text{(\ref{rule:IPairL}), (\ref{rule:IPairR}), (\ref{rule:IPair})}] 
        \begin{pfsteps*}
        \item $e=\hpair{e_1}{e_2}$ \BY{assumption}
        \end{pfsteps*} 
        By rule induction over \rulesref{rules:Indet} on \pfref{eindet}, no rule applies due to syntactic contradiction.
        \restorelocalsteps{1}
        \item[\text{(\ref{rule:IInl})}] 
        \begin{pfsteps*}
        \item $e=\hinl{\tau_2}{e_1}$ \BY{assumption}
        \end{pfsteps*}
        To show if $\inValues{e'}{\hinl{\tau_2}{e_1}}$ then $\cnotsatisfyormay{e'}{\cinr{\hxi_2}}$, we assume $\inValues{e'}{\hinl{\tau_2}{e_1}}$.
        \begin{pfsteps*}
        \item $\inValues{e'}{\hinl{\tau_2}{e_1}}$ \BY{assumption} \pflabel{[inl][inr]invalues}
        \end{pfsteps*}
        By rule induction over \rulesref{rules:inValues} on \pfref{[inl][inr]invalues}.
        \begin{byCases}
          \savelocalsteps{2}
          \item[\text{(\ref{rule:IVVal})}]
          \begin{pfsteps*}
          \item $\isVal{\hinl{\tau_2}{e_1}}$ \BY{assumption}
          \end{pfsteps*} 
          Contradicts \pfref{eindet} by \autoref{lem:val-not-indet}.
          \restorelocalsteps{2} 
          \item[\text{(\ref{rule:IVIndet})}] 
          \begin{pfsteps*}
          \item $\notIntro{\hinl{\tau_2}{e_1}}$ \BY{assumption}
          \end{pfsteps*} 
          Contradicts \autoref{lem:no-inl-notintro}
          \restorelocalsteps{2}
          \item[\text{(\ref{rule:IVInl})}] 
          \begin{pfsteps*}
          \item $e'=\hinl{\tau_2}{e_1'}$ \BY{assumption}
          \item $\cnotsatisfyormay{\hinl{\tau_2}{e_1'}}{\cinr{\hxi_2}}$ \BY{\autoref{lem:inl-notsatormay-inr}}
          \end{pfsteps*} 
        \end{byCases}
        \restorelocalsteps{1}
        \item[\text{(\ref{rule:IInr})}] 
        \begin{pfsteps*}
        \item $e=\hinr{\tau_1'}{e_2}$ \BY{assumption}
        \item $\isIndet{e_2}$ \BY{assumption} \pflabel{[inr]e2indet}
        \end{pfsteps*} 
        By rule induction over \rulesref{rules:TExp} on \pfref{etyp}, only one rule applies.
        \begin{byCases}
          \item[\text{(\ref{rule:TInr})}]
          \begin{pfsteps*}
          \item $\tau_1'=\tau_1$ \BY{assumption}
          \item $\hexptyp{\cdot}{\Delta}{e_2}{\tau_2}$ \BY{assumption} \pflabel{[inr]e2typ}
          \item $\cnotsatisfyormay{e_2}{\hxi_2}$ \BY{\autoref{lem:satormay-inl} on \pfref{not-satormay}} \pflabel{[inr]not-satormay2}
          \item if $\inValues{e_2'}{e_2}$ then $\cnotsatisfyormay{e_2'}{\hxi_2}$ \BY{IH on \pfref{[inr]e2indet} and \pfref{[inr]e2typ} and \pfref{[inr]c2typ} and \pfref{[inr]not-satormay2}} \pflabel{[inr]forall2}
          \end{pfsteps*} 
          To show if $\inValues{e'}{\hinr{\tau_1}{e_2}}$ then $\cnotsatisfyormay{e'}{\cinr{\hxi_2}}$, we assume $\inValues{e'}{\hinr{\tau_1}{e_2}}$.
          \begin{pfsteps*}
          \item $\inValues{e'}{\hinr{\tau_1}{e_2}}$ \BY{assumption} \pflabel{[inr][inr]invalues}
          \end{pfsteps*}
          By rule induction over \rulesref{rules:inValues} on \pfref{[inr][inr]invalues}.
          \begin{byCases}
            \savelocalsteps{2}
            \item[\text{(\ref{rule:IVVal})}]
            \begin{pfsteps*}
            \item $\isVal{\hinr{\tau_1}{e_2}}$ \BY{assumption}
            \end{pfsteps*} 
            Contradicts \pfref{eindet} by \autoref{lem:val-not-indet}.
            \restorelocalsteps{2} 
            \item[\text{(\ref{rule:IVIndet})}] 
            \begin{pfsteps*}
            \item $\notIntro{\hinr{\tau_1}{e_2}}$ \BY{assumption}
            \end{pfsteps*} 
            Contradicts \autoref{lem:no-inr-notintro}
            \restorelocalsteps{2}
            \item[\text{(\ref{rule:IVInr})}] 
            \begin{pfsteps*}
            \item $e'=\hinr{\tau_1}{e_2'}$ \BY{assumption}
            \item $\inValues{e_2'}{e_2}$ \BY{assumption} \pflabel{[inr]invalues2}
            \item $\cnotsatisfyormay{e_2'}{\hxi_2}$ \BY{\pfref{[inr]forall2} on \pfref{[inr]invalues2}} \pflabel{[inr]not-satormay2'}
            \item $\cnotsatisfyormay{\hinr{\tau_1}{e_2'}}{\cinr{\hxi_2}}$ \BY{\autoref{lem:satormay-inr} on \pfref{[inr]not-satormay2'}}
            \end{pfsteps*} 
          \end{byCases}
        \end{byCases}
      \end{byCases} 
    \restorelocalsteps{0}
    \item[\text{(\ref{rule:CTPair})}]
    \begin{pfsteps*}
    \item $\hxi=\cpair{\hxi_1}{\hxi_2}$ \BY{assumption}
    \item $\tau=\tprod{\tau_1}{\tau_2}$ \BY{assumption}
    \item $\ctyp{\hxi_1}{\tau_1}$ \BY{assumption} \pflabel{[pair]c1typ}
    \item $\ctyp{\hxi_2}{\tau_2}$ \BY{assumption} \pflabel{[pair]c2typ}
    \end{pfsteps*} 
    By rule induction over \rulesref{rules:Indet} on \pfref{eindet}.
    \begin{byCases}
      \savelocalsteps{1}
      \item[\text{(\ref{rule:IEHole}), (\ref{rule:IHole}), (\ref{rule:IAp}), (\ref{rule:IPrl}), (\ref{rule:IPrr}), (\ref{rule:IMatch})}]
      \begin{pfsteps*}
      \item $e=\hehole{u}, \hhole{e_1}{u}, \hap{e_1}{e_2}, \hprl{e_1}, \hprr{e_1}, \hmatch{e_1}{\zrules}$ \BY{assumption}
      \item $\notIntro{e}$ \BY{\rulesref{rules:notintro}} \pflabel{[pair]notintro}
      \item $\notIntro{\hprl{e}}$ \BY{\ruleref{rule:NVPrl}} \pflabel{[pair]prlnotintro}
      \item $\notIntro{\hprr{e}}$ \BY{\ruleref{rule:NVPrr}} \pflabel{[pair]prrnotintro}
      \item $\isIndet{\hprl{e}}$ \BY{\ruleref{rule:IPrl} on \pfref{eindet}} \pflabel{[pair]prlindet}
      \item $\isIndet{\hprr{e}}$ \BY{\ruleref{rule:IPrr} on \pfref{eindet}} \pflabel{[pair]prrindet}
      \item $\hexptyp{\cdot}{\Delta}{\hprl{e}}{\tau_1}$ \BY{\ruleref{rule:TPrl} on \pfref{etyp}} \pflabel{[pair]prltyp}
      \item $\hexptyp{\cdot}{\Delta}{\hprr{e}}{\tau_2}$ \BY{\ruleref{rule:TPrr} on \pfref{etyp}} \pflabel{[pair]prrtyp}
      \end{pfsteps*}
      By case analysis on the result of $\fsatisfyormay{\hprl{e}}{\hxi_1}$.
      \begin{byCases}
        \savelocalsteps{2}
        \item[\true]
        \begin{pfsteps*}
        \item $\fsatisfyormay{\hprl{e}}{\hxi_1}=\true$ \BY{assumption} \pflabel{[pair]fsatormay1}
        \item $\csatisfyormay{\hprl{e}}{\hxi_1}$ \BY{\autoref{lem:sound-complete-satormay} on \pfref{[pair]fsatormay1}} \pflabel{[pair]satormay1}
        \end{pfsteps*} 
        By case analysis on the result of $\fsatisfyormay{\hprr{e}}{\hxi_2}$.
        \begin{byCases}
          \savelocalsteps{3}
          \item[\true]
          \begin{pfsteps*}
          \item $\fsatisfyormay{\hprr{e}}{\hxi_2}=\true$ \BY{assumption} \pflabel{[pair]fsatormay2}
          \item $\csatisfyormay{\hprr{e}}{\hxi_2}$ \BY{\autoref{lem:sound-complete-satormay} on \pfref{[pair]fsatormay2}} \pflabel{[pair]satormay2}
          \end{pfsteps*}  
          By rule induction over \rulesref{rules:satormay} on \pfref{[pair]satormay1}.
          \begin{byCases}
            \savelocalsteps{4}
            \item[\text{(\ref{rule:CSMSSat})}]
            \begin{pfsteps*}
            \item $\csatisfy{\hprl{e}}{\hxi_1}$ \BY{asssumption} \pflabel{[pair]satisfy1}
            \end{pfsteps*} 
            By rule induction over \rulesref{rules:satormay} on \pfref{[pair]satormay2}.
            \begin{byCases}
              \savelocalsteps{5}
              \item[\text{(\ref{rule:CSMSSat})}]
              \begin{pfsteps*}
              \item $\csatisfy{\hprr{e}}{\hxi_2}$ \BY{asssumption} \pflabel{[pair]satisfy2}
              \item $\csatisfy{e}{\cpair{\hxi_1}{\hxi_2}}$ \BY{\ruleref{rule:CSNotIntroPair} on \pfref{[pair]notintro} and \pfref{[pair]satisfy1} and \pfref{[pair]satisfy2}} \pflabel{[pair]satisfy}
              \item $\csatisfyormay{e}{\cpair{\hxi_1}{\hxi_2}}$ \BY{\ruleref{rule:CSMSSat} on \pfref{[pair]satisfy}}
              \end{pfsteps*} 
              Contradicts \pfref{not-satormay}.
              \restorelocalsteps{5}
              \item[\text{(\ref{rule:CSMSMay})}]
              \begin{pfsteps*}
              \item $\cmaysatisfy{\hprr{e}}{\hxi_2}$ \BY{assumption} \pflabel{[pair]maysat2}
              \item $\refutable{\hxi_2}$ \BY{\autoref{lem:notintro-maysat-refutable} on \pfref{[pair]prrnotintro} and \pfref{[pair]maysat2}} \pflabel{[pair]refutable2}
              \item $\refutable{\cpair{\hxi_1}{\hxi_2}}$ \BY{\ruleref{rule:RXPairR} on \pfref{[pair]refutable2}} \pflabel{[pair]refutable}
              \item $\cmaysatisfy{e}{\cpair{\hxi_1}{\hxi_2}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[pair]notintro} and \pfref{[pair]refutable}} \pflabel{[pair]maysat}
              \item $\csatisfyormay{e}{\cpair{\hxi_1}{\hxi_2}}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[pair]maysat}}
              \end{pfsteps*} 
            \end{byCases}
            \restorelocalsteps{4} 
            \item[\text{(\ref{rule:CSMSMay})}]
            \begin{pfsteps*}
            \item $\cmaysatisfy{\hprl{e}}{\hxi_1}$ \BY{assumption} \pflabel{[pair]maysat1}
            \item $\refutable{\hxi_1}$ \BY{\autoref{lem:notintro-maysat-refutable} on \pfref{[pair]prlnotintro} and \pfref{[pair]maysat1}} \pflabel{[pair]refutable1}
            \item $\refutable{\cpair{\hxi_1}{\hxi_2}}$ \BY{\ruleref{rule:RXPairL} on \pfref{[pair]refutable1}} \pflabel{[pair]refutable'}
            \item $\cmaysatisfy{e}{\cpair{\hxi_1}{\hxi_2}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[pair]notintro} and \pfref{[pair]refutable'}} \pflabel{[pair]maysat'}
            \item $\csatisfyormay{e}{\cpair{\hxi_1}{\hxi_2}}$ \BY{\ruleref{rule:CSMSMay} on \pfref{[pair]maysat'}}
            \end{pfsteps*} 
          \end{byCases} 
          \restorelocalsteps{3} 
          \item[\false]
          \begin{pfsteps*}
          \item $\fsatisfyormay{\hprr{e}}{\hxi_2} = \false$ \BY{assumption} \pflabel{[pair]not-fsatormay2}
          \item $\csatisfyormay{\hprr{e}}{\hxi_2}$ \BY{\autoref{lem:sound-complete-satormay} on \pfref{[pair]not-fsatormay2}} \pflabel{[pair]not-satormay2}
          \item if $\inValues{e_2'}{\hprr{e}}$ then $\cnotsatisfyormay{e_2'}{\hxi_2}$ \BY{IH on \pfref{[pair]prrindet} and \pfref{[pair]prrtyp} and \pfref{[pair]c2typ} and \pfref{[pair]not-satormay2}} \pflabel{[pair]complete2}
          \end{pfsteps*} 
          To show if $\inValues{e'}{e}$ then $\cnotsatisfyormay{e'}{\cpair{\hxi_1}{\hxi_2}}$, we assume $\inValues{e'}{e}$.
          \begin{pfsteps*}
          \item $\inValues{e'}{e}$ \BY{assumption} \pflabel{e'invalues'}
          \end{pfsteps*}
          By rule induction over \rulesref{rules:inValues} on \pfref{e'invalues'}, only two rules apply.
          \begin{byCases}
            \savelocalsteps{4}
            \item[\text{(\ref{rule:IVVal})}]
            \begin{pfsteps*}
            \item $\isVal{e}$ \BY{assumption}
            \end{pfsteps*} 
            Contradicts \pfref{eindet} by \autoref{lem:val-not-indet}.
            \restorelocalsteps{4} 
            \item[\text{(\ref{rule:IVIndet})}] 
            \begin{pfsteps*}
            \item $\isVal{e'}$ \BY{assumption} \pflabel{e'val'}
            \item $\hexptyp{\cdot}{\Delta}{e'}{\tprod{\tau_1}{\tau_2}}$ \BY{assumption} \pflabel{e'typ'}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:Value} on \pfref{e'val'}.
            \begin{byCases}
              \savelocalsteps{5}
              \item[\text{(\ref{rule:VNum})}]
              \begin{pfsteps*}
              \item $e'=\hnum{n}$ \BY{assumption}
              \end{pfsteps*} 
              By rule induction over \rulesref{rules:TExp} on \pfref{e'typ'}, no rule applies due to syntactic contradiction.
              \restorelocalsteps{5}
              \item[\text{(\ref{rule:VLam})}]
              \begin{pfsteps*} 
              \item $e'=\hlam{x}{\tau'}{e_1'}$ \BY{assumption}
              \end{pfsteps*}
              By rule induction over \rulesref{rules:TExp} on \pfref{e'typ'}, no rule applies due to syntactic contradiction.
              \restorelocalsteps{5}
              \item[\text{(\ref{rule:VPair})}] 
              \begin{pfsteps*} 
              \item $e'=\hpair{e_1'}{e_2'}$ \BY{assumption}
              \item $\isVal{e_2'}$ \BY{assumption} \pflabel{e2'val}
              \end{pfsteps*}
              By rule induction over \rulesref{rules:TExp} on \pfref{e'typ'}, only one rule applies. \\
                \textbf{Case} \text{(\ref{rule:TPair})}\textbf{.}
                \begin{pfsteps*}
                \item $\hexptyp{\cdot}{\Delta}{e_2'}{\tau_2}$ \BY{assumption} \pflabel{e2'typ}
                \item $\inValues{e_2'}{\hprr{e}}$ \BY{\ruleref{rule:IVIndet} on \pfref{[pair]prrnotintro} and \pfref{[pair]prrtyp} and \pfref{e2'val} and \pfref{e2'typ}} \pflabel{e2'invalues}
                \item $\cnotsatisfyormay{e_2'}{\hxi_2}$ \BY{\pfref{[pair]complete2} on \pfref{e2'invalues}} \pflabel{[pair]not-satormay2'}
                \item $\cnotsatisfyormay{\hpair{e_1'}{e_2'}}{\cpair{\hxi_1}{\hxi_2}}$ \BY{\autoref{lem:satormay-pair} on \pfref{[pair]not-satormay1'}}
                \end{pfsteps*}
              \restorelocalsteps{5}
              \item[\text{(\ref{rule:VInl})}] 
              \begin{pfsteps*} 
              \item $e'=\hinl{\tau_2}{e_1'}$ \BY{assumption}
              \end{pfsteps*}
              By rule induction over \rulesref{rules:TExp} on \pfref{e'typ'}, no rule applies due to syntactic contradiction.
              \restorelocalsteps{5}
              \item[\text{(\ref{rule:VInr})}] 
              \begin{pfsteps*} 
              \item $e'=\hinr{\tau_1}{e_2'}$ \BY{assumption}
              \end{pfsteps*}
              By rule induction over \rulesref{rules:TExp} on \pfref{e'typ'}, no rule applies due to syntactic contradiction.
            \end{byCases}
          \end{byCases}
        \end{byCases}
        
        \restorelocalsteps{2}
        \item[\false] 
        \begin{pfsteps*}
        \item $\fsatisfyormay{\hprl{e}}{\hxi_1}=\false$ \BY{assumption} \pflabel{[pair]not-fsatormay1}
        \item $\cnotsatisfyormay{\hprl{e}}{\hxi_1}$ \BY{\autoref{lem:sound-complete-satormay} on \pfref{[pair]not-fsatormay1}} \pflabel{[pair]not-satormay1}
        \item if $\inValues{e_1'}{\hprl{e}}$ then $\cnotsatisfyormay{e_1'}{\hxi_1}$ \BY{IH on \pfref{[pair]prlindet} and \pfref{[pair]prltyp} and \pfref{[pair]c1typ} and \pfref{[pair]not-satormay1}} \pflabel{[pair]complete1}
        \end{pfsteps*} 
        To show if $\inValues{e'}{e}$ then $\cnotsatisfyormay{e'}{\cpair{\hxi_1}{\hxi_2}}$, we assume $\inValues{e'}{e}$.
        \begin{pfsteps*}
        \item $\inValues{e'}{e}$ \BY{assumption} \pflabel{e'invalues}
        \end{pfsteps*}
        By rule induction over \rulesref{rules:inValues} on \pfref{e'invalues}, only two rules apply.
        \begin{byCases}
          \savelocalsteps{3}
          \item[\text{(\ref{rule:IVVal})}]
          \begin{pfsteps*}
          \item $\isVal{e}$ \BY{assumption}
          \end{pfsteps*} 
          Contradicts \pfref{eindet} by \autoref{lem:val-not-indet}.
          \restorelocalsteps{3} 
          \item[\text{(\ref{rule:IVIndet})}] 
          \begin{pfsteps*}
          \item $\isVal{e'}$ \BY{assumption} \pflabel{e'val}
          \item $\hexptyp{\cdot}{\Delta}{e'}{\tprod{\tau_1}{\tau_2}}$ \BY{assumption} \pflabel{e'typ}
          \end{pfsteps*}
          By rule induction over \rulesref{rules:Value} on \pfref{e'val}.
          \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:VNum})}]
            \begin{pfsteps*}
            \item $e'=\hnum{n}$ \BY{assumption}
            \end{pfsteps*} 
            By rule induction over \rulesref{rules:TExp} on \pfref{e'typ}, no rule applies due to syntactic contradiction.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:VLam})}]
            \begin{pfsteps*} 
            \item $e'=\hlam{x}{\tau'}{e_1'}$ \BY{assumption}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:TExp} on \pfref{e'typ}, no rule applies due to syntactic contradiction.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:VPair})}] 
            \begin{pfsteps*} 
            \item $e'=\hpair{e_1'}{e_2'}$ \BY{assumption}
            \item $\isVal{e_1'}$ \BY{assumption} \pflabel{e1'val}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:TExp} on \pfref{e'typ}, only one rule applies.
            \begin{byCases}
              \item[\text{(\ref{rule:TPair})}]
              \begin{pfsteps*}
              \item $\hexptyp{\cdot}{\Delta}{e_1'}{\tau_1}$ \BY{assumption} \pflabel{e1'typ}
              \item $\inValues{e_1'}{\hprl{e}}$ \BY{\ruleref{rule:IVIndet} on \pfref{[pair]prlnotintro} and \pfref{[pair]prltyp} and \pfref{e1'val} and \pfref{e1'typ}} \pflabel{e1'invalues}
              \item $\cnotsatisfyormay{e_1'}{\hxi_1}$ \BY{\pfref{[pair]complete1} on \pfref{e1'invalues}} \pflabel{[pair]not-satormay1'}
              \item $\cnotsatisfyormay{\hpair{e_1'}{e_2'}}{\cpair{\hxi_1}{\hxi_2}}$ \BY{\autoref{lem:satormay-pair} on \pfref{[pair]not-satormay1'}}
              \end{pfsteps*} 
            \end{byCases}
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:VInl})}] 
            \begin{pfsteps*} 
            \item $e'=\hinl{\tau_2}{e_1'}$ \BY{assumption}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:TExp} on \pfref{e'typ}, no rule applies due to syntactic contradiction.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:VInr})}] 
            \begin{pfsteps*} 
            \item $e'=\hinr{\tau_1}{e_2'}$ \BY{assumption}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:TExp} on \pfref{e'typ}, no rule applies due to syntactic contradiction.
          \end{byCases}
        \end{byCases}
      \end{byCases}
      \restorelocalsteps{1}
      \item[\text{(\ref{rule:IPairL})}] 
      \begin{pfsteps*}
      \item $e=\hpair{e_1}{e_2}$ \BY{assumption}
      \item $\isIndet{e_1}$ \BY{assumption} \pflabel{[pair1]e1indet}
      \item $\isVal{e_2}$ \BY{assumption} \pflabel{[pair1]e2val}
      \item $\cnotsatisfyormay{e_1}{\hxi_1}$ or $\cnotsatisfyormay{e_2}{\hxi_2}$ \BY{\autoref{lem:satormay-pair} on \pfref{not-satormay}} \pflabel{[pair1]not-satormay-1or2}
      \end{pfsteps*}
      By case analysis on the disjunction in \pfref{[pair1]not-satormay-1or2}.
      \begin{byCases}
        \savelocalsteps{2}
        \item[\cnotsatisfyormay{e_1}{\hxi_1}]
        \begin{pfsteps*}
        \item $\cnotsatisfyormay{e_1}{\hxi_1}$ \BY{assumption} \pflabel{[pair1]not-satormay-1}
        \end{pfsteps*}
        By rule induction over \rulesref{rules:TExp} on \pfref{etyp}, only one rule applies.
        \begin{byCases}
          \item[\text{(\ref{rule:TPair})}]
          \begin{pfsteps*}
          \item $\hexptyp{\cdot}{\Delta}{e_1}{\tau_1}$ \BY{assumption} \pflabel{[pair1]e1typ}
          \item if $\inValues{e_1'}{e_1}$ then $\cnotsatisfyormay{e_1'}{\hxi_1}$ \BY{IH on \pfref{[pair1]e1indet} and \pfref{[pair1]e1typ} and \pfref{[pair]c1typ} and \pfref{[pair1]not-satormay-1}} \pflabel{[pair1]complete1}
          \end{pfsteps*} 
          To show that if $\inValues{e'}{\hpair{e_1}{e_2}}$ then $\cnotsatisfyormay{\hpair{e_1}{e_2}}{\cpair{\hxi_1}{\hxi_2}}$, we assume $\inValues{e'}{\hpair{e_1}{e_2}}$.
          \begin{pfsteps*}
          \item $\inValues{e'}{\hpair{e_1}{e_2}}$ \BY{assumption} \pflabel{[pair1]invalues}
          \end{pfsteps*}
          By rule induction over \rulesref{rules:inValues} on \pfref{[pair1]invalues}.
          \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:IVVal})}]
            \begin{pfsteps*}
            \item $\isVal{\hpair{e_1}{e_2}}$ \BY{assumption}
            \end{pfsteps*} 
            Contradicts \pfref{eindet} by \autoref{lem:val-not-indet}.
            \restorelocalsteps{3} 
            \item[\text{(\ref{rule:IVIndet})}] 
            \begin{pfsteps*}
            \item $\notIntro{\hpair{e_1}{e_2}}$ \BY{assumption}
            \end{pfsteps*}
            Contradicts \autoref{lem:no-pair-notintro}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:IVPair})}]
            \begin{pfsteps*}
            \item $e'=\hpair{e_1'}{e_2'}$ \BY{assumption}
            \item $\inValues{e_1'}{e_1}$ \BY{assumption} \pflabel{[pair1]invalues1}
            \item $\cnotsatisfyormay{e_1'}{\hxi_1}$ \BY{\pfref{[pair1]complete1} on \pfref{[pair1]invalues1}} \pflabel{[pair1]not-satormay1}
            \item $\cnotsatisfyormay{\hpair{e_1'}{e_2'}}{\cpair{\hxi_1}{\hxi_2}}$ \BY{\autoref{lem:satormay-pair} on \pfref{[pair1]not-satormay1}}
            \end{pfsteps*} 
          \end{byCases}
        \end{byCases}
        \restorelocalsteps{2}
        \item[\cnotsatisfyormay{e_2}{\hxi_2}]
        \begin{pfsteps*}
        \item $\cnotsatisfyormay{e_2}{\hxi_2}$ \BY{assumption} \pflabel{[pair1]not-satormay-2}
        \end{pfsteps*}
        To show that if $\inValues{e'}{\hpair{e_1}{e_2}}$ then $\cnotsatisfyormay{\hpair{e_1}{e_2}}{\cpair{\hxi_1}{\hxi_2}}$, we assume $\inValues{e'}{\hpair{e_1}{e_2}}$.
        \begin{pfsteps*}
        \item $\inValues{e'}{\hpair{e_1}{e_2}}$ \BY{assumption} \pflabel{[pair1]invalues'}
        \end{pfsteps*}
        By rule induction over \rulesref{rules:inValues} on \pfref{[pair1]invalues'}.
        \begin{byCases}
          \savelocalsteps{3}
          \item[\text{(\ref{rule:IVVal})}]
          \begin{pfsteps*}
          \item $\isVal{\hpair{e_1}{e_2}}$ \BY{assumption}
          \end{pfsteps*} 
          Contradicts \pfref{eindet} by \autoref{lem:val-not-indet}.
          \restorelocalsteps{3} 
          \item[\text{(\ref{rule:IVIndet})}] 
          \begin{pfsteps*}
          \item $\notIntro{\hpair{e_1}{e_2}}$ \BY{assumption}
          \end{pfsteps*}
          Contradicts \autoref{lem:no-pair-notintro}.
          \restorelocalsteps{3}
          \item[\text{(\ref{rule:IVPair})}]
          \begin{pfsteps*}
          \item $e'=\hpair{e_1'}{e_2'}$ \BY{assumption}
          \item $\inValues{e_2'}{e_2}$ \BY{assumption} \pflabel{[pair1]invalues1'}
          \end{pfsteps*}
          By rule induction over \rulesref{rules:inValues} on \pfref{[pair1]invalues1'}.
          \begin{byCases}
            \savelocalsteps{4}
            \item[\text{(\ref{rule:IVVal})}]
            \begin{pfsteps*}
            \item $e_2'=e_2$ \BY{assumption} \pflabel{subst}
            \item $\cnotsatisfyormay{e_2'}{\hxi_2}$ \BY{\pfref{subst} and \pfref{[pair1]not-satormay-2}} \pflabel{[pair1]not-satormay-2'}
            \item $\cnotsatisfyormay{\hpair{e_1'}{e_2'}}{\cpair{\hxi_1}{\hxi_2}}$ \BY{\autoref{lem:satormay-pair} on \pfref{[pair1]not-satormay-2'}}
            \end{pfsteps*} 
            \restorelocalsteps{4} 
            \item[\text{(\ref{rule:IVIndet})}]
            \begin{pfsteps*}
            \item $\notIntro{e_2}$ \BY{assumption}
            \end{pfsteps*} 
            Contradicts \pfref{[pair1]e2val} by \autoref{lem:val-not-notintro}.
            \restorelocalsteps{4} 
            \item[\text{(\ref{rule:IVInl}), (\ref{rule:IVInr}), (\ref{rule:IVPair})}]
            \begin{pfsteps*}
            \item $\isIndet{e_2}$ \BY{assumption}
            \end{pfsteps*} 
            Contradicts \pfref{[pair1]e2val} by \autoref{lem:val-not-indet}.
          \end{byCases}
        \end{byCases}
      \end{byCases}
      \restorelocalsteps{1}
      \item[\text{(\ref{rule:IPairR})}] 
      \begin{pfsteps*}
      \item $e=\hpair{e_1}{e_2}$ \BY{assumption}
      \item $\isVal{e_1}$ \BY{assumption} \pflabel{[pair2]e1val}
      \item $\isIndet{e_2}$ \BY{assumption} \pflabel{[pair2]e2indet}
      \item $\cnotsatisfyormay{e_1}{\hxi_1}$ or $\cnotsatisfyormay{e_2}{\hxi_2}$ \BY{\autoref{lem:satormay-pair} on \pfref{not-satormay}} \pflabel{[pair2]not-satormay-1or2}
      \end{pfsteps*}
      By case analysis on the disjunction in \pfref{[pair2]not-satormay-1or2}.
      \begin{byCases}
        \savelocalsteps{2}
        \item[\cnotsatisfyormay{e_1}{\hxi_1}]
        \begin{pfsteps*}
        \item $\cnotsatisfyormay{e_1}{\hxi_1}$ \BY{assumption} \pflabel{[pair2]not-satormay-1}
        \end{pfsteps*}
        To show that if $\inValues{e'}{\hpair{e_1}{e_2}}$ then $\cnotsatisfyormay{\hpair{e_1}{e_2}}{\cpair{\hxi_1}{\hxi_2}}$, we assume $\inValues{e'}{\hpair{e_1}{e_2}}$.
        \begin{pfsteps*}
        \item $\inValues{e'}{\hpair{e_1}{e_2}}$ \BY{assumption} \pflabel{[pair2]invalues'}
        \end{pfsteps*}
        By rule induction over \rulesref{rules:inValues} on \pfref{[pair2]invalues'}.
        \begin{byCases}
          \savelocalsteps{3}
          \item[\text{(\ref{rule:IVVal})}]
          \begin{pfsteps*}
          \item $\isVal{\hpair{e_1}{e_2}}$ \BY{assumption}
          \end{pfsteps*} 
          Contradicts \pfref{eindet} by \autoref{lem:val-not-indet}.
          \restorelocalsteps{3} 
          \item[\text{(\ref{rule:IVIndet})}] 
          \begin{pfsteps*}
          \item $\notIntro{\hpair{e_1}{e_2}}$ \BY{assumption}
          \end{pfsteps*}
          Contradicts \autoref{lem:no-pair-notintro}.
          \restorelocalsteps{3}
          \item[\text{(\ref{rule:IVPair})}]
          \begin{pfsteps*}
          \item $e'=\hpair{e_1'}{e_2'}$ \BY{assumption}
          \item $\inValues{e_1'}{e_1}$ \BY{assumption} \pflabel{[pair2]invalues1'}
          \end{pfsteps*}
          By rule induction over \rulesref{rules:inValues} on \pfref{[pair2]invalues1'}.
          \begin{byCases}
            \savelocalsteps{4}
            \item[\text{(\ref{rule:IVVal})}]
            \begin{pfsteps*}
            \item $e_1'=e_1$ \BY{assumption} \pflabel{[pair2]subst}
            \item $\cnotsatisfyormay{e_1'}{\hxi_1}$ \BY{\pfref{[pair2]subst} and \pfref{[pair2]not-satormay-1}} \pflabel{[pair2]not-satormay-1'}
            \item $\cnotsatisfyormay{\hpair{e_1'}{e_2'}}{\cpair{\hxi_1}{\hxi_2}}$ \BY{\autoref{lem:satormay-pair} on \pfref{[pair2]not-satormay-1'}}
            \end{pfsteps*} 
            \restorelocalsteps{4} 
            \item[\text{(\ref{rule:IVIndet})}]
            \begin{pfsteps*}
            \item $\notIntro{e_1}$ \BY{assumption}
            \end{pfsteps*} 
            Contradicts \pfref{[pair2]e1val} by \autoref{lem:val-not-notintro}.
            \restorelocalsteps{4} 
            \item[\text{(\ref{rule:IVInl}), (\ref{rule:IVInr}), (\ref{rule:IVPair})}]
            \begin{pfsteps*}
            \item $\isIndet{e_1}$ \BY{assumption}
            \end{pfsteps*} 
            Contradicts \pfref{[pair2]e1val} by \autoref{lem:val-not-indet}.
          \end{byCases}
        \end{byCases}
        \restorelocalsteps{2}
        \item[\cnotsatisfyormay{e_2}{\hxi_2}]
        \begin{pfsteps*}
        \item $\cnotsatisfyormay{e_2}{\hxi_2}$ \BY{assumption} \pflabel{[pair2]not-satormay-2}
        \end{pfsteps*}
        By rule induction over \rulesref{rules:TExp} on \pfref{etyp}, only one rule applies.
        \begin{byCases}
          \item[\text{(\ref{rule:TPair})}]
          \begin{pfsteps*}
          \item $\hexptyp{\cdot}{\Delta}{e_2}{\tau_2}$ \BY{assumption} \pflabel{[pair2]e2typ}
          \item if $\inValues{e_2'}{e_2}$ then $\cnotsatisfyormay{e_2'}{\hxi_2}$ \BY{IH on \pfref{[pair2]e2indet} and \pfref{[pair2]e2typ} and \pfref{[pair]c2typ} and \pfref{[pair2]not-satormay-2}} \pflabel{[pair2]complete2}
          \end{pfsteps*} 
          To show that if $\inValues{e'}{\hpair{e_1}{e_2}}$ then $\cnotsatisfyormay{\hpair{e_1}{e_2}}{\cpair{\hxi_1}{\hxi_2}}$, we assume $\inValues{e'}{\hpair{e_1}{e_2}}$.
          \begin{pfsteps*}
          \item $\inValues{e'}{\hpair{e_1}{e_2}}$ \BY{assumption} \pflabel{[pair2]invalues}
          \end{pfsteps*}
          By rule induction over \rulesref{rules:inValues} on \pfref{[pair2]invalues}.
          \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:IVVal})}]
            \begin{pfsteps*}
            \item $\isVal{\hpair{e_1}{e_2}}$ \BY{assumption}
            \end{pfsteps*} 
            Contradicts \pfref{eindet} by \autoref{lem:val-not-indet}.
            \restorelocalsteps{3} 
            \item[\text{(\ref{rule:IVIndet})}] 
            \begin{pfsteps*}
            \item $\notIntro{\hpair{e_1}{e_2}}$ \BY{assumption}
            \end{pfsteps*}
            Contradicts \autoref{lem:no-pair-notintro}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:IVPair})}]
            \begin{pfsteps*}
            \item $e'=\hpair{e_1'}{e_2'}$ \BY{assumption}
            \item $\inValues{e_2'}{e_2}$ \BY{assumption} \pflabel{[pair2]invalues2}
            \item $\cnotsatisfyormay{e_2'}{\hxi_2}$ \BY{\pfref{[pair2]complete2} on \pfref{[pair2]invalues2}} \pflabel{[pair2]not-satormay2}
            \item $\cnotsatisfyormay{\hpair{e_1'}{e_2'}}{\cpair{\hxi_1}{\hxi_2}}$ \BY{\autoref{lem:satormay-pair} on \pfref{[pair2]not-satormay2}}
            \end{pfsteps*} 
          \end{byCases}
        \end{byCases}
      \end{byCases}
      \restorelocalsteps{1}
      \item[\text{(\ref{rule:IPair})}] 
      \begin{pfsteps*}
      \item $e=\hpair{e_1}{e_2}$ \BY{assumption}
      \item $\isIndet{e_1}$ \BY{assumption} \pflabel{[pair3]e1indet}
      \item $\isIndet{e_2}$ \BY{assumption} \pflabel{[pair3]e2indet}
      \item $\cnotsatisfyormay{e_1}{\hxi_1}$ or $\cnotsatisfyormay{e_2}{\hxi_2}$ \BY{\autoref{lem:satormay-pair} on \pfref{not-satormay}} \pflabel{[pair3]not-satormay-1or2}
      \end{pfsteps*}
      By rule induction over \rulesref{rules:TExp} on \pfref{etyp}, only one rule applies.
      \begin{byCases}
        \item[\text{(\ref{rule:TPair})}]
        \begin{pfsteps*}
        \item $\hexptyp{\cdot}{\Delta}{e_1}{\tau_1}$ \BY{assumption} \pflabel{[pair3]e1typ}
        \item $\hexptyp{\cdot}{\Delta}{e_2}{\tau_2}$ \BY{assumption} \pflabel{[pair3]e2typ}
        \end{pfsteps*} 
        By case analysis on the disjunction in \pfref{[pair3]not-satormay-1or2}.
        \begin{byCases}
          \savelocalsteps{2}
          \item[\cnotsatisfyormay{e_1}{\hxi_1}]
          \begin{pfsteps*}
          \item $\cnotsatisfyormay{e_1}{\hxi_1}$ \BY{assumption} \pflabel{[pair3]not-satormay-1}
          \item if $\inValues{e_1'}{e_1}$ then $\cnotsatisfyormay{e_1'}{\hxi_1}$ \BY{IH on \pfref{[pair3]e1indet} and \pfref{[pair3]e1typ} and \pfref{[pair]c1typ} and \pfref{[pair3]not-satormay-1}} \pflabel{[pair3]complete1}
          \end{pfsteps*}
          To show that if $\inValues{e'}{\hpair{e_1}{e_2}}$ then $\cnotsatisfyormay{\hpair{e_1}{e_2}}{\cpair{\hxi_1}{\hxi_2}}$, we assume $\inValues{e'}{\hpair{e_1}{e_2}}$.
          \begin{pfsteps*}
          \item $\inValues{e'}{\hpair{e_1}{e_2}}$ \BY{assumption} \pflabel{[pair3]invalues}
          \end{pfsteps*}
          By rule induction over \rulesref{rules:inValues} on \pfref{[pair3]invalues}.
          \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:IVVal})}]
            \begin{pfsteps*}
            \item $\isVal{\hpair{e_1}{e_2}}$ \BY{assumption}
            \end{pfsteps*} 
            Contradicts \pfref{eindet} by \autoref{lem:val-not-indet}.
            \restorelocalsteps{3} 
            \item[\text{(\ref{rule:IVIndet})}] 
            \begin{pfsteps*}
            \item $\notIntro{\hpair{e_1}{e_2}}$ \BY{assumption}
            \end{pfsteps*}
            Contradicts \autoref{lem:no-pair-notintro}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:IVPair})}]
            \begin{pfsteps*}
            \item $e'=\hpair{e_1'}{e_2'}$ \BY{assumption}
            \item $\inValues{e_1'}{e_1}$ \BY{assumption} \pflabel{[pair3]invalues1}
            \item $\cnotsatisfyormay{e_1'}{\hxi_1}$ \BY{\pfref{[pair3]complete1} on \pfref{[pair3]invalues1}} \pflabel{[pair3]not-satormay1}
            \item $\cnotsatisfyormay{\hpair{e_1'}{e_2'}}{\cpair{\hxi_1}{\hxi_2}}$ \BY{\autoref{lem:satormay-pair} on \pfref{[pair3]not-satormay1}}
            \end{pfsteps*} 
          \end{byCases}
          \restorelocalsteps{2}
          \item[\cnotsatisfyormay{e_2}{\hxi_2}]
          \begin{pfsteps*}
          \item $\cnotsatisfyormay{e_2}{\hxi_2}$ \BY{assumption} \pflabel{[pair3]not-satormay-2}
          \item if $\inValues{e_2'}{e_2}$ then $\cnotsatisfyormay{e_2'}{\hxi_2}$ \BY{IH on \pfref{[pair3]e2indet} and \pfref{[pair3]e2typ} and \pfref{[pair]c2typ} and \pfref{[pair3]not-satormay-2}} \pflabel{[pair3]complete2}
          \end{pfsteps*}
          To show that if $\inValues{e'}{\hpair{e_1}{e_2}}$ then $\cnotsatisfyormay{\hpair{e_1}{e_2}}{\cpair{\hxi_1}{\hxi_2}}$, we assume $\inValues{e'}{\hpair{e_1}{e_2}}$.
          \begin{pfsteps*}
          \item $\inValues{e'}{\hpair{e_1}{e_2}}$ \BY{assumption} \pflabel{[pair3]invalues'}
          \end{pfsteps*}
          By rule induction over \rulesref{rules:inValues} on \pfref{[pair3]invalues'}.
          \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:IVVal})}]
            \begin{pfsteps*}
            \item $\isVal{\hpair{e_1}{e_2}}$ \BY{assumption}
            \end{pfsteps*} 
            Contradicts \pfref{eindet} by \autoref{lem:val-not-indet}.
            \restorelocalsteps{3} 
            \item[\text{(\ref{rule:IVIndet})}] 
            \begin{pfsteps*}
            \item $\notIntro{\hpair{e_1}{e_2}}$ \BY{assumption}
            \end{pfsteps*}
            Contradicts \autoref{lem:no-pair-notintro}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:IVPair})}]
            \begin{pfsteps*}
            \item $e'=\hpair{e_1'}{e_2'}$ \BY{assumption}
            \item $\inValues{e_2'}{e_2}$ \BY{assumption} \pflabel{[pair3]invalues2}
            \item $\cnotsatisfyormay{e_2'}{\hxi_2}$ \BY{\pfref{[pair3]complete2} on \pfref{[pair3]invalues2}} \pflabel{[pair3]not-satormay2}
            \item $\cnotsatisfyormay{\hpair{e_1'}{e_2'}}{\cpair{\hxi_1}{\hxi_2}}$ \BY{\autoref{lem:satormay-pair} on \pfref{[pair3]not-satormay2}}
            \end{pfsteps*} 
          \end{byCases}
        \end{byCases}
      \end{byCases}
      \restorelocalsteps{1}
      \item[\text{(\ref{rule:IInl})}] 
      \begin{pfsteps*}
      \item $e=\hinl{\tau_2}{e_1}$ \BY{assumption}
      \end{pfsteps*} 
      By rule induction over \rulesref{rules:TExp} on \pfref{etyp}, no rule applies due to syntactic contradiction.
      \restorelocalsteps{1}
      \item[\text{(\ref{rule:IInr})}] 
      \begin{pfsteps*}
      \item $e=\hinr{\tau_1'}{e_2}$ \BY{assumption}
      \end{pfsteps*} 
      By rule induction over \rulesref{rules:TExp} on \pfref{etyp}, no rule applies due to syntactic contradiction.
    \end{byCases}
    \restorelocalsteps{0}
    \item[\text{(\ref{rule:CTOr})}]
    \begin{pfsteps*}
    \item $\hxi=\cor{\hxi_1}{\hxi_2}$ \BY{assumption}
    \item $\ctyp{\hxi_1}{\tau_1}$ \BY{assumption} \pflabel{[or]c1typ}
    \item $\ctyp{\hxi_2}{\tau_2}$ \BY{assumption} \pflabel{[or]c2typ}
    \item $\cnotsatisfyormay{e}{\cor{\hxi_1}{\hxi_2}}$ \BY{assumption} \pflabel{[or]not-satormay}
    \item $\cnotsatisfyormay{e}{\hxi_1}$ \BY{\autoref{lem:satormay-or} on \pfref{[or]not-satormay}} \pflabel{[or]not-satormay-1}
    \item $\cnotsatisfyormay{e}{\hxi_2}$ \BY{\autoref{lem:satormay-or} on \pfref{[or]not-satormay}} \pflabel{[or]not-satormay-2}
    \item if $\inValues{e'}{e}$ then $\cnotsatisfyormay{e'}{\hxi_1}$ \BY{IH on \pfref{eindet} and \pfref{etyp} and \pfref{[or]c1typ} and \pfref{[or]not-satormay-1}} \pflabel{[or]complete1}
    \item if $\inValues{e'}{e}$ then $\cnotsatisfyormay{e'}{\hxi_2}$ \BY{IH on \pfref{eindet} and \pfref{etyp} and \pfref{[or]c2typ} and \pfref{[or]not-satormay-2}} \pflabel{[or]complete2}
    \end{pfsteps*}
    To show that if $\inValues{e'}{e}$ then $\cnotsatisfyormay{e'}{\cor{\hxi_1}{\hxi_2}}$, we assume $\inValues{e'}{e}$.
    \begin{pfsteps*}
    \item $\inValues{e'}{e}$ \BY{assumption} \pflabel{[or]invalues}
    \item $\cnotsatisfyormay{e'}{\hxi_1}$ \BY{\pfref{[or]complete1} on \pfref{[or]invalues}} \pflabel{[or]not-satormay-1'}
    \item $\cnotsatisfyormay{e'}{\hxi_2}$ \BY{\pfref{[or]complete2} on \pfref{[or]invalues}} \pflabel{[or]not-satormay-2'}
    \item $\cnotsatisfyormay{e'}{\cor{\hxi_1}{\hxi_2}}$ \BY{\autoref{lem:satormay-or} on \pfref{[or]not-satormay-1'} and \pfref{[or]not-satormay-2'}}
    \end{pfsteps*}
  \end{byCases}
\end{proof}

\judgboxa{
  \hsubstyp{\theta}{\Gamma}
}{
  $\theta$ is of type $\Gamma$
}
\begin{subequations}
\begin{equation}
\inferrule[STEmpty]{ }{
  \hsubstyp{\emptyset}{\cdot}
}
\end{equation}
\begin{equation}
\inferrule[STExtend]{
  \hsubstyp{\theta}{\Gamma_\theta} \\
  \hexptyp{\Gamma}{\Delta}{e}{\tau}
}{
  \hsubstyp{\theta , x / e}{\Gamma_\theta , x : \tau}
}
\end{equation}
\end{subequations}

\judgboxa{
  \refutable{p}
}{$p$ is refutable}
\begin{subequations}\label{rules:p-refutable}
\begin{equation}\label{rule:RNum}
\inferrule[RNum]{ }{
  \refutable{\hnum{n}}
}
\end{equation}
\begin{equation}\label{rule:REHole}
\inferrule[REHole]{ }{
  \refutable{\hehole{w}}
}
\end{equation}
\begin{equation}\label{rule:RHole}
\inferrule[RHole]{ }{
  \refutable{\hhole{p}{w}}
}
\end{equation}
\begin{equation}\label{rule:RInl}
\inferrule[RInl]{ }{
  \refutable{\hinlp{p}}
}
\end{equation}
\begin{equation}\label{rule:RInr}
\inferrule[RInr]{ }{
  \refutable{\hinrp{p}}
}
\end{equation}
\begin{equation}\label{rule:RPairL}
\inferrule[RPairL]{
  \refutable{p_1}
}{
  \refutable{\hpair{p_1}{p_2}}
}
\end{equation}
\begin{equation}\label{rule:RPairR}
\inferrule[RPairR]{
  \refutable{p_2}
}{
  \refutable{\hpair{p_1}{p_2}}
}
\end{equation}
\end{subequations}

\judgboxa{
  \hpatmatch{e}{p}{\theta}
}{
  $e$ matches $p$, emitting $\theta$
}
\begin{subequations}\label{rules:match}
\begin{equation}\label{rule:MVar}
\inferrule[MVar]{ }{
  \hpatmatch{e}{x}{e / x}
}
\end{equation}
\begin{equation}\label{rule:MWild}
\inferrule[MWild]{ }{
  \hpatmatch{e}{\_}{\cdot}
}
\end{equation}
\begin{equation}\label{rule:MNum}
\inferrule[MNum]{ }{
  \hpatmatch{\hnum{n}}{\hnum{n}}{\cdot}
}
\end{equation}
\begin{equation}\label{rule:MPair}
\inferrule[MPair]{
  \hpatmatch{e_1}{p_1}{\theta_1} \\
  \hpatmatch{e_2}{p_2}{\theta_2}
}{
  \hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta_1 \uplus \theta_2}
}
\end{equation}
\begin{equation}\label{rule:MInl}
\inferrule[MInl]{
  \hpatmatch{e}{p}{\theta}
}{
  \hpatmatch{\hinl{\tau}{e}}{\hinlp{p}}{\theta}
}
\end{equation}
\begin{equation}\label{rule:MInr}
\inferrule[MInr]{
  \hpatmatch{e}{p}{\theta}
}{
  \hpatmatch{\hinr{\tau}{e}}{\hinrp{p}}{\theta}
}
\end{equation}
\begin{equation}\label{rule:MNotIntroPair}
\inferrule[MNotIntroPair]{
  \notIntro{e} \\
  \hpatmatch{\hprl{e}}{p_1}{\theta_1} \\
  \hpatmatch{\hprr{e}}{p_2}{\theta_2}
}{
  \hpatmatch{e}{\hpair{p_1}{p_2}}{\theta_1 \uplus \theta_2}
}
\end{equation}
\end{subequations}

\judgboxa{
  \hmaymatch{e}{p}
}{
  $e$ may match $p$
}
\begin{subequations}\label{rules:maymatch}
\begin{equation}\label{rule:MMEHole}
\inferrule[MMEHole]{ }{
  \hmaymatch{e}{\hehole{w}}
}
\end{equation}
\begin{equation}\label{rule:MMHole}
\inferrule[MMHole]{ }{
  \hmaymatch{e}{\hhole{p}{w}}
}
\end{equation}
\begin{equation}\label{rule:MMNotIntro}
\inferrule[MMNotIntro]{
  \notIntro{e} \\
  \refutable{p}
}{
  \hmaymatch{e}{p}
}
\end{equation}
\begin{equation}\label{rule:MMPairL}
\inferrule[MMPairL]{
  \hmaymatch{e_1}{p_1} \\
  \hpatmatch{e_2}{p_2}{\theta_2}
}{
  \hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}
}
\end{equation}
\begin{equation}\label{rule:MMPairR}
\inferrule[MMPairR]{
  \hpatmatch{e_1}{p_1}{\theta_1} \\
  \hmaymatch{e_2}{p_2}
}{
  \hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}
}
\end{equation}
\begin{equation}\label{rule:MMPair}
\inferrule[MMPair]{
  \hmaymatch{e_1}{p_1} \\
  \hmaymatch{e_2}{p_2}
}{
  \hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}
}
\end{equation}
\begin{equation}\label{rule:MMInl}
\inferrule[MMInl]{
  \hmaymatch{e}{p}
}{
  \hmaymatch{\hinl{\tau}{e}}{\hinlp{p}}
}
\end{equation}
\begin{equation}\label{rule:MMInr}
\inferrule[MMInr]{
  \hmaymatch{e}{p}
}{
  \hmaymatch{\hinr{\tau}{e}}{\hinrp{p}}
}
\end{equation}
\end{subequations}

\judgboxa{
  \hnotmatch{e}{p}
}{
  $e$ does not match $p$
}
\begin{subequations}\label{rules:notmatch}
\begin{equation}\label{rule:NMNum}
\inferrule[NMNum]{
  n_1 \neq n_2
}{
  \hnotmatch{\hnum{n_1}}{\hnum{n_2}}
}
\end{equation}
\begin{equation}\label{rule:NMPairL}
\inferrule[NMPairL]{
  \hnotmatch{e_1}{p_1}
}{
  \hnotmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}
}
\end{equation}
\begin{equation}\label{rule:NMPairR}
\inferrule[NMPairR]{
  \hnotmatch{e_2}{p_2}
}{
  \hnotmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}
}
\end{equation}
\begin{equation}\label{rule:NMConfL}
\inferrule[NMConfL]{ }{
  \hnotmatch{\hinr{\tau}{e}}{\hinlp{p}}
}
\end{equation}
\begin{equation}\label{rule:NMConfR}
\inferrule[NMConfR]{ }{
  \hnotmatch{\hinl{\tau}{e}}{\hinrp{p}}
}
\end{equation}
\begin{equation}\label{rule:NMInl}
\inferrule[NMInl]{
  \hnotmatch{e}{p}
}{
  \hnotmatch{\hinr{\tau}{e}}{\hinlp{p}}
}
\end{equation}
\begin{equation}\label{rule:NMInr}
\inferrule[NMInr]{
  \hnotmatch{e}{p}
}{
  \hnotmatch{\hinl{\tau}{e}}{\hinrp{p}}
}
\end{equation}
\end{subequations}

\judgboxa{\htrans{e}{e'}}{$e$ takes a step to $e'$}
\begin{subequations}\label{rules:ITExp}
\begin{equation}
\inferrule[ITHole]{
  \htrans{e}{e'}
}{
  \htrans{\hhole{e}{u}}{\hhole{e'}{u}}
}
\end{equation}
\begin{equation}
\inferrule[ITApFun]{
  \htrans{e_1}{e_1'}
}{
  \htrans{\hap{e_1}{e_2}}{\hap{e_1'}{e_2}}
}
\end{equation}
\begin{equation}
\inferrule[ITApArg]{
  \isVal{e_1} \\
  \htrans{e_2}{e_2'}
}{
  \htrans{\hap{e_1}{e_2}}{\hap{e_1}{e_2'}}
}
\end{equation}
\begin{equation}
\inferrule[ITAP]{
  \isVal{e_2}
}{
  \hap{\hlam{x}{\tau}{e_1}}{e_2} \mapsto
    [e_2/x]e_1
}
\end{equation}
\begin{equation}
\inferrule[ITPairL]{
  \htrans{e_1}{e_1'}
}{
  \htrans{\hpair{e_1}{e_2}}{\hpair{e_1'}{e_2}}
}
\end{equation}
\begin{equation}
\inferrule[ITPairR]{
  \isVal{e_1} \\
  \htrans{e_2}{e_2'}
}{
  \htrans{\hpair{e_1}{e_2}}{\hpair{e_1}{e_2'}}
}
\end{equation}
\begin{equation}
\inferrule[ITPrl]{
  \isFinal{\hpair{e_1}{e_2}}
}{
  \htrans{\hprl{\hpair{e_1}{e_2}}}{e_1}
}
\end{equation}
\begin{equation}
\inferrule[ITPrr]{
  \isFinal{\hpair{e_1}{e_2}}
}{
  \htrans{\hprr{\hpair{e_1}{e_2}}}{e_2}
}
\end{equation}
\begin{equation}
\inferrule[ITInl]{
  \htrans{e}{e'}
}{
  \htrans{\hinl{\tau}{e}}{\hinl{\tau}{e'}}
}
\end{equation}
\begin{equation}
\inferrule[ITInr]{
  \htrans{e}{e'}
}{
  \htrans{\hinr{\tau}{e}}{\hinr{\tau}{e'}}
}
\end{equation}
\begin{equation}\label{rule:ITExpMatch}
\inferrule[ITExpMatch]{
  \htrans{e}{e'}
}{
  \htrans{\hmatch{e}{\zrules}}{\hmatch{e'}{\zrules}}
}
\end{equation}
\begin{equation}\label{rule:ITSuccMatch}
\inferrule[ITSuccMatch]{
  \isFinal{e} \\
  \hpatmatch{e}{p_r}{\theta}
}{
  \htrans{
    \hmatch{e}{\zruls{rs_{pre}}{\hrulP{p_r}{e_r}}{rs_{post}}}
  }{
    [\theta](e_r)
  }
}
\end{equation}
\begin{equation}\label{rule:ITFailMatch}
\inferrule[ITFailMatch]{
  \isFinal{e} \\
  \hnotmatch{e}{p_r}
}{
  \htrans{
    \hmatch{e}{\zruls{rs}{\hrulP{p_r}{e_r}}{\hrulesP{r'}{rs'}}}
  }{
    \hmatch{e}{
      \zruls{
        \rmpointer{\zruls{rs}{\hrulP{p_r}{e_r}}{\cdot}}
      }{r'}{rs'}
    }
  }
}
\end{equation}
\end{subequations}

\begin{lemma}
  \label{lem:inl-final}
  If $\isFinal{\hinl{\tau_2}{e_1}}$ then $\isFinal{e_1}$.
\end{lemma}
\begin{proof}
By rule induction over Rules (\ref{rules:Final}) on $\isFinal{\hinl{\tau_2}{e_1}}$.
\begin{byCases}
\savelocalsteps{0}
\item[\text{(\ref{rule:FVal})}]
    \begin{pfsteps*}
    \item $\isVal{\hinl{\tau_2}{e_1}}$ \BY{assumption} \pflabel{inl-val}
    \end{pfsteps*}
    By rule induction over Rules (\ref{rules:Value}) on \pfref{inl-val}, only one case applies.
    \begin{byCases}
    \item[\text{(\ref{rule:VInl})}]
        \begin{pfsteps*}
        \item $\isVal{e_1}$ \BY{assumption} \pflabel{val}
        \item $\isFinal{e_1}$ \BY{Rule (\ref{rule:FVal}) on \pfref{val}}
        \end{pfsteps*}
    \end{byCases}
\restorelocalsteps{0}
\item[\text{(\ref{rule:FIndet})}]
    \begin{pfsteps*}
    \item $\isIndet{\hinl{\tau_2}{e_1}}$ \BY{assumption} \pflabel{inl-indet}
    \end{pfsteps*}
    By rule induction over Rules (\ref{rules:Indet}) on \pfref{inl-indet}, only one case applies.
    \begin{byCases}
    \item[\text{(\ref{rule:IInl})}]
        \begin{pfsteps*}
        \item $\isIndet{e_1}$ \BY{assumption} \pflabel{indet}
        \item $\isFinal{e_1}$ \BY{Rule (\ref{rule:FIndet}) on \pfref{indet}}
        \end{pfsteps*}
    \end{byCases}
\end{byCases}
\resetpfcounter
\end{proof}

\begin{lemma}
  \label{lem:inr-final}
  If $\isFinal{\hinr{\tau_1}{e_2}}$ then $\isFinal{e_2}$.
\end{lemma}
\begin{proof}
By rule induction over Rules (\ref{rules:Final}) on $\isFinal{\hinr{\tau_1}{e_2}}$.
\begin{byCases}
\savelocalsteps{0}
\item[\text{(\ref{rule:FVal})}]
    \begin{pfsteps*}
    \item $\isVal{\hinr{\tau_1}{e_2}}$ \BY{assumption} \pflabel{inr-val}
    \end{pfsteps*}
    By rule induction over Rules (\ref{rules:Value}) on \pfref{inr-val}, only one case applies.
    \begin{byCases}
    \item[\text{(\ref{rule:VInl})}]
        \begin{pfsteps*}
        \item $\isVal{e_2}$ \BY{assumption} \pflabel{val}
        \item $\isFinal{e_2}$ \BY{Rule (\ref{rule:FVal}) on \pfref{val}}
        \end{pfsteps*}
    \end{byCases}
\restorelocalsteps{0}
\item[\text{(\ref{rule:FIndet})}]
    \begin{pfsteps*}
    \item $\isIndet{\hinr{\tau_1}{e_2}}$ \BY{assumption} \pflabel{inr-indet}
    \end{pfsteps*}
    By rule induction over Rules (\ref{rules:Indet}) on \pfref{inr-indet}, only one case applies.
    \begin{byCases}
    \item[\text{(\ref{rule:IInl})}]
        \begin{pfsteps*}
        \item $\isIndet{e_2}$ \BY{assumption} \pflabel{indet}
        \item $\isFinal{e_2}$ \BY{Rule (\ref{rule:FIndet}) on \pfref{indet}}
        \end{pfsteps*}
    \end{byCases}
\end{byCases}
\resetpfcounter
\end{proof}

\begin{lemma}
  \label{lem:pair-final}
  If $\isFinal{\hpair{e_1}{e_2}}$ then $\isFinal{e_1}$ and $\isFinal{e_2}$.
\end{lemma}
\begin{proof}
By rule induction over Rules (\ref{rules:Final}) on $\isFinal{\hpair{e_1}{e_2}}$.
\begin{byCases}
\savelocalsteps{0}
\item[\text{(\ref{rule:FVal})}]
    \begin{pfsteps*}
    \item $\isVal{\hpair{e_1}{e_2}}$ \BY{assumption} \pflabel{pair-val}
    \end{pfsteps*}
    By rule induction over Rules (\ref{rules:Value}) on \pfref{pair-val}, only one case applies.
    \begin{byCases}
    \item[\text{(\ref{rule:VPair})}]
        \begin{pfsteps*}
        \item $\isVal{e_1}$ \BY{assumption} \pflabel{e1-val}
        \item $\isVal{e_2}$ \BY{assumption} \pflabel{e2-val}
        \item $\isFinal{e_1}$ \BY{Rule (\ref{rule:FVal}) on \pfref{e1-val}}
        \item $\isFinal{e_2}$ \BY{Rule (\ref{rule:FVal}) on \pfref{e2-val}}
        \end{pfsteps*}
    \end{byCases}
\restorelocalsteps{0}
\item[\text{(\ref{rule:FIndet})}]
    \begin{pfsteps*}
    \item $\isIndet{\hpair{e_1}{e_2}}$ \BY{assumption} \pflabel{pair-indet}
    \end{pfsteps*}
    By rule induction over Rules (\ref{rules:Indet}) on \pfref{pair-indet}, only three cases apply.
    \begin{byCases}
    \savelocalsteps{1}
    \item[\text{(\ref{rule:IPairL})}]
        \begin{pfsteps*}
        \item $\isIndet{e_1}$ \BY{assumption} \pflabel{[indet1]e1-indet}
        \item $\isVal{e_2}$ \BY{assumption} \pflabel{[indet1]e2-val}
        \item $\isFinal{e_1}$ \BY{Rule (\ref{rule:FIndet}) on \pfref{[indet1]e1-indet}}
        \item $\isFinal{e_1}$ \BY{Rule (\ref{rule:FVal}) on \pfref{[indet1]e2-val}}
        \end{pfsteps*}
    \restorelocalsteps{1}
    \item[\text{(\ref{rule:IPairR})}]
        \begin{pfsteps*}
        \item $\isVal{e_1}$ \BY{assumption} \pflabel{[indet2]e1-val}
        \item $\isIndet{e_2}$ \BY{assumption} \pflabel{[indet2]e2-indet}
        \item $\isFinal{e_1}$ \BY{Rule (\ref{rule:FVal}) on \pfref{[indet2]e1-val}}
        \item $\isFinal{e_1}$ \BY{Rule (\ref{rule:FIndet}) on \pfref{[indet2]e2-indet}}
        \end{pfsteps*}
    \restorelocalsteps{1}
    \item[\text{(\ref{rule:IPair})}]
        \begin{pfsteps*}
        \item $\isIndet{e_1}$ \BY{assumption} \pflabel{[indet3]e1-indet}
        \item $\isIndet{e_2}$ \BY{assumption} \pflabel{[indet3]e2-indet}
        \item $\isFinal{e_1}$ \BY{Rule (\ref{rule:FIndet}) on \pfref{[indet3]e1-indet}}
        \item $\isFinal{e_1}$ \BY{Rule (\ref{rule:FIndet}) on \pfref{[indet3]e2-indet}}
        \end{pfsteps*}
    \end{byCases}
\end{byCases}
\resetpfcounter
\end{proof}

\begin{lemma}
  \label{lem:no-num-notintro}
  There doesn't exist $\hnum{n}$ such that $\notIntro{\hnum{n}}$.
\end{lemma}
\begin{proof}
    By rule induction over Rules (\ref{rules:notintro}) on $\notIntro{\hnum{n}}$, no case applies due to syntactic contradiction.
\end{proof}

\begin{lemma}
  \label{lem:no-inl-notintro}
  There doesn't exist $\hinl{\tau}{e}$ such that $\notIntro{\hinl{\tau}{e}}$.
\end{lemma}
\begin{proof}
    By rule induction over Rules (\ref{rules:notintro}) on $\notIntro{\hinl{\tau}{e}}$, no case applies due to syntactic contradiction.
\end{proof}

\begin{lemma}
  \label{lem:no-inr-notintro}
  There doesn't exist $\hinr{\tau}{e}$ such that $\notIntro{\hinr{\tau}{e}}$.
\end{lemma}
\begin{proof}
    By rule induction over Rules (\ref{rules:notintro}) on $\notIntro{\hinr{\tau}{e}}$, no case applies due to syntactic contradiction.
\end{proof}

\begin{lemma}
  \label{lem:no-pair-notintro}
  There doesn't exist $\hpair{e_1}{e_2}$ such that $\notIntro{\hpair{e_1}{e_2}}$.
\end{lemma}
\begin{proof}
    By rule induction over Rules (\ref{rules:notintro}) on $\notIntro{\hpair{e_1}{e_2}}$, no case applies due to syntactic contradiction.
\end{proof}

\begin{lemma}
  \label{lem:final-notintro-indet}
  If $\isFinal{e}$ and $\notIntro{e}$ then $\isIndet{e}$.
\end{lemma}
\begin{proof}[Proof Sketch]
By rule induction over Rules (\ref{rules:notintro}) on  $\notIntro{e}$, for each case, by rule induction over Rules (\ref{rules:Value}) on $\isVal{e}$ and we notice that $\isVal{e}$ is not derivable. By rule induction over Rules (\ref{rules:Final}) on $\isFinal{e}$, Rule (\ref{rule:FVal}) result in a contradiction with the fact that $\isVal{e}$ is not derivable while Rule (\ref{rule:FIndet}) tells us $\isIndet{e}$.
\end{proof}

\begin{lemma}
  \label{lem:val-not-indet}
  There doesn't exist such an expression $e$ such that both $\isVal{e}$ and $\isIndet{e}$.
\end{lemma}

\begin{lemma}
  \label{lem:val-not-notintro}
  There doesn't exist such an expression $e$ such that both $\isVal{e}$ and $\notIntro{e}$.
\end{lemma}

\begin{lemma}[Finality]
  \label{lem:finality}
  There doesn't exist such an expression $e$ such that both $\isFinal{e}$ and $\htrans{e}{e'}$ for some $e'$
\end{lemma}
\begin{proof}Assume there exists such an $e$ such that both $\isFinal{e}$ and $\htrans{e}{e'}$ for some $e'$ then proof by contradiction.
 
  By rule induction over Rules (\ref{rules:Final}) and Rules (\ref{rules:ITExp}), \textit{i.e.}, over Rules (\ref{rules:Value}) and Rules (\ref{rules:ITExp}) and over Rules (\ref{rules:Indet}) and Rules (\ref{rules:ITExp}) respectively. The proof can be done by straightforward observation of syntactic contradictions.
\end{proof}

\begin{lemma}[Matching Determinism]
  \label{lem:match-determinism}
  If $\isFinal{e}$ and $\hexptyp{\cdot}{\Delta_e}{e}{\tau}$ and $\chpattyp{p}{\tau}{\xi}{\Gamma}{\Delta}$ then exactly one of the following holds
  \begin{enumerate}
    \item $\hpatmatch{e}{p}{\theta}$ for some $\theta$
    \item $\hmaymatch{e}{p}$
    \item $\hnotmatch{e}{p}$
  \end{enumerate}
\end{lemma}
\begin{proof}
\begin{pfsteps*}
\item $\isFinal{e}$ \BY{assumption} \pflabel{e-final}
\item $\hexptyp{\cdot}{\Delta_e}{e}{\tau}$ \BY{assumption} \pflabel{e-typ}
\item $\chpattyp{p}{\tau}{\xi}{\Gamma}{\Delta}$ \BY{assumption} \pflabel{p-typ}
\end{pfsteps*}
By rule induction over Rules (\ref{rules:PatTyp}) on \pfref{p-typ}, we would show one conclusion is derivable while the other two are not.
\begin{byCases}
\savelocalsteps{0}
\item[\text{(\ref{rule:PTVar})}]
    \begin{pfsteps*}
    \item $p=x$ \BY{assumption}
    \item $\hpatmatch{e}{x}{e / x}$ \BY{\ruleref{rule:MVar}}
    \end{pfsteps*}
    Assume $\hmaymatch{e}{x}$. By rule induction over \rulesref{rules:maymatch} on it, only one case applies.
    \begin{byCases}
    \item[\text{(\ref{rule:MMNotIntro})}]
        \begin{pfsteps*}
        \item $\refutable{x}$ \BY{assumption} \pflabel{[var]rft}
        \end{pfsteps*}
        By rule induction over \rulesref{rules:p-refutable} on \pfref{[var]rft}, no case applies due to syntactic contradiction.
    \end{byCases}
    \begin{pfsteps*}
    \item $\cancel{\hmaymatch{e}{x}}$ \BY{contradiction}
    \end{pfsteps*}
    Assume $\hnotmatch{e}{x}$. By rule induction over \rulesref{rules:notmatch} on it, no case applies due to syntactic contradiction.
    \begin{pfsteps*}
    \item $\cancel{\hnotmatch{e}{x}}$ \BY{contradiction}
    \end{pfsteps*}
\restorelocalsteps{0}
\item[\text{(\ref{rule:PTWild})}]
    \begin{pfsteps*}
    \item $p=\_$ \BY{assumption}
    \item $\hpatmatch{e}{\_}{\cdot}$ \BY{\ruleref{rule:MWild}}
    \end{pfsteps*}
    Assume $\hmaymatch{e}{\_}$. By rule induction over \rulesref{rules:maymatch} on it, only one case applies.
    \begin{byCases}
    \item[\text{(\ref{rule:MMNotIntro})}]
        \begin{pfsteps*}
        \item $\refutable{\_}$ \BY{assumption} \pflabel{[wild]rft}
        \end{pfsteps*}
        By rule induction over \rulesref{rules:p-refutable} on \pfref{[wild]rft}, no case applies due to syntactic contradiction.
    \end{byCases}
    \begin{pfsteps*}
    \item $\cancel{\hmaymatch{e}{\_}}$ \BY{contradiction}
    \end{pfsteps*}
    Assume $\hnotmatch{e}{\_}$. By rule induction over \rulesref{rules:notmatch} on it, no case applies due to syntactic contradiction.
    \begin{pfsteps*}
    \item $\cancel{\hnotmatch{e}{\_}}$ \BY{contradiction}
    \end{pfsteps*}
\restorelocalsteps{0}
\item[\text{(\ref{rule:PTEHole})}]
    \begin{pfsteps*}
    \item $p=\hehole{w}$ \BY{assumption}
    \item $\hmaymatch{e}{\hehole{w}}$ \BY{\ruleref{rule:MMEHole}}
    \end{pfsteps*}
    Assume $\hpatmatch{e}{\hehole{w}}{\theta}$ for some $\theta$. By rule induction over \rulesref{rules:maymatch} on it, no case applies due to syntactic contradiction.
    \begin{pfsteps*}
    \item $\cancel{\hpatmatch{e}{\hehole{w}}{\theta}}$ \BY{contradiction}
    \end{pfsteps*}
    Assume $\hnotmatch{e}{\hehole{w}}$. By rule induction over \rulesref{rules:notmatch} on it, no case applies due to syntactic contradiction.
    \begin{pfsteps*}
    \item $\cancel{\hnotmatch{e}{\hehole{w}}}$ \BY{contradiction}
    \end{pfsteps*}
\restorelocalsteps{0}
\item[\text{(\ref{rule:PTHole})}]
    \begin{pfsteps*}
    \item $p=\hhole{p_0}{w}$ \BY{assumption}
    \item $\hmaymatch{e}{\hhole{p_0}{w}}$ \BY{\ruleref{rule:MMHole}}
    \end{pfsteps*}
    Assume $\hpatmatch{e}{\hhole{p_0}{w}}{\theta}$ for some $\theta$. By rule induction over \rulesref{rules:maymatch} on it, no case applies due to syntactic contradiction.
    \begin{pfsteps*}
    \item $\cancel{\hpatmatch{e}{\hhole{p_0}{w}}{\theta}}$ \BY{contradiction}
    \end{pfsteps*}
    Assume $\hnotmatch{e}{\hhole{p_0}{w}}$. By rule induction over \rulesref{rules:notmatch} on it, no case applies due to syntactic contradiction.
    \begin{pfsteps*}
    \item $\cancel{\hnotmatch{e}{\hhole{p_0}{w}}}$ \BY{contradiction}
    \end{pfsteps*}
\restorelocalsteps{0}
\item[\text{(\ref{rule:PTNum})}]
    \begin{pfsteps*}
    \item $p=\hnum{n_2}$ \BY{assumption}
    \item $\tau=\tnum$ \BY{assumption}
    \item $\xi=\cnum{n_2}$ \BY{assumption}
    \item $\refutable{\hnum{n_2}}$ \BY{\ruleref{rule:RNum}} \pflabel{[num]rft}
    \end{pfsteps*}
    By rule induction over Rules (\ref{rules:TExp}) on \pfref{e-typ}, the following cases apply.
    \begin{byCases}
    \savelocalsteps{1}
    \item[\text{(\ref{rule:TEHole}),(\ref{rule:THole}),(\ref{rule:TAp}),(\ref{rule:TPrl}),(\ref{rule:TPrr}),(\ref{rule:TMatchZPre}),(\ref{rule:TMatchNZPre})}]
        \begin{pfsteps*}
        \item $e=\hehole{u},\hhole{e_0}{u},\hap{e_1}{e_2},\hprl{e_0},\hprr{e_0},\hmatch{e_0}{\zrules}$ \BY{assumption}
        \item $\notIntro{e}$ \BY{Rule (\ref{rule:NVEHole}),(\ref{rule:NVHole}),(\ref{rule:NVAp}),(\ref{rule:NVMatch}),(\ref{rule:NVPrl}),(\ref{rule:NVPrr})} \pflabel{[num]notintro}
        \item $\hmaymatch{e}{\hnum{n_2}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[num]rft} and \pfref{[num]notintro}}
        \end{pfsteps*}
        Assume $\hpatmatch{e}{\hnum{n_2}}{\theta}$ for some $\theta$. By rule induction over it, no case applies due to syntactic contradiction.
        \begin{pfsteps*}
        \item $\cancel{\hpatmatch{e}{\hnum{n_2}}{\theta}}$ \BY{contradiction}
        \end{pfsteps*}
        Assume $\hnotmatch{e}{\hnum{n_2}}$. By rule induction over it, no case applies due to syntactic contradiction.
        \begin{pfsteps*}
        \item $\cancel{\hnotmatch{e}{\hnum{n_2}}}$ \BY{contradiction}
        \end{pfsteps*}
    \restorelocalsteps{1}
    \item[\text{(\ref{rule:TNum})}]
        \begin{pfsteps*}
        \item $e=\hnum{n_1}$
        \end{pfsteps*}
        Assume $\hmaymatch{\hnum{n_1}}{\hnum{n_2}}$. By rule induction over \rulesref{rules:maymatch} on it, only two cases apply.
        \begin{byCases}
        \item[\text{(\ref{rule:MMNotIntro})}]
            \begin{pfsteps*}
            \item $\notIntro{\hnum{n_1}}$ \BY{assumption}
            \end{pfsteps*}
            Contradicts \autoref{lem:no-num-notintro}.
        \end{byCases}
        \begin{pfsteps*}
        \item $\cancel{\hmaymatch{\hnum{n_1}}{\hnum{n_2}}}$ \BY{contradiction}
        \end{pfsteps*}
        By case analysis on whether $n_1=n_2$.
        \begin{byCases}
        \savelocalsteps{2}
        \item[n_1=n_2]
            \begin{pfsteps*}
            \item $n_1=n_2$ \BY{assumption} \pflabel{[num]eq}
            \item $\hpatmatch{\hnum{n_1}}{\hnum{n_2}}{\cdot}$ \BY{\ruleref{rule:MNum}}
            \end{pfsteps*}
            Assume $\hnotmatch{\hnum{n_1}}{\hnum{n_2}}$. By rule induction over \rulesref{rules:notmatch} on it, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:NMNum})}]
                \begin{pfsteps*}
                \item $n_1\neq n_2$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[num]eq}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hnotmatch{\hnum{n_1}}{\hnum{n_2}}}$ \BY{contradiction}
            \end{pfsteps*}
        \restorelocalsteps{2}
        \item[n_1\neq n_2]
            \begin{pfsteps*}
            \item $n_1\neq n_2$ \BY{assumption} \pflabel{[num]neq}
            \item $\hnotmatch{\hnum{n_1}}{\hnum{n_2}}$ \BY{\ruleref{rule:NMNum} on \pfref{[num]neq}}
            \end{pfsteps*}
            Assume $\hpatmatch{\hnum{n_1}}{\hnum{n_2}}{\theta}$ for some $\theta$. By rule induction over \rulesref{rules:match} on it, no case applies due to syntactic contradiction.
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{\hnum{n_1}}{\hnum{n_2}}{\theta}}$ \BY{contradiction}
            \end{pfsteps*}
        \end{byCases}
    \end{byCases}
\restorelocalsteps{0}
\item[\text{(\ref{rule:PTInl})}]
    \begin{pfsteps*}
    \item $p=\hinlp{p_1}$ \BY{assumption}
    \item $\tau=\tsum{\tau_1}{\tau_2}$ \BY{assumption}
    \item $\xi=\cinl{\xi_1}$ \BY{assumption}
    \item $\chpattyp{p_1}{\tau_1}{\xi_1}{\Gamma}{\Delta}$ \BY{assumption} \pflabel{[inl]p1-typ}
    \item $\refutable{\hinlp{p_1}}$ \BY{\ruleref{rule:RInl}} \pflabel{[inl]rft}
    \end{pfsteps*}
    By rule induction over Rules (\ref{rules:TExp}) on \pfref{e-typ}, the following cases apply.
    \begin{byCases}
    \savelocalsteps{1}
    \item[\text{(\ref{rule:TEHole}),(\ref{rule:THole}),(\ref{rule:TAp}),(\ref{rule:TPrl}),(\ref{rule:TPrr}),(\ref{rule:TMatchZPre}),(\ref{rule:TMatchNZPre})}]
        \begin{pfsteps*}
        \item $e=\hehole{u},\hhole{e_0}{u},\hap{e_1}{e_2},\hprl{e_0},\hprr{e_0},\hmatch{e_0}{\zrules}$ \BY{assumption}
        \item $\notIntro{e}$ \BY{Rule (\ref{rule:NVEHole}),(\ref{rule:NVHole}),(\ref{rule:NVAp}),(\ref{rule:NVMatch}),(\ref{rule:NVPrl}),(\ref{rule:NVPrr})} \pflabel{[inl]notintro}
        \item $\hmaymatch{e}{\hinlp{p_1}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[inl]rft} and \pfref{[inl]notintro}}
        \end{pfsteps*}
        Assume $\hpatmatch{e}{\hinlp{p_1}}{\theta_1}$ for some $\theta_1$. By rule induction over it, no case applies due to syntactic contradiction.
        \begin{pfsteps*}
        \item $\cancel{\hpatmatch{e}{\hinlp{p_1}}{\theta_1}}$ \BY{contradiction}
        \end{pfsteps*}
        Assume $\hnotmatch{e}{\hinlp{p_1}}$. By rule induction over it, no case applies due to syntactic contradiction.
        \begin{pfsteps*}
        \item $\cancel{\hnotmatch{e}{\hinlp{p_1}}}$ \BY{contradiction}
        \end{pfsteps*}
    \restorelocalsteps{1}
    \item[\text{(\ref{rule:TInl})}]
        \begin{pfsteps*}
        \item $e=\hinl{\tau_2}{e_1}$ \BY{assumption}
        \item $\hexptyp{\cdot}{\Delta_e}{e_1}{\tau_1}$ \BY{assumption} \pflabel{[inl]e1-typ}
        \item $\isFinal{e_1}$ \BY{\autoref{lem:inl-final} on \pfref{e-final}} \pflabel{[inl]e1-final}
        \end{pfsteps*}
        By inductive hypothesis on \pfref{[inl]e1-typ} and \pfref{[inl]e1-final} and \pfref{[inl]p1-typ}, exactly one of $\hpatmatch{e_1}{p_1}{\theta_1}$ for some $\theta_1$, $\hmaymatch{e_1}{p_1}$, and $\hnotmatch{e_1}{p_1}$ holds.\\
        By case analysis on which one holds.
        \begin{byCases}
        \savelocalsteps{2}
        \item[\hpatmatch{e_1}{p_1}{\theta_1}]
            \begin{pfsteps*}
            \item $\hpatmatch{e_1}{p_1}{\theta_1}$ \BY{assumption} \pflabel{[inl1]match}
            \item $\cancel{\hmaymatch{e_1}{p_1}}$ \BY{assumption} \pflabel{[inl1]not-maymatch}
            \item $\cancel{\hnotmatch{e_1}{p_1}}$ \BY{assumption} \pflabel{[inl1]not-notmatch}
            \item $\hpatmatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}{\theta_1}$ \BY{\ruleref{rule:MInl} on \pfref{[inl1]match}}
            \end{pfsteps*}
            Assume $\hmaymatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}$. By rule induction over \rulesref{rules:maymatch} on it, only two cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:MMNotIntro})}]
                \begin{pfsteps*}
                \item $\notIntro{\hinl{\tau_2}{e_1}}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \autoref{lem:no-inl-notintro}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMInl})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_1}{p_1}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[inl1]not-maymatch}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hmaymatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}}$ \BY{contradiction}
            \end{pfsteps*}
            Assume $\hnotmatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}$. By rule induction over \rulesref{rules:notmatch} on it, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:NMInl})}]
                \begin{pfsteps*}
                \item $\hnotmatch{e_1}{p_1}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[inl1]not-notmatch}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hnotmatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}}$ \BY{contradiction}
            \end{pfsteps*}
        \restorelocalsteps{2}
        \item[\hmaymatch{e_1}{p_1}]
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{e_1}{p_1}{\theta_1}}$ \BY{assumption} \pflabel{[inl2]not-match}
            \item $\hmaymatch{e_1}{p_1}$ \BY{assumption} \pflabel{[inl2]maymatch}
            \item $\cancel{\hnotmatch{e_1}{p_1}}$ \BY{assumption} \pflabel{[inl2]not-notmatch}
            \item $\hmaymatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}$ \BY{\ruleref{rule:MMInl} on \pfref{[inl2]maymatch}}
            \end{pfsteps*}
            Assume $\hpatmatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}{\theta}$ for some $\theta$. By rule induction over \rulesref{rules:match} on it, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:MInl})}]
                \begin{pfsteps*}
                \item $\hpatmatch{e_1}{p_1}{\theta}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[inl2]not-match}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}{\theta}}$ \BY{contradiction}
            \end{pfsteps*}
            Assume $\hnotmatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}$. By rule induction over \rulesref{rules:notmatch} on it, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:NMInl})}]
                \begin{pfsteps*}
                \item $\hnotmatch{e_1}{p_1}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[inl2]not-notmatch}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hnotmatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}}$ \BY{contradiction}
            \end{pfsteps*}
        \restorelocalsteps{2}
        \item[\hnotmatch{e_1}{p_1}]
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{e_1}{p_1}{\theta_1}}$ \BY{assumption} \pflabel{[inl3]not-match}
            \item $\cancel{\hmaymatch{e_1}{p_1}}$ \BY{assumption} \pflabel{[inl3]not-maymatch}
            \item $\hnotmatch{e_1}{p_1}$ \BY{assumption} \pflabel{[inl3]notmatch}
            \item $\hnotmatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}$ \BY{\ruleref{rule:NMInl} on \pfref{[inl3]notmatch}}
            \end{pfsteps*}
            Assume $\hpatmatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}{\theta}$ for some $\theta$. By rule induction over \rulesref{rules:match} on it, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:MInl})}]
                \begin{pfsteps*}
                \item $\hpatmatch{e_1}{p_1}{\theta}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[inl3]not-match}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}{\theta}}$ \BY{contradiction}
            \end{pfsteps*}
            Assume $\hmaymatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}$. By rule induction over \rulesref{rules:maymatch} on it, only two cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:MMNotIntro})}]
                \begin{pfsteps*}
                \item $\notIntro{\hinl{\tau_2}{e_1}}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \autoref{lem:no-inl-notintro}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMInl})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_1}{p_1}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[inl3]not-maymatch}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hmaymatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}}$ \BY{contradiction}
            \end{pfsteps*}
        \end{byCases}
    \end{byCases}
\restorelocalsteps{0}
\item[\text{(\ref{rule:PTInr})}]
    \begin{pfsteps*}
    \item $p=\hinrp{p_2}$ \BY{assumption}
    \item $\tau=\tsum{\tau_1}{\tau_2}$ \BY{assumption}
    \item $\xi=\cinr{\xi_2}$ \BY{assumption}
    \item $\chpattyp{p_2}{\tau_2}{\xi_2}{\Gamma}{\Delta}$ \BY{assumption} \pflabel{[inr]p2-typ}
    \item $\refutable{\hinrp{p_2}}$ \BY{\ruleref{rule:RInr}} \pflabel{[inr]rft}
    \end{pfsteps*}
    By rule induction over Rules (\ref{rules:TExp}) on \pfref{e-typ}, the following cases apply.
    \begin{byCases}
    \savelocalsteps{1}
    \item[\text{(\ref{rule:TEHole}),(\ref{rule:THole}),(\ref{rule:TAp}),(\ref{rule:TPrl}),(\ref{rule:TPrr}),(\ref{rule:TMatchZPre}),(\ref{rule:TMatchNZPre})}]
        \begin{pfsteps*}
        \item $e=\hehole{u},\hhole{e_0}{u},\hap{e_1}{e_2},\hprl{e_0},\hprr{e_0},\hmatch{e_0}{\zrules}$ \BY{assumption}
        \item $\notIntro{e}$ \BY{Rule (\ref{rule:NVEHole}),(\ref{rule:NVHole}),(\ref{rule:NVAp}),(\ref{rule:NVMatch}),(\ref{rule:NVPrl}),(\ref{rule:NVPrr})} \pflabel{[inr]notintro}
        \item $\hmaymatch{e}{\hinrp{p_2}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[inr]rft} and \pfref{[inr]notintro}}
        \end{pfsteps*}
        Assume $\hpatmatch{e}{\hinrp{p_2}}{\theta_2}$ for some $\theta_2$. By rule induction over it, no case applies due to syntactic contradiction.
        \begin{pfsteps*}
        \item $\cancel{\hpatmatch{e}{\hinrp{p_2}}{\theta_2}}$ \BY{contradiction}
        \end{pfsteps*}
        Assume $\hnotmatch{e}{\hinrp{p_2}}$. By rule induction over it, no case applies due to syntactic contradiction.
        \begin{pfsteps*}
        \item $\cancel{\hnotmatch{e}{\hinrp{p_2}}}$ \BY{contradiction}
        \end{pfsteps*}
    \restorelocalsteps{1}
    \item[\text{(\ref{rule:TInr})}]
        \begin{pfsteps*}
        \item $e=\hinr{\tau_1}{e_2}$ \BY{assumption}
        \item $\hexptyp{\cdot}{\Delta_e}{e_2}{\tau_2}$ \BY{assumption} \pflabel{[inr]e2-typ}
        \item $\isFinal{e_2}$ \BY{\autoref{lem:inr-final} on \pfref{e-final}} \pflabel{[inr]e2-final}
        \end{pfsteps*}
        By inductive hypothesis on \pfref{[inr]e2-typ} and \pfref{[inr]e2-final} and \pfref{[inr]p2-typ}, exactly one of $\hpatmatch{e_2}{p_2}{\theta_2}$ for some $\theta_2$, $\hmaymatch{e_2}{p_2}$, and $\hnotmatch{e_2}{p_2}$ holds.\\
        By case analysis on which one holds.
        \begin{byCases}
        \savelocalsteps{2}
        \item[\hpatmatch{e_2}{p_2}{\theta_2}]
            \begin{pfsteps*}
            \item $\hpatmatch{e_2}{p_2}{\theta_2}$ \BY{assumption} \pflabel{[inr1]match}
            \item $\cancel{\hmaymatch{e_2}{p_2}}$ \BY{assumption} \pflabel{[inr1]not-maymatch}
            \item $\cancel{\hnotmatch{e_2}{p_2}}$ \BY{assumption} \pflabel{[inr1]not-notmatch}
            \item $\hpatmatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}{\theta_2}$ \BY{\ruleref{rule:MInr} on \pfref{[inr1]match}}
            \end{pfsteps*}
            Assume $\hmaymatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}$. By rule induction over \rulesref{rules:maymatch} on it, only two cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:MMNotIntro})}]
                \begin{pfsteps*}
                \item $\notIntro{\hinr{\tau_1}{e_2}}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \autoref{lem:no-inr-notintro}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMInr})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_2}{p_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[inr1]not-maymatch}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hmaymatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}}$ \BY{contradiction}
            \end{pfsteps*}
            Assume $\hnotmatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}$. By rule induction over \rulesref{rules:notmatch} on it, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:NMInr})}]
                \begin{pfsteps*}
                \item $\hnotmatch{e_2}{p_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[inr1]not-notmatch}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hnotmatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}}$ \BY{contradiction}
            \end{pfsteps*}
        \restorelocalsteps{2}
        \item[\hmaymatch{e_2}{p_2}]
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{e_2}{p_2}{\theta}}$ \BY{assumption} \pflabel{[inr2]not-match}
            \item $\hmaymatch{e_2}{p_2}$ \BY{assumption} \pflabel{[inr2]maymatch}
            \item $\cancel{\hnotmatch{e_2}{p_2}}$ \BY{assumption} \pflabel{[inr2]not-notmatch}
            \item $\hmaymatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}$ \BY{\ruleref{rule:MMInr} on \pfref{[inr2]maymatch}}
            \end{pfsteps*}
            Assume $\hpatmatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}{\theta}$ for some $\theta$. By rule induction over \rulesref{rules:match} on it, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:MInr})}]
                \begin{pfsteps*}
                \item $\hpatmatch{e_2}{p_2}{\theta}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[inr2]not-match}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}{\theta}}$ \BY{contradiction}
            \end{pfsteps*}
            Assume $\hnotmatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}$. By rule induction over \rulesref{rules:notmatch} on it, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:NMInr})}]
                \begin{pfsteps*}
                \item $\hnotmatch{e_2}{p_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[inr2]not-notmatch}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hnotmatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}}$ \BY{contradiction}
            \end{pfsteps*}
        \restorelocalsteps{2}
        \item[\hnotmatch{e_2}{p_2}]
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{e_2}{p_2}{\theta}}$ \BY{assumption} \pflabel{[inr3]not-match}
            \item $\cancel{\hmaymatch{e_2}{p_2}}$ \BY{assumption} \pflabel{[inr3]not-maymatch}
            \item $\hnotmatch{e_2}{p_2}$ \BY{assumption} \pflabel{[inr3]notmatch}
            \item $\hnotmatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}$ \BY{\ruleref{rule:NMInr} on \pfref{[inr3]notmatch}}
            \end{pfsteps*}
            Assume $\hpatmatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}{\theta}$ for some $\theta$. By rule induction over \rulesref{rules:match} on it, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:MInr})}]
                \begin{pfsteps*}
                \item $\hpatmatch{e_2}{p_2}{\theta}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[inr3]not-match}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}{\theta}}$ \BY{contradiction}
            \end{pfsteps*}
            Assume $\hmaymatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}$. By rule induction over \rulesref{rules:maymatch} on it, only two cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:MMNotIntro})}]
                \begin{pfsteps*}
                \item $\notIntro{\hinr{\tau_1}{e_2}}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \autoref{lem:no-inr-notintro}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMInr})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_2}{p_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[inr3]not-maymatch}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hmaymatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}}$ \BY{contradiction}
            \end{pfsteps*}
        \end{byCases}
    \end{byCases}
\restorelocalsteps{0}
\item[\text{(\ref{rule:PTPair})}]
    \begin{pfsteps*}
    \item $p=\hpair{p_1}{p_2}$ \BY{assumption}
    \item $\tau=\tprod{\tau_1}{\tau_2}$ \BY{assumption}
    \item $\xi=\cpair{\xi_1}{\xi_2}$ \BY{assumption}
    \item $\Gamma=\Gamma_1 \uplus \Gamma_2$ \BY{assumption}
    \item $\Delta=\Delta_1 \uplus \Delta_2$ \BY{assumption}
    \item $\chpattyp{p_1}{\tau_1}{\xi_1}{\Gamma_1}{\Delta_1}$ \BY{assumption} \pflabel{[pair]p1-typ}
    \item $\chpattyp{p_2}{\tau_2}{\xi_2}{\Gamma_2}{\Delta_2}$ \BY{assumption} \pflabel{[pair]p2-typ}
    \end{pfsteps*}
    By rule induction over Rules (\ref{rules:TExp}) on \pfref{e-typ}, the following cases apply.
    \begin{byCases}
    \savelocalsteps{1}
    \item[\text{(\ref{rule:TEHole}),(\ref{rule:THole}),(\ref{rule:TAp}),(\ref{rule:TPrl}),(\ref{rule:TPrr}),(\ref{rule:TMatchZPre}),(\ref{rule:TMatchNZPre})}]
        \begin{pfsteps*}
        \item $e=\hehole{u},\hhole{e_0}{u},\hap{e_1}{e_2},\hprl{e_0},\hprr{e_0},\hmatch{e_0}{\zrules}$ \BY{assumption}
        \item $\notIntro{e}$ \BY{Rule (\ref{rule:NVEHole}),(\ref{rule:NVHole}),(\ref{rule:NVAp}),(\ref{rule:NVMatch}),(\ref{rule:NVPrl}),(\ref{rule:NVPrr})} \pflabel{[epair]notintro}
        \item $\isIndet{e}$ \BY{\autoref{lem:final-notintro-indet} on \pfref{e-final} and \pfref{[epair]notintro}} \pflabel{[epair]indet}
        \item $\isIndet{\hprl{e}}$ \BY{Rule (\ref{rule:IPrl}) on \pfref{[epair]indet}} \pflabel{[epair]prl-indet}
        \item $\isFinal{\hprl{e}}$ \BY{Rule (\ref{rule:FIndet}) on \pfref{[epair]prl-indet}} \pflabel{[epair]prl-final}
        \item $\isIndet{\hprr{e}}$ \BY{Rule (\ref{rule:IPrr}) on \pfref{[epair]indet}} \pflabel{[epair]prr-indet}
        \item $\isFinal{\hprr{e}}$ \BY{Rule (\ref{rule:FIndet}) on \pfref{[epair]prr-indet}} \pflabel{[epair]prr-final}
        \item $\hexptyp{\cdot}{\Delta}{\hprl{e}}{\tau_1}$ \BY{Rule (\ref{rule:TPrl}) on \pfref{e-typ}} \pflabel{[epair]prl-typ}
        \item $\hexptyp{\cdot}{\Delta}{\hprr{e}}{\tau_2}$ \BY{Rule (\ref{rule:TPrr}) on \pfref{e-typ}} \pflabel{[epair]prr-typ}
        \end{pfsteps*}
        Assume $\hnotmatch{e}{\hpair{p_1}{p_2}}$. By rule induction on it, no case applies due to syntactic contradiction.
        \begin{pfsteps*}
        \item $\cancel{\hnotmatch{e}{\hpair{p_1}{p_2}}}$ \BY{contradiction}
        \end{pfsteps*}
        By inductive hypothesis on \pfref{[epair]prl-final} and \pfref{[epair]prl-typ} and \pfref{[pair]p1-typ}, exactly one of $\hpatmatch{\hprl{e}}{p_1}{\theta_1}$, $\hmaymatch{\hprl{e}}{p_1}$, and $\hnotmatch{\hprl{e}}{p_1}$ holds. \\
        By inductive hypothesis on \pfref{[epair]prr-final} and \pfref{[epair]prr-typ} and \pfref{[pair]p2-typ}, exactly one of $\hpatmatch{\hprr{e}}{p_2}{\theta_2}$, $\hmaymatch{\hprr{e}}{p_2}$, and $\hnotmatch{\hprr{e}}{p_2}$ holds. \\
        By case analysis on which conclusion holds for $p_1$ and $p_2$. Note that we have already shown $\cancel{\hnotmatch{e}{\hpair{p_1}{p_2}}}$.
        \begin{byCases}
        \savelocalsteps{2}
        \item[\hpatmatch{\hprl{e}}{p_1}{\theta_1},\hpatmatch{\hprr{e}}{p_2}{\theta_2}]
            \begin{pfsteps*}
            \item $\hpatmatch{\hprl{e}}{p_1}{\theta_1}$ \BY{assumption} \pflabel{[epair1]match1}
            \item $\cancel{\hmaymatch{\hprl{e}}{p_1}}$ \BY{assumption} \pflabel{[epair1]not-maymatch1}
            \item $\cancel{\hnotmatch{\hprl{e}}{p_1}}$ \BY{assumption} \pflabel{[epair1]not-notmatch1}
            \item $\hpatmatch{\hprr{e}}{p_2}{\theta_2}$ \BY{assumption} \pflabel{[epair1]match2}
            \item $\cancel{\hmaymatch{\hprr{e}}{p_2}}$ \BY{assumption} \pflabel{[epair1]not-maymatch2}
            \item $\cancel{\hnotmatch{\hprr{e}}{p_2}}$ \BY{assumption} \pflabel{[epair1]not-notmatch2}
            \item $\hpatmatch{e}{\hpair{p_1}{p_2}}{\theta_1 \uplus \theta_2}$ \BY{\ruleref{rule:MNotIntroPair} on \pfref{[epair]notintro} and \pfref{[epair1]match1} and \pfref{[epair1]match2}}
            \end{pfsteps*}
            Assume $\hmaymatch{e}{\hpair{p_1}{p_2}}$. By rule induction over \rulesref{rules:maymatch} on it, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:MMNotIntro})}]
                \begin{pfsteps*}
                \item $\refutable{\hpair{p_1}{p_2}}$ \BY{assumption} \pflabel{[epair1]rft-pair}
                \end{pfsteps*}
                By rule induction over \rulesref{rules:p-refutable}, only two cases apply.
                \begin{byCases}
                \savelocalsteps{3}
                \item[\text{(\ref{rule:RPairL})}]
                    \begin{pfsteps*}
                    \item $\refutable{p_1}$ \BY{assumption} \pflabel{[epair1]rft-p1}
                    \item $\notIntro{\hprl{e}}$ \BY{\ruleref{rule:NVPrl}} \pflabel{[epair1]notintro-prl}
                    \item $\hmaymatch{\hprl{e}}{p_1}$ \BY{\ruleref{rule:MMNotIntro} on \pfref{[epair1]rft-p1} and \pfref{[epair1]notintro-prl}}
                    \end{pfsteps*}
                    Contradicts \pfref{[epair1]not-maymatch1}.
                \restorelocalsteps{3}
                \item[\text{(\ref{rule:RPairR})}]
                    \begin{pfsteps*}
                    \item $\refutable{p_2}$ \BY{assumption} \pflabel{[epair1]rft-p2}
                    \item $\notIntro{\hprr{e}}$ \BY{\ruleref{rule:NVPrr}} \pflabel{[epair1]notintro-prr}
                    \item $\hmaymatch{\hprl{e}}{p_1}$ \BY{\ruleref{rule:MMNotIntro} on \pfref{[epair1]rft-p2} and \pfref{[epair1]notintro-prr}}
                    \end{pfsteps*}
                    Contradicts \pfref{[epair1]not-maymatch1}.
                \end{byCases}
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hmaymatch{e}{\hpair{p_1}{p_2}}}$ \BY{contradiction}
            \end{pfsteps*}
        \restorelocalsteps{2}
        \item[\hpatmatch{\hprl{e}}{p_1}{\theta_1},\hmaymatch{\hprr{e}}{p_2}]
            \begin{pfsteps*}
            \item $\hpatmatch{\hprl{e}}{p_1}{\theta_1}$ \BY{assumption} \pflabel{[epair2]match1}
            \item $\cancel{\hmaymatch{\hprl{e}}{p_1}}$ \BY{assumption} \pflabel{[epair2]not-maymatch1}
            \item $\cancel{\hnotmatch{\hprl{e}}{p_1}}$ \BY{assumption} \pflabel{[epair2]not-notmatch1}
            \item $\cancel{\hpatmatch{\hprr{e}}{p_2}{\theta_2}}$ \BY{assumption} \pflabel{[epair2]not-match2}
            \item $\hmaymatch{\hprr{e}}{p_2}$ \BY{assumption} \pflabel{[epair2]maymatch2}
            \item $\cancel{\hnotmatch{\hprr{e}}{p_2}}$ \BY{assumption} \pflabel{[epair2]not-notmatch2}
            \end{pfsteps*}
            Assume $\hpatmatch{e}{\hpair{p_1}{p_2}}{\theta}$. By rule induction over \rulesref{rules:match}, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:MNotIntroPair})}]
                \begin{pfsteps*}
                \item $\theta=\theta_1\uplus\theta_2$ \BY{assumption}
                \item $\hpatmatch{\hprr{e}}{p_2}{\theta_2}$ \BY{assumption} \pflabel{[epair2]match2}
                \end{pfsteps*}
                Contradicts \pfref{[epair2]not-match2}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{e}{\hpair{p_1}{p_2}}{\theta}}$ \BY{contradiction}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:maymatch} on \pfref{[epair2]maymatch2}, the following cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:MMEHole}),(\ref{rule:MMHole})}]
                \begin{pfsteps*}
                \item $p_2=\hehole{w},\hhole{p}{w}$ \BY{assumption}
                \item $\refutable{p_2}$ \BY{\ruleref{rule:REHole} and \ruleref{rule:RHole}} \pflabel{[epair2]rft-p2}
                \item $\refutable{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:RPairR} on \pfref{[epair2]rft-p2}} \pflabel{[epair2]rft-pair}
                \item $\hmaymatch{e}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:MMNotIntro} on \pfref{[epair]notintro} and \pfref{[epair2]rft-pair}}
                \end{pfsteps*}
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMNotIntro})}]
                \begin{pfsteps*}
                \item $\refutable{p_2}$ \BY{assumption} \pflabel{[epair2]rft-p2'}
                \item $\refutable{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:RPairR} on \pfref{[epair2]rft-p2'}} \pflabel{[epair2]rft-pair'}
                \item $\hmaymatch{e}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:MMNotIntro} on \pfref{[epair]notintro} and \pfref{[epair2]rft-pair'}}
                \end{pfsteps*}
            \end{byCases}
        \restorelocalsteps{2}
        \item[\hpatmatch{\hprl{e}}{p_1}{\theta_1},\hnotmatch{\hprr{e}}{p_2}]
            \begin{pfsteps*}
            \item $\hpatmatch{\hprl{e}}{p_1}{\theta_1}$ \BY{assumption} \pflabel{[epair3]match1}
            \item $\cancel{\hmaymatch{\hprl{e}}{p_1}}$ \BY{assumption} \pflabel{[epair3]not-maymatch1}
            \item $\cancel{\hnotmatch{\hprl{e}}{p_1}}$ \BY{assumption} \pflabel{[epair3]not-notmatch1}
            \item $\cancel{\hpatmatch{\hprr{e}}{p_2}{\theta_2}}$ \BY{assumption} \pflabel{[epair3]not-match2}
            \item $\cancel{\hmaymatch{\hprr{e}}{p_2}}$ \BY{assumption} \pflabel{[epair3]not-maymatch2}
            \item $\hnotmatch{\hprr{e}}{p_2}$ \BY{assumption} \pflabel{[epair3]notmatch2}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:notmatch} on \pfref{[epair3]notmatch2}, no case applies due to syntactic contradiction.\\
            Therefore, vacuously true.
        \restorelocalsteps{2}
        \item[\hmaymatch{\hprl{e}}{p_1},\hpatmatch{\hprr{e}}{p_2}{\theta_2}]
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{\hprl{e}}{p_1}{\theta_1}}$ \BY{assumption} \pflabel{[epair4]not-match1}
            \item $\hmaymatch{\hprl{e}}{p_1}$ \BY{assumption} \pflabel{[epair4]maymatch1}
            \item $\cancel{\hnotmatch{\hprl{e}}{p_1}}$ \BY{assumption} \pflabel{[epair4]not-notmatch1}
            \item $\hpatmatch{\hprr{e}}{p_2}{\theta_2}$ \BY{assumption} \pflabel{[epair4]match2}
            \item $\cancel{\hmaymatch{\hprr{e}}{p_2}}$ \BY{assumption} \pflabel{[epair4]not-maymatch2}
            \item $\cancel{\hnotmatch{\hprr{e}}{p_2}}$ \BY{assumption} \pflabel{[epair4]not-notmatch2}
            \end{pfsteps*}
            Assume $\hpatmatch{e}{\hpair{p_1}{p_2}}{\theta}$. By rule induction over \rulesref{rules:match}, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:MNotIntroPair})}]
                \begin{pfsteps*}
                \item $\theta=\theta_1\uplus\theta_2$ \BY{assumption}
                \item $\hpatmatch{\hprl{e}}{p_1}{\theta_1}$ \BY{assumption} \pflabel{[epair4]match1}
                \end{pfsteps*}
                Contradicts \pfref{[epair4]not-match1}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{e}{\hpair{p_1}{p_2}}{\theta}}$ \BY{contradiction}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:maymatch} on \pfref{[epair4]maymatch1}, the following cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:MMEHole}),(\ref{rule:MMHole})}]
                \begin{pfsteps*}
                \item $p_1=\hehole{w},\hhole{p}{w}$ \BY{assumption}
                \item $\refutable{p_1}$ \BY{\ruleref{rule:REHole} and \ruleref{rule:RHole}} \pflabel{[epair4]rft-p1}
                \item $\refutable{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:RPairR} on \pfref{[epair4]rft-p1}} \pflabel{[epair4]rft-pair}
                \item $\hmaymatch{e}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:MMNotIntro} on \pfref{[epair]notintro} and \pfref{[epair4]rft-pair}}
                \end{pfsteps*}
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMNotIntro})}]
                \begin{pfsteps*}
                \item $\refutable{p_1}$ \BY{assumption} \pflabel{[epair4]rft-p1'}
                \item $\refutable{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:RPairR} on \pfref{[epair4]rft-p1'}} \pflabel{[epair4]rft-pair'}
                \item $\hmaymatch{e}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:MMNotIntro} on \pfref{[epair]notintro} and \pfref{[epair4]rft-pair'}}
                \end{pfsteps*}
            \end{byCases}
        \restorelocalsteps{2}
        \item[\hmaymatch{\hprl{e}}{p_1},\hmaymatch{\hprr{e}}{p_2}]
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{\hprl{e}}{p_1}{\theta_1}}$ \BY{assumption} \pflabel{[epair5]not-match1}
            \item $\hmaymatch{\hprl{e}}{p_1}$ \BY{assumption} \pflabel{[epair5]maymatch1}
            \item $\cancel{\hnotmatch{\hprl{e}}{p_1}}$ \BY{assumption} \pflabel{[epair5]not-notmatch1}
            \item $\cancel{\hpatmatch{\hprr{e}}{p_2}{\theta_2}}$ \BY{assumption} \pflabel{[epair5]not-match2}
            \item $\hmaymatch{\hprr{e}}{p_2}$ \BY{assumption} \pflabel{[epair5]maymatch2}
            \item $\cancel{\hnotmatch{\hprr{e}}{p_2}}$ \BY{assumption} \pflabel{[epair5]not-notmatch2}
            \end{pfsteps*}
            Assume $\hpatmatch{e}{\hpair{p_1}{p_2}}{\theta}$. By rule induction over \rulesref{rules:match}, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:MNotIntroPair})}]
                \begin{pfsteps*}
                \item $\theta=\theta_1\uplus\theta_2$ \BY{assumption}
                \item $\hpatmatch{\hprl{e}}{p_1}{\theta_1}$ \BY{assumption} \pflabel{[epair5]match1}
                \end{pfsteps*}
                Contradicts \pfref{[epair5]not-match1}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{e}{\hpair{p_1}{p_2}}{\theta}}$ \BY{contradiction}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:maymatch} on \pfref{[epair5]maymatch1}, the following cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:MMEHole}),(\ref{rule:MMHole})}]
                \begin{pfsteps*}
                \item $p_1=\hehole{w},\hhole{p}{w}$ \BY{assumption}
                \item $\refutable{p_1}$ \BY{\ruleref{rule:REHole} and \ruleref{rule:RHole}} \pflabel{[epair5]rft-p1}
                \item $\refutable{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:RPairR} on \pfref{[epair5]rft-p1}} \pflabel{[epair5]rft-pair}
                \item $\hmaymatch{e}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:MMNotIntro} on \pfref{[epair]notintro} and \pfref{[epair5]rft-pair}}
                \end{pfsteps*}
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMNotIntro})}]
                \begin{pfsteps*}
                \item $\refutable{p_1}$ \BY{assumption} \pflabel{[epair5]rft-p1'}
                \item $\refutable{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:RPairR} on \pfref{[epair5]rft-p1'}} \pflabel{[epair5]rft-pair'}
                \item $\hmaymatch{e}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:MMNotIntro} on \pfref{[epair]notintro} and \pfref{[epair5]rft-pair'}}
                \end{pfsteps*}
            \end{byCases}
        \restorelocalsteps{2}
        \item[\hmaymatch{\hprl{e}}{p_1},\hnotmatch{\hprr{e}}{p_2}]
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{\hprl{e}}{p_1}{\theta_1}}$ \BY{assumption} \pflabel{[epair6]not-match1}
            \item $\hmaymatch{\hprl{e}}{p_1}$ \BY{assumption} \pflabel{[epair6]maymatch1}
            \item $\cancel{\hnotmatch{\hprl{e}}{p_1}}$ \BY{assumption} \pflabel{[epair6]not-notmatch1}
            \item $\cancel{\hpatmatch{\hprr{e}}{p_2}{\theta_2}}$ \BY{assumption} \pflabel{[epair6]not-match2}
            \item $\cancel{\hmaymatch{\hprr{e}}{p_2}}$ \BY{assumption} \pflabel{[epair6]not-maymatch2}
            \item $\hnotmatch{\hprr{e}}{p_2}$ \BY{assumption} \pflabel{[epair6]notmatch2}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:notmatch} on \pfref{[epair6]notmatch2}, no case applies due to syntactic contradiction.\\
            Therefore, vacuously true.
        \restorelocalsteps{2}
        \item[\hnotmatch{\hprl{e}}{p_1},\hpatmatch{\hprr{e}}{p_2}{\theta_2}]
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{\hprl{e}}{p_1}{\theta_1}}$ \BY{assumption} \pflabel{[epair7]not-match1}
            \item $\cancel{\hmaymatch{\hprl{e}}{p_1}}$ \BY{assumption} \pflabel{[epair7]not-maymatch1}
            \item $\hnotmatch{\hprl{e}}{p_1}$ \BY{assumption} \pflabel{[epair7]notmatch1}
            \item $\hpatmatch{\hprr{e}}{p_2}{\theta_2}$ \BY{assumption} \pflabel{[epair7]match2}
            \item $\cancel{\hmaymatch{\hprr{e}}{p_2}}$ \BY{assumption} \pflabel{[epair7]not-maymatch2}
            \item $\cancel{\hnotmatch{\hprr{e}}{p_2}}$ \BY{assumption} \pflabel{[epair7]not-notmatch2}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:notmatch} on \pfref{[epair7]notmatch1}, no case applies due to syntactic contradiction.\\
            Therefore, vacuously true.
        \restorelocalsteps{2}
        \item[\hnotmatch{\hprl{e}}{p_1},\hmaymatch{\hprr{e}}{p_2}]
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{\hprl{e}}{p_1}{\theta_1}}$ \BY{assumption} \pflabel{[epair8]not-match1}
            \item $\cancel{\hmaymatch{\hprl{e}}{p_1}}$ \BY{assumption} \pflabel{[epair8]not-maymatch1}
            \item $\hnotmatch{\hprl{e}}{p_1}$ \BY{assumption} \pflabel{[epair8]notmatch1}
            \item $\cancel{\hpatmatch{\hprr{e}}{p_2}{\theta_2}}$ \BY{assumption} \pflabel{[epair8]not-match2}
            \item $\hmaymatch{\hprr{e}}{p_2}$ \BY{assumption} \pflabel{[epair8]maymatch2}
            \item $\cancel{\hnotmatch{\hprr{e}}{p_2}}$ \BY{assumption} \pflabel{[epair8]not-notmatch2}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:notmatch} on \pfref{[epair8]notmatch1}, no case applies due to syntactic contradiction.\\
            Therefore, vacuously true.
        \restorelocalsteps{2}
        \item[\hnotmatch{\hprl{e}}{p_1},\hnotmatch{\hprr{e}}{p_2}]
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{\hprl{e}}{p_1}{\theta_1}}$ \BY{assumption} \pflabel{[epair9]not-match1}
            \item $\cancel{\hmaymatch{\hprl{e}}{p_1}}$ \BY{assumption} \pflabel{[epair9]not-maymatch1}
            \item $\hnotmatch{\hprl{e}}{p_1}$ \BY{assumption} \pflabel{[epair9]notmatch1}
            \item $\cancel{\hpatmatch{\hprr{e}}{p_2}{\theta_2}}$ \BY{assumption} \pflabel{[epair9]not-match2}
            \item $\hmaymatch{\hprr{e}}{p_2}$ \BY{assumption} \pflabel{[epair9]maymatch2}
            \item $\cancel{\hnotmatch{\hprr{e}}{p_2}}$ \BY{assumption} \pflabel{[epair9]not-notmatch2}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:notmatch} on \pfref{[epair9]notmatch1}, no case applies due to syntactic contradiction.\\
            Therefore, vacuously true.
        \end{byCases}
    \restorelocalsteps{1}
    \item[\text{(\ref{rule:TPair})}]
        \begin{pfsteps*}
        \item $e=\hpair{e_1}{e_2}$ \BY{assumption}
        \item $\hexptyp{\cdot}{\Delta}{e_1}{\tau_1}$ \BY{assumption} \pflabel{[pair]e1-typ}
        \item $\hexptyp{\cdot}{\Delta}{e_2}{\tau_2}$ \BY{assumption} \pflabel{[pair]e2-typ}
        \item $\isFinal{e_1}$ \BY{\autoref{lem:pair-final} on \pfref{e-final}} \pflabel{[pair]e1-final}
        \item $\isFinal{e_2}$ \BY{\autoref{lem:pair-final} on \pfref{e-final}} \pflabel{[pair]e2-final}
        \end{pfsteps*}
        By inductive hypothesis on \pfref{[pair]p1-typ} and \pfref{[pair]e1-typ} and \pfref{[pair]e1-final}, exactly one of $\hpatmatch{e_1}{p_1}{\theta_1}$, $\hmaymatch{e_1}{p_1}$, and $\hnotmatch{e_1}{p_1}$ holds. \\
        By inductive hypothesis on \pfref{[pair]p2-typ} and \pfref{[pair]e2-typ} and \pfref{[pair]e2-final}, exactly one of $\hpatmatch{e_2}{p_2}{\theta_2}$, $\hmaymatch{e_2}{p_2}$, and $\hnotmatch{e_2}{p_2}$ holds. \\
        By case analysis on which conclusion holds for $p_1$ and $p_2$.
        \begin{byCases}
        \savelocalsteps{2}
        \item[\hpatmatch{e_1}{p_1}{\theta_1},\hpatmatch{e_2}{p_2}{\theta_2}]
            \begin{pfsteps*}
            \item $\hpatmatch{e_1}{p_1}{\theta_1}$ \BY{assumption} \pflabel{[pair1]match1}
            \item $\cancel{\hmaymatch{e_1}{p_1}}$ \BY{assumption} \pflabel{[pair1]not-maymatch1}
            \item $\cancel{\hnotmatch{e_1}{p_1}}$ \BY{assumption} \pflabel{[pair1]not-notmatch1}
            \item $\hpatmatch{e_2}{p_2}{\theta_2}$ \BY{assumption} \pflabel{[pair1]match2}
            \item $\cancel{\hmaymatch{e_2}{p_2}}$ \BY{assumption} \pflabel{[pair1]not-maymatch2}
            \item $\cancel{\hnotmatch{e_2}{p_2}}$ \BY{assumption} \pflabel{[pair1]not-notmatch2}
            \item $\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta_1 \uplus \theta_2}$ \BY{\ruleref{rule:MPair} on \pfref{[pair1]match1} and \pfref{[pair1]match2}}
            \end{pfsteps*}
            Assume $\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$. By rule induction over \rulesref{rules:maymatch} on it, only four cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:MMNotIntro})}]
                \begin{pfsteps*}
                \item $\notIntro{\hpair{e_1}{e_2}}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \autoref{lem:no-pair-notintro}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPairL})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_1}{p_1}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair1]not-maymatch1}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPairR})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_2}{p_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair1]not-maymatch2}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPair})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_1}{p_1}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair1]not-maymatch1}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}}$ \BY{contradiction}
            \end{pfsteps*}
            Assume $\hnotmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$. By rule induction over \rulesref{rules:notmatch} on it, only two cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:NMPairL})}]
                \begin{pfsteps*}
                \item $\hnotmatch{e_1}{p_1}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair1]not-notmatch1}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:NMPairR})}]
                \begin{pfsteps*}
                \item $\hnotmatch{e_2}{p_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair1]not-notmatch2}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hnotmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}}$ \BY{contradiction}
            \end{pfsteps*}
        \restorelocalsteps{2}
        \item[\hpatmatch{e_1}{p_1}{\theta_1},\hmaymatch{e_2}{p_2}]
            \begin{pfsteps*}
            \item $\hpatmatch{e_1}{p_1}{\theta_1}$ \BY{assumption} \pflabel{[pair2]match1}
            \item $\cancel{\hmaymatch{e_1}{p_1}}$ \BY{assumption} \pflabel{[pair2]not-maymatch1}
            \item $\cancel{\hnotmatch{e_1}{p_1}}$ \BY{assumption} \pflabel{[pair2]not-notmatch1}
            \item $\cancel{\hpatmatch{e_2}{p_2}{\theta_2}}$ \BY{assumption} \pflabel{[pair2]not-match2}
            \item $\hmaymatch{e_2}{p_2}$ \BY{assumption} \pflabel{[pair2]maymatch2}
            \item $\cancel{\hnotmatch{e_2}{p_2}}$ \BY{assumption} \pflabel{[pair2]not-notmatch2}
            \item $\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:MMPairR} on \pfref{[pair2]match1} and \pfref{[pair2]maymatch2}}
            \end{pfsteps*}
            Assume $\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta}$. By rule induction over \rulesref{rules:match} on it, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:MPair})}]
                \begin{pfsteps*}
                \item $\theta=\theta_1\uplus\theta_2$
                \item $\hpatmatch{e_2}{p_2}{\theta_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair2]not-match2}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta}}$ \BY{contradiction}
            \end{pfsteps*}
            Assume $\hnotmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$. By rule induction over \rulesref{rules:notmatch} on it, only two cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:NMPairL})}]
                \begin{pfsteps*}
                \item $\hnotmatch{e_1}{p_1}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair2]not-notmatch1}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:NMPairR})}]
                \begin{pfsteps*}
                \item $\hnotmatch{e_2}{p_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair2]not-notmatch2}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hnotmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}}$ \BY{contradiction}
            \end{pfsteps*}
        \restorelocalsteps{2}
        \item[\hpatmatch{e_1}{p_1}{\theta_1},\hnotmatch{e_2}{p_2}]
            \begin{pfsteps*}
            \item $\hpatmatch{e_1}{p_1}{\theta_1}$ \BY{assumption} \pflabel{[pair3]match1}
            \item $\cancel{\hmaymatch{e_1}{p_1}}$ \BY{assumption} \pflabel{[pair3]not-maymatch1}
            \item $\cancel{\hnotmatch{e_1}{p_1}}$ \BY{assumption} \pflabel{[pair3]not-notmatch1}
            \item $\cancel{\hpatmatch{e_2}{p_2}{\theta_2}}$ \BY{assumption} \pflabel{[pair3]not-match2}
            \item $\cancel{\hmaymatch{e_2}{p_2}}$ \BY{assumption} \pflabel{[pair3]not-maymatch2}
            \item $\hnotmatch{e_2}{p_2}$ \BY{assumption} \pflabel{[pair3]notmatch2}
            \item $\hnotmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:NMPairR} on \pfref{[pair3]notmatch2}}
            \end{pfsteps*}
            Assume $\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta}$. By rule induction over \rulesref{rules:match} on it, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:MPair})}]
                \begin{pfsteps*}
                \item $\theta=\theta_1\uplus\theta_2$
                \item $\hpatmatch{e_2}{p_2}{\theta_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair3]not-match2}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta}}$ \BY{contradiction}
            \end{pfsteps*}
            Assume $\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$. By rule induction over \rulesref{rules:maymatch} on it, only four cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:MMNotIntro})}]
                \begin{pfsteps*}
                \item $\notIntro{\hpair{e_1}{e_2}}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \autoref{lem:no-pair-notintro}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPairL})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_1}{p_1}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair3]not-maymatch1}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPairR})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_2}{p_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair3]not-maymatch2}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPair})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_1}{p_1}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair3]not-maymatch1}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}}$ \BY{contradiction}
            \end{pfsteps*}
        \restorelocalsteps{2}
        \item[\hmaymatch{e_1}{p_1},\hpatmatch{e_2}{p_2}{\theta_2}]
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{e_1}{p_1}{\theta_1}}$ \BY{assumption} \pflabel{[pair4]not-match1}
            \item $\hmaymatch{e_1}{p_1}$ \BY{assumption} \pflabel{[pair4]maymatch1}
            \item $\cancel{\hnotmatch{e_1}{p_1}}$ \BY{assumption} \pflabel{[pair4]not-notmatch1}
            \item $\hpatmatch{e_2}{p_2}{\theta_2}$ \BY{assumption} \pflabel{[pair4]match2}
            \item $\cancel{\hmaymatch{e_2}{p_2}}$ \BY{assumption} \pflabel{[pair4]not-maymatch2}
            \item $\cancel{\hnotmatch{e_2}{p_2}}$ \BY{assumption} \pflabel{[pair4]not-notmatch2}
            \item $\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:MMPairL} on \pfref{[pair4]maymatch1} and \pfref{[pair4]match2}}
            \end{pfsteps*}
            Assume $\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta}$. By rule induction over \rulesref{rules:match} on it, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:MPair})}]
                \begin{pfsteps*}
                \item $\theta=\theta_1\uplus\theta_2$
                \item $\hpatmatch{e_1}{p_1}{\theta_1}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair4]not-match1}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta}}$ \BY{contradiction}
            \end{pfsteps*}
            Assume $\hnotmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$. By rule induction over \rulesref{rules:notmatch} on it, only two cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:NMPairL})}]
                \begin{pfsteps*}
                \item $\hnotmatch{e_1}{p_1}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair4]not-notmatch1}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:NMPairR})}]
                \begin{pfsteps*}
                \item $\hnotmatch{e_2}{p_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair4]not-notmatch2}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hnotmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}}$ \BY{contradiction}
            \end{pfsteps*}
        \restorelocalsteps{2}
        \item[\hmaymatch{e_1}{p_1},\hmaymatch{e_2}{p_2}]
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{e_1}{p_1}{\theta_1}}$ \BY{assumption} \pflabel{[pair5]not-match1}
            \item $\hmaymatch{e_1}{p_1}$ \BY{assumption} \pflabel{[pair5]maymatch1}
            \item $\cancel{\hnotmatch{e_1}{p_1}}$ \BY{assumption} \pflabel{[pair5]not-notmatch1}
            \item $\cancel{\hpatmatch{e_2}{p_2}{\theta_2}}$ \BY{assumption} \pflabel{[pair5]not-match2}
            \item $\hmaymatch{e_2}{p_2}$ \BY{assumption} \pflabel{[pair5]maymatch2}
            \item $\cancel{\hnotmatch{e_2}{p_2}}$ \BY{assumption} \pflabel{[pair5]not-notmatch2}
            \item $\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:MMPair} on \pfref{[pair5]maymatch1} and \pfref{[pair5]maymatch2}}
            \end{pfsteps*}
            Assume $\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta}$. By rule induction over \rulesref{rules:match} on it, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:MPair})}]
                \begin{pfsteps*}
                \item $\theta=\theta_1\uplus\theta_2$
                \item $\hpatmatch{e_2}{p_2}{\theta_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair5]not-match2}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta}}$ \BY{contradiction}
            \end{pfsteps*}
            Assume $\hnotmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$. By rule induction over \rulesref{rules:notmatch} on it, only two cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:NMPairL})}]
                \begin{pfsteps*}
                \item $\hnotmatch{e_1}{p_1}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair5]not-notmatch1}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:NMPairR})}]
                \begin{pfsteps*}
                \item $\hnotmatch{e_2}{p_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair5]not-notmatch2}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hnotmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}}$ \BY{contradiction}
            \end{pfsteps*}
        \restorelocalsteps{2}
        \item[\hmaymatch{e_1}{p_1},\hnotmatch{e_2}{p_2}]
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{e_1}{p_1}{\theta_1}}$ \BY{assumption} \pflabel{[pair6]not-match1}
            \item $\hmaymatch{e_1}{p_1}$ \BY{assumption} \pflabel{[pair6]maymatch1}
            \item $\cancel{\hnotmatch{e_1}{p_1}}$ \BY{assumption} \pflabel{[pair6]not-notmatch1}
            \item $\cancel{\hpatmatch{e_2}{p_2}{\theta_2}}$ \BY{assumption} \pflabel{[pair6]not-match2}
            \item $\cancel{\hmaymatch{e_2}{p_2}}$ \BY{assumption} \pflabel{[pair6]not-maymatch2}
            \item $\hnotmatch{e_2}{p_2}$ \BY{assumption} \pflabel{[pair6]notmatch2}
            \item $\hnotmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:NMPairR} on \pfref{[pair6]notmatch2}}
            \end{pfsteps*}
            Assume $\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta}$. By rule induction over \rulesref{rules:match} on it, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:MPair})}]
                \begin{pfsteps*}
                \item $\theta=\theta_1\uplus\theta_2$
                \item $\hpatmatch{e_2}{p_2}{\theta_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair6]not-match2}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta}}$ \BY{contradiction}
            \end{pfsteps*}
            Assume $\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$. By rule induction over \rulesref{rules:maymatch} on it, only four cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:MMNotIntro})}]
                \begin{pfsteps*}
                \item $\notIntro{\hpair{e_1}{e_2}}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \autoref{lem:no-pair-notintro}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPairL})}]
                \begin{pfsteps*}
                \item $\hpatmatch{e_2}{p_2}{\theta_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair6]not-match2}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPairR})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_2}{p_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair6]not-maymatch2}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPair})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_2}{p_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair6]not-maymatch2}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}}$ \BY{contradiction}
            \end{pfsteps*}
        \restorelocalsteps{2}
        \item[\hnotmatch{e_1}{p_1},\hpatmatch{e_2}{p_2}{\theta_2}]
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{e_1}{p_1}{\theta_1}}$ \BY{assumption} \pflabel{[pair7]not-match1}
            \item $\cancel{\hmaymatch{e_1}{p_1}}$ \BY{assumption} \pflabel{[pair7]not-maymatch1}
            \item $\hnotmatch{e_1}{p_1}$ \BY{assumption} \pflabel{[pair7]notmatch1}
            \item $\hpatmatch{e_2}{p_2}{\theta_2}$ \BY{assumption} \pflabel{[pair7]match2}
            \item $\cancel{\hmaymatch{e_2}{p_2}}$ \BY{assumption} \pflabel{[pair7]not-maymatch2}
            \item $\cancel{\hnotmatch{e_2}{p_2}}$ \BY{assumption} \pflabel{[pair7]not-notmatch2}
            \item $\hnotmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:NMPairL} on \pfref{[pair7]notmatch1}}
            \end{pfsteps*}
            Assume $\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta}$. By rule induction over \rulesref{rules:match} on it, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:MPair})}]
                \begin{pfsteps*}
                \item $\theta=\theta_1\uplus\theta_2$
                \item $\hpatmatch{e_1}{p_1}{\theta_1}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair7]not-match1}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta}}$ \BY{contradiction}
            \end{pfsteps*}
            Assume $\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$. By rule induction over \rulesref{rules:maymatch} on it, only four cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:MMNotIntro})}]
                \begin{pfsteps*}
                \item $\notIntro{\hpair{e_1}{e_2}}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \autoref{lem:no-pair-notintro}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPairL})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_1}{p_1}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair7]not-maymatch1}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPairR})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_2}{p_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair7]not-maymatch2}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPair})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_1}{p_1}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair7]not-maymatch1}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}}$ \BY{contradiction}
            \end{pfsteps*}
        \restorelocalsteps{2}
        \item[\hnotmatch{e_1}{p_1},\hmaymatch{e_2}{p_2}]
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{e_1}{p_1}{\theta_1}}$ \BY{assumption} \pflabel{[pair8]not-match1}
            \item $\cancel{\hmaymatch{e_1}{p_1}}$ \BY{assumption} \pflabel{[pair8]not-maymatch1}
            \item $\hnotmatch{e_1}{p_1}$ \BY{assumption} \pflabel{[pair8]notmatch1}
            \item $\cancel{\hpatmatch{e_2}{p_2}{\theta_2}}$ \BY{assumption} \pflabel{[pair8]not-match2}
            \item $\hmaymatch{e_2}{p_2}$ \BY{assumption} \pflabel{[pair8]maymatch2}
            \item $\cancel{\hnotmatch{e_2}{p_2}}$ \BY{assumption} \pflabel{[pair8]not-notmatch2}
            \item $\hnotmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:NMPairL} on \pfref{[pair8]notmatch1}}
            \end{pfsteps*}
            Assume $\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta}$. By rule induction over \rulesref{rules:match} on it, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:MPair})}]
                \begin{pfsteps*}
                \item $\theta=\theta_1\uplus\theta_2$
                \item $\hpatmatch{e_2}{p_2}{\theta_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair8]not-match2}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta}}$ \BY{contradiction}
            \end{pfsteps*}
            Assume $\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$. By rule induction over \rulesref{rules:maymatch} on it, only four cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:MMNotIntro})}]
                \begin{pfsteps*}
                \item $\notIntro{\hpair{e_1}{e_2}}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \autoref{lem:no-pair-notintro}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPairL})}]
                \begin{pfsteps*}
                \item $\hpatmatch{e_2}{p_2}{\theta_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair8]not-match2}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPairR})}]
                \begin{pfsteps*}
                \item $\hpatmatch{e_1}{p_1}{\theta_1}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair8]not-match1}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPair})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_1}{p_1}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair8]not-maymatch1}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}}$ \BY{contradiction}
            \end{pfsteps*}
        \restorelocalsteps{2}
        \item[\hnotmatch{e_1}{p_1},\hnotmatch{e_2}{p_2}]
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{e_1}{p_1}{\theta_1}}$ \BY{assumption} \pflabel{[pair9]not-match1}
            \item $\cancel{\hmaymatch{e_1}{p_1}}$ \BY{assumption} \pflabel{[pair9]not-maymatch1}
            \item $\hnotmatch{e_1}{p_1}$ \BY{assumption} \pflabel{[pair9]notmatch1}
            \item $\cancel{\hpatmatch{e_2}{p_2}{\theta_2}}$ \BY{assumption} \pflabel{[pair9]not-match2}
            \item $\hmaymatch{e_2}{p_2}$ \BY{assumption} \pflabel{[pair9]maymatch2}
            \item $\cancel{\hnotmatch{e_2}{p_2}}$ \BY{assumption} \pflabel{[pair9]not-notmatch2}
            \item $\hnotmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:NMPairL} on \pfref{[pair9]notmatch1}}
            \end{pfsteps*}
            Assume $\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta}$. By rule induction over \rulesref{rules:match} on it, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:MPair})}]
                \begin{pfsteps*}
                \item $\theta=\theta_1\uplus\theta_2$
                \item $\hpatmatch{e_2}{p_2}{\theta_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair9]not-match2}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta}}$ \BY{contradiction}
            \end{pfsteps*}
            Assume $\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$. By rule induction over \rulesref{rules:maymatch} on it, only four cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:MMNotIntro})}]
                \begin{pfsteps*}
                \item $\notIntro{\hpair{e_1}{e_2}}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \autoref{lem:no-pair-notintro}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPairL})}]
                \begin{pfsteps*}
                \item $\hpatmatch{e_2}{p_2}{\theta_2}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair9]not-match2}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPairR})}]
                \begin{pfsteps*}
                \item $\hpatmatch{e_1}{p_1}{\theta_1}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair9]not-match1}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPair})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_1}{p_1}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \pfref{[pair9]not-maymatch1}.
            \end{byCases}
            \begin{pfsteps*}
            \item $\cancel{\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}}$ \BY{contradiction}
            \end{pfsteps*}
        \end{byCases}
    \end{byCases}
    
\end{byCases}
\resetpfcounter
\end{proof}

\begin{lemma}[Matching Coherence of Constraint]
  \label{lem:const-matching-coherence}
  Suppose that $\hexptyp{\cdot}{\Delta_e}{e}{\tau}$ and $\isFinal{e}$ and $\chpattyp{p}{\tau}{\xi}{\Gamma}{\Delta}$. Then we have
  \begin{enumerate}
  \item $\csatisfy{e}{\xi}$ iff $\hpatmatch{e}{p}{\theta}$
  \item $\cmaysatisfy{e}{\xi}$ iff $\hmaymatch{e}{p}$
  \item $\cnotsatisfyormay{e}{\xi}$ iff $\hnotmatch{e}{p}$
  \end{enumerate}
\end{lemma}
\begin{proof}
\begin{pfsteps*}
\item $\hexptyp{\cdot}{\Delta_e}{e}{\tau}$ \BY{assumption} \pflabel{eTyp}
\item $\isFinal{e}$ \BY{assumption} \pflabel{eFinal}
\item $\chpattyp{p}{\tau}{\xi}{\Gamma}{\Delta}$ \BY{assumption} \pflabel{patTyp}
\end{pfsteps*}
Given \autoref{lem:pat-xi-type}, \autoref{thrm:exclusive-constraint-satisfaction}, and \autoref{lem:match-determinism}, it is sufficient to prove
\begin{enumerate}
  \item $\csatisfy{e}{\xi}$ iff $\hpatmatch{e}{p}{\theta}$
  \item $\cmaysatisfy{e}{\xi}$ iff $\hmaymatch{e}{p}$
\end{enumerate}
By rule induction over Rules (\ref{rules:PatTyp}) on \pfref{patTyp}.
\begin{byCases}
\savelocalsteps{0}
\item[\text{(\ref{rule:PTVar})}]
    \begin{pfsteps*}
    \item $p=x$ \BY{assumption}
    \item $\xi=\ctruth$ \BY{assumption}
    \end{pfsteps*}
    \begin{enumerate}
    \savelocalsteps{1}
    \item Prove $\csatisfy{e}{\ctruth}$ implies $\hpatmatch{e}{x}{\theta}$ for some $\theta$.
        \begin{pfsteps*}
        \item $\hpatmatch{e}{x}{e / x}$ \BY{Rule (\ref{rule:MVar})}
        \end{pfsteps*}
    \restorelocalsteps{1}
    \item Prove $\hpatmatch{e}{x}{\theta}$ implies $\csatisfy{e}{\ctruth}$.
        \begin{pfsteps*}
        \item $\csatisfy{e}{\ctruth}$ \BY{Rule (\ref{rule:CSTruth})}
        \end{pfsteps*}
    \restorelocalsteps{1}
    \item Prove $\cmaysatisfy{e}{\ctruth}$ implies $\hmaymatch{e}{x}$.
        \begin{pfsteps*}
        \item $\cnotmaysatisfy{e}{\ctruth}$ \BY{\autoref{lem:no-e-may-satisfy-truth}}
        \end{pfsteps*}
        Vacuously true.
    \restorelocalsteps{1}
    \item Prove $\hmaymatch{e}{x}$ implies $\cmaysatisfy{e}{\ctruth}$.
    
        By rule induction over Rules (\ref{rules:maymatch}), we notice that either, $\hmaymatch{e}{x}$ is in syntactic contradiction with all the cases, or the premise $\refutable{x}$ is not derivable. Hence, $\hmaymatch{e}{x}$ are not derivable. And thus vacuously true.
    \end{enumerate}
    
\restorelocalsteps{0}
\item[\text{(\ref{rule:PTWild})}]
    \begin{pfsteps*}
    \item $p=\_$ \BY{assumption}
    \item $\xi=\ctruth$ \BY{assumption}
    \end{pfsteps*}
    \begin{enumerate}
    \savelocalsteps{1}
    \item Prove $\csatisfy{e}{\ctruth}$ implies $\hpatmatch{e}{\_}{\theta}$ for some $\theta$.
        \begin{pfsteps*}
        \item $\hpatmatch{e}{\_}{\cdot}$ \BY{Rule (\ref{rule:MVar})}
        \end{pfsteps*}
    \restorelocalsteps{1}
    \item Prove $\hpatmatch{e}{\_}{\theta}$ implies $\csatisfy{e}{\ctruth}$.
        \begin{pfsteps*}
        \item $\csatisfy{e}{\ctruth}$ \BY{Rule (\ref{rule:CSTruth})}
        \end{pfsteps*}
    \restorelocalsteps{1}
    \item Prove $\cmaysatisfy{e}{\ctruth}$ implies $\hmaymatch{e}{\_}$.
        \begin{pfsteps*}
        \item $\cnotmaysatisfy{e}{\ctruth}$ \BY{\autoref{lem:no-e-may-satisfy-truth}}
        \end{pfsteps*}
        Vacuously true.
    \restorelocalsteps{1}
    \item Prove $\hmaymatch{e}{\_}$ implies $\cmaysatisfy{e}{\xi}$.
    
        By rule induction over Rules (\ref{rules:maymatch}), we notice that either, $\hmaymatch{e}{\_}$ is in syntactic contradiction with all the cases, or the premise $\refutable{\_}$ is not derivable. Hence, $\hmaymatch{e}{\_}$ are not derivable. And thus vacuously true.
    \end{enumerate}
    
\restorelocalsteps{0}
\item[\text{(\ref{rule:PTEHole})}]
    \begin{pfsteps*}
    \item $p=\hehole{w}$ \BY{assumption}
    \item $\xi=\cunknown$ \BY{assumption}
    \item $\cdual{\xi}=\cunknown$ \BY{Definition \ref{defn:dual}}
    \end{pfsteps*}
    \begin{enumerate}
    \savelocalsteps{1}
    \item Prove $\csatisfy{e}{\cunknown}$ implies $\hpatmatch{e}{\hehole{w}}{\theta}$ for some $\theta$.
        \begin{pfsteps*}
        \item $\cnotsatisfy{e}{\cunknown}$ \BY{Rule (\ref{rule:MVar})}
        \end{pfsteps*}
        Vacuously true.
    \restorelocalsteps{1}
    \item Prove $\hpatmatch{e}{\hehole{w}}{\theta}$ implies $\csatisfy{e}{\cunknown}$.\\
        By rule induction over Rules (\ref{rules:match}), we notice that $\hpatmatch{e}{\hehole{w}}{\theta}$ is in syntactic contradiction with all the cases, hence not derivable. And thus vacuously true.
    \restorelocalsteps{1}
    \item Prove $\cmaysatisfy{e}{\cunknown}$ implies $\hmaymatch{e}{\hehole{w}}$.
        \begin{pfsteps*}
        \item $\hmaymatch{e}{\hehole{w}}$ \BY{Rule (\ref{rule:MMEHole})}
        \end{pfsteps*}
    \restorelocalsteps{1}
    \item Prove $\hmaymatch{e}{\hehole{w}}$ implies $\cmaysatisfy{e}{\cunknown}$.
        \begin{pfsteps*}
        \item $\cmaysatisfy{e}{\cunknown}$ \BY{Rule (\ref{rule:CMSUnknown})}
        \end{pfsteps*}
    \end{enumerate}

\restorelocalsteps{0}
\item[\text{(\ref{rule:PTHole})}]
    \begin{pfsteps*}
    \item $p=\hhole{p_0}{w}$ \BY{assumption}
    \item $\xi=\cunknown$ \BY{assumption}
    \end{pfsteps*}
    \begin{enumerate}
    \savelocalsteps{1}
    \item Prove $\csatisfy{e}{\cunknown}$ implies $\hpatmatch{e}{\hhole{p_0}{w}}{\theta}$ for some $\theta$.
        \begin{pfsteps*}
        \item $\cnotsatisfy{e}{\cunknown}$ \BY{Rule (\ref{rule:MVar})}
        \end{pfsteps*}
        Vacuously true.
    \restorelocalsteps{1}
    \item Prove $\hpatmatch{e}{\hhole{p_0}{w}}{\theta}$ implies $\csatisfy{e}{\cunknown}$.\\
        By rule induction over Rules (\ref{rules:match}), we notice that $\hpatmatch{e}{\hhole{p_0}{w}}{\theta}$ is in syntactic contradiction with all the cases, hence not derivable. And thus vacuously true.
    \restorelocalsteps{1}
    \item Prove $\cmaysatisfy{e}{\cunknown}$ implies $\hmaymatch{e}{\hhole{p_0}{w}}$.
        \begin{pfsteps*}
        \item $\hmaymatch{e}{\hhole{p_0}{w}}$ \BY{Rule (\ref{rule:MMHole})}
        \end{pfsteps*}
    \restorelocalsteps{1}
    \item Prove $\hmaymatch{e}{\hhole{p_0}{w}}$ implies $\cmaysatisfy{e}{\cunknown}$.
        \begin{pfsteps*}
        \item $\cmaysatisfy{e}{\cunknown}$ \BY{Rule (\ref{rule:CMSUnknown})}
        \end{pfsteps*}
    \end{enumerate}
    
\restorelocalsteps{0}
\item[\text{(\ref{rule:PTNum})}]
    \begin{pfsteps*}
    \item $p=\hnum{n}$ \BY{assumption}
    \item $\xi=\cnum{n}$ \BY{assumption}
    \end{pfsteps*}
    \begin{enumerate}
    \savelocalsteps{1}
    \item Prove $\csatisfy{e}{\cnum{n}}$ implies $\hpatmatch{e}{\hnum{n}}{\theta}$ for some $\theta$.
        \begin{pfsteps*}
        \item $\csatisfy{e}{\cnum{n}}$ \BY{assumption} \pflabel{[num]satisfy}
        \end{pfsteps*}
        By rule induction over \rulesref{rules:Satisfy} on \pfref{[num]satisfy}, only one case applies.
        \begin{byCases}
        \item[\text{(\ref{rule:CSNum})}]
            \begin{pfsteps*}
            \item $e=\hnum{n}$ \BY{assumption}
            \item $\hpatmatch{\hnum{n}}{\hnum{n}}{\cdot}$ \BY{\ruleref{rule:MNum}}
            \end{pfsteps*}
        \end{byCases}
    \restorelocalsteps{1}
    \item Prove $\hpatmatch{e}{\hnum{n}}{\theta}$ implies $\csatisfy{e}{\cnum{n}}$.
        \begin{pfsteps*}
        \item $\hpatmatch{e}{\hnum{n}}{\theta}$ \BY{assumption} \pflabel{[num]match}
        \end{pfsteps*}
        By rule induction over Rules (\ref{rules:match}) on \pfref{[num]match}, only one case applies.
        \begin{byCases}
        \item[\text{(\ref{rule:MNum})}]
            \begin{pfsteps*}
            \item $e=\hnum{n}$ \BY{assumption}
            \item $\theta=\cdot$ \BY{assumption}
            \item $\csatisfy{\hnum{n}}{\cnum{n}}$ \BY{\ruleref{rule:CSNum}}
            \end{pfsteps*}
        \end{byCases}
    \restorelocalsteps{1}
    \item Prove $\cmaysatisfy{e}{\cnum{n}}$ implies $\hmaymatch{e}{\hnum{n}}$.
        \begin{pfsteps*}
        \item $\cmaysatisfy{e}{\cnum{n}}$ \BY{assumption} \pflabel{[num]maysat}
        \end{pfsteps*}
        By rule induction over \rulesref{rules:MaySatisfy} on \pfref{[num]maysat}, only one case applies.
        \begin{byCases}
        \item[\text{(\ref{rule:CMSNotIntro})}]
            \begin{pfsteps*}
            \item $\notIntro{e}$ \BY{assumption} \pflabel{[num]notnum}
            \item $\refutable{\hnum{n}}$ \BY{\ruleref{rule:RNum}} \pflabel{[num]rft}
            \item $\hmaymatch{e}{\hnum{n}}$ \BY{\ruleref{rule:MMNotIntro} on \pfref{[num]notnum} and \pfref{[num]rft}}
            \end{pfsteps*}
        \end{byCases}
    \restorelocalsteps{1}
    \item Prove $\hmaymatch{e}{\hnum{n}}$ implies $\cmaysatisfy{e}{\cnum{n}}$.
        \begin{pfsteps*}
        \item $\hmaymatch{e}{\hnum{n}}$ \BY{assumption} \pflabel{[num]maymatch}
        \end{pfsteps*}
        By rule induction over \rulesref{rules:maymatch} on \pfref{[num]maymatch}, only one case applies.
        \begin{byCases}
        \item[\text{(\ref{rule:MMNotIntro})}]
            \begin{pfsteps*}
            \item $\notIntro{e}$ \BY{assumption} \pflabel{[num]notnum'}
            \item $\refutable{\cnum{n}}$ \BY{\ruleref{rule:RXNum}} \pflabel{[num]xi-rft}
            \item $\cmaysatisfy{e}{\cnum{n}}$ \BY{\ruleref{rules:MaySatisfy} on \pfref{[num]notnum'} and \pfref{[num]xi-rft}}
            \end{pfsteps*}
        \end{byCases}
    \end{enumerate}
\restorelocalsteps{0}
\item[\text{(\ref{rule:PTInl})}]
    \begin{pfsteps*}
    \item $p=\hinlp{p_1}$ \BY{assumption}
    \item $\xi=\cinl{\xi_1}$ \BY{assumption}
    \item $\tau=\tsum{\tau_1}{\tau_2}$ \BY{assumption}
    \item $\chpattyp{p_1}{\tau_1}{\xi_1}{\Gamma}{\Delta}$ \BY{assumption} \pflabel{[inl]p1-typ}
    \end{pfsteps*}
    By rule induction over Rules (\ref{rules:TExp}) on \pfref{eTyp}, the following cases apply.
    \begin{byCases}
    \savelocalsteps{1}
    \item[\text{(\ref{rule:TEHole}),(\ref{rule:THole}),(\ref{rule:TAp}),(\ref{rule:TPrl}),(\ref{rule:TPrr}),(\ref{rule:TMatchZPre}),(\ref{rule:TMatchNZPre})}]
        \begin{pfsteps*}
        \item $e=\hehole{u},\hhole{e_0}{u},\hap{e_1}{e_2},\hprl{e_0},\hprr{e_0},\hmatch{e_0}{\zrules}$ \BY{assumption}
        \item $\notIntro{e}$ \BY{Rule (\ref{rule:NVEHole}),(\ref{rule:NVHole}),(\ref{rule:NVAp}),(\ref{rule:NVMatch}),(\ref{rule:NVPrl}),(\ref{rule:NVPrr})} \pflabel{[inl]notintro}
        \end{pfsteps*}
        \begin{enumerate}
        \savelocalsteps{2}
        \item Prove $\csatisfy{e}{\cinl{\xi_1}}$ implies $\hpatmatch{e}{\hinlp{p_1}}{\theta}$ for some $\theta$.
        By rule induction over \rulesref{rules:Satisfy} on $\csatisfy{e}{\cinl{\xi_1}}$, no case applies due to syntactic contradiction. \\ Therefore, vacuously true.
        \restorelocalsteps{2}
        \item Prove $\hpatmatch{e}{\hinlp{p_1}}{\theta}$ implies $\csatisfy{e}{\cinl{\xi_1}}$.
        By rule induction over \rulesref{rules:match} on $\hpatmatch{e}{\hinlp{p_1}}{\theta}$, no case applies due to syntactic contradiction. \\ Therefore, vacuously true.
        \restorelocalsteps{2}
        \item Prove $\cmaysatisfy{e}{\cinl{\xi_1}}$ implies $\hmaymatch{e}{\hinlp{p_1}}$.
            \begin{pfsteps*}
            \item $\refutable{\hinlp{p_1}}$ \BY{\ruleref{rule:RInl}} \pflabel{[inl]rft}
            \item $\hmaymatch{e}{\hinlp{p_1}}$ \BY{\ruleref{rule:MMNotIntro} on \pfref{[inl]notintro} and \pfref{[inl]rft}}
            \end{pfsteps*}
        \restorelocalsteps{2}
        \item Prove $\hmaymatch{e}{\hinlp{p_1}}$ implies $\cmaysatisfy{e}{\cinl{\xi_1}}$.
            \begin{pfsteps*}
            \item $\refutable{\hinlp{\xi_1}}$ \BY{\ruleref{rule:RXInl}} \pflabel{[inl]xi-rft}
            \item $\cmaysatisfy{e}{\cinl{\xi_1}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[inl]notintro} and \pfref{[inl]xi-rft}}
            \end{pfsteps*}
        \end{enumerate}
    \restorelocalsteps{1}
    \item[\text{(\ref{rule:TInl})}]
        \begin{pfsteps*}
        \item $e=\hinl{\tau_2}{e_1}$ \BY{assumption}
        \item $\hexptyp{\cdot}{\Delta_e}{e_1}{\tau_1}$ \BY{assumption} \pflabel{[inl]e1-typ}
        \item $\isFinal{e_1}$ \BY{\autoref{lem:inl-final} on \pfref{eFinal}} \pflabel{[inl]e1-final}
        \end{pfsteps*}
        By inductive hypothesis on \pfref{[inl]e1-final} and \pfref{[inl]e1-typ} and \pfref{[inl]p1-typ}.
        \begin{pfsteps*}
        \item $\csatisfy{e_1}{\xi_1}$ iff $\hpatmatch{e_1}{p_1}{\theta}$ for some $\theta$ \pflabel{[inl]true-equiv}
        \item $\cmaysatisfy{e_1}{\xi_1}$ iff $\hmaymatch{e_1}{p_1}$ \pflabel{[inl]may-equiv}
        \end{pfsteps*}
        \begin{enumerate}
        \savelocalsteps{2}
        \item Prove $\csatisfy{\hinl{\tau_2}{e_1}}{\cinl{\xi_1}}$ implies $\hpatmatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}{\theta}$ for some $\theta$.
            \begin{pfsteps*}
            \item $\csatisfy{\hinl{\tau_2}{e_1}}{\cinl{\xi_1}}$ \BY{assumption} \pflabel{[inl1]satisfy}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:Satisfy} on \pfref{[inl1]satisfy}, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:CSInl})}]
                \begin{pfsteps*}
                \item $\csatisfy{e_1}{\xi_1}$ \BY{assumption} \pflabel{[inl1]satisfy1}
                \item $\hpatmatch{e_1}{p_1}{\theta_1}$ for some $\theta_1$ \BY{\pfref{[inl]true-equiv} on \pfref{[inl1]satisfy1}} \pflabel{[inl1]match1}
                \item $\hpatmatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}{\theta_1}$ \BY{\ruleref{rule:MInl} on \pfref{[inl1]match1}}
                \end{pfsteps*}
            \end{byCases}
        \restorelocalsteps{2}
        \item Prove $\hpatmatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}{\theta}$ implies $\csatisfy{\hinl{\tau_2}{e_1}}{\cinl{\xi_1}}$.
            \begin{pfsteps*}
            \item $\hpatmatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}{\theta}$ \BY{assumption} \pflabel{[inl2]match}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:match} on \pfref{[inl2]match}, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:MInl})}]
                \begin{pfsteps*}
                \item $\hpatmatch{e_1}{p_1}{\theta}$ \BY{assumption} \pflabel{[inl2]match1}
                \item $\csatisfy{e_1}{\xi_1}$ \BY{\pfref{[inl]true-equiv} on \pfref{[inl2]match1}} \pflabel{[inl2]satisfy1}
                \item $\csatisfy{\hinl{\tau_2}{e_1}}{\cinl{\xi_1}}$ \BY{\ruleref{rule:CSInl} on \pfref{[inl2]satisfy1}}
                \end{pfsteps*}
            \end{byCases}
        \restorelocalsteps{2}
        \item Prove $\cmaysatisfy{\hinl{\tau_2}{e_1}}{\cinl{\xi_1}}$ implies $\hmaymatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}$.
            \begin{pfsteps*}
            \item $\cmaysatisfy{\hinl{\tau_2}{e_1}}{\cinl{\xi_1}}$ \BY{assumption} \pflabel{[inl3]maysat}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:MaySatisfy} on \pfref{[inl3]maysat}, only two cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:CMSNotIntro})}]
                \begin{pfsteps*}
                \item $\notIntro{\hinl{\tau_2}{e_1}}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \autoref{lem:no-inl-notintro}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:CMSInl})}]
                \begin{pfsteps*}
                \item $\cmaysatisfy{e_1}{\xi_1}$ \BY{assumption} \pflabel{[inl3]maysat1}
                \item $\hmaymatch{e_1}{p_1}$ \BY{\pfref{[inl]may-equiv} on \pfref{[inl3]maysat1}} \pflabel{[inl3]maymatch1}
                \item $\hmaymatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}$ \BY{\ruleref{rule:MMInl} on \pfref{[inl3]maymatch1}}
                \end{pfsteps*}
            \end{byCases}
        \restorelocalsteps{2}
        \item Prove $\hmaymatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}$ implies $\cmaysatisfy{\hinl{\tau_2}{e_1}}{\cinl{\xi_1}}$.
            \begin{pfsteps*}
            \item $\hmaymatch{\hinl{\tau_2}{e_1}}{\hinlp{p_1}}$ \BY{assumption} \pflabel{[inl4]maymatch}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:maymatch} on \pfref{[inl4]maymatch}, only two cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:MMNotIntro})}]
                \begin{pfsteps*}
                \item $\notIntro{\hinl{\tau_2}{e_1}}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \autoref{lem:no-inl-notintro}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMInl})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_1}{p_1}$ \BY{assumption} \pflabel{[inl4]maymatch1}
                \item $\cmaysatisfy{e_1}{\xi_1}$ \BY{\pfref{[inl]may-equiv} on \pfref{[inl4]maymatch1}} \pflabel{[inl4]maysat1}
                \item $\cmaysatisfy{\hinl{\tau_2}{e_1}}{\cinl{\xi_1}}$ \BY{\ruleref{rule:CMSInl} on \pfref{[inl4]maysat1}}
                \end{pfsteps*}
            \end{byCases}
        \end{enumerate}
    \end{byCases}
\restorelocalsteps{0}
\item[\text{(\ref{rule:PTInr})}]
    \begin{pfsteps*}
    \item $p=\hinrp{p_2}$ \BY{assumption}
    \item $\xi=\cinr{\xi_2}$ \BY{assumption}
    \item $\tau=\tsum{\tau_1}{\tau_2}$ \BY{assumption}
    \item $\chpattyp{p_2}{\tau_2}{\xi_2}{\Gamma}{\Delta}$ \BY{assumption} \pflabel{[inr]p1-typ}
    \end{pfsteps*}
    By rule induction over Rules (\ref{rules:TExp}) on \pfref{eTyp}, the following cases apply.
    \begin{byCases}
    \savelocalsteps{1}
    \item[\text{(\ref{rule:TEHole}),(\ref{rule:THole}),(\ref{rule:TAp}),(\ref{rule:TPrl}),(\ref{rule:TPrr}),(\ref{rule:TMatchZPre}),(\ref{rule:TMatchNZPre})}]
        \begin{pfsteps*}
        \item $e=\hehole{u},\hhole{e_0}{u},\hap{e_1}{e_2},\hprl{e_0},\hprr{e_0},\hmatch{e_0}{\zrules}$ \BY{assumption}
        \item $\notIntro{e}$ \BY{Rule (\ref{rule:NVEHole}),(\ref{rule:NVHole}),(\ref{rule:NVAp}),(\ref{rule:NVMatch}),(\ref{rule:NVPrl}),(\ref{rule:NVPrr})} \pflabel{[inr]notintro}
        \end{pfsteps*}
        \begin{enumerate}
        \savelocalsteps{2}
        \item Prove $\csatisfy{e}{\cinr{\xi_2}}$ implies $\hpatmatch{e}{\hinrp{p_2}}{\theta}$ for some $\theta$.
        By rule induction over \rulesref{rules:Satisfy} on $\csatisfy{e}{\cinr{\xi_2}}$, no case applies due to syntactic contradiction. \\ Therefore, vacuously true.
        \restorelocalsteps{2}
        \item Prove $\hpatmatch{e}{\hinrp{p_2}}{\theta}$ implies $\csatisfy{e}{\cinr{\xi_2}}$.
        By rule induction over \rulesref{rules:match} on $\hpatmatch{e}{\hinrp{p_2}}{\theta}$, no case applies due to syntactic contradiction. \\ Therefore, vacuously true.
        \restorelocalsteps{2}
        \item Prove $\cmaysatisfy{e}{\cinr{\xi_2}}$ implies $\hmaymatch{e}{\hinrp{p_2}}$.
            \begin{pfsteps*}
            \item $\refutable{\hinrp{p_2}}$ \BY{\ruleref{rule:RInr}} \pflabel{[inr]rft}
            \item $\hmaymatch{e}{\hinrp{p_2}}$ \BY{\ruleref{rule:MMNotIntro} on \pfref{[inr]notintro} and \pfref{[inr]rft}}
            \end{pfsteps*}
        \restorelocalsteps{2}
        \item Prove $\hmaymatch{e}{\hinrp{p_2}}$ implies $\cmaysatisfy{e}{\cinr{\xi_2}}$.
            \begin{pfsteps*}
            \item $\refutable{\hinrp{\xi_2}}$ \BY{\ruleref{rule:RXInr}} \pflabel{[inr]xi-rft}
            \item $\cmaysatisfy{e}{\cinr{\xi_2}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[inr]notintro} and \pfref{[inr]xi-rft}}
            \end{pfsteps*}
        \end{enumerate}
    \restorelocalsteps{1}
    \item[\text{(\ref{rule:TInr})}]
        \begin{pfsteps*}
        \item $e=\hinr{\tau_1}{e_2}$ \BY{assumption}
        \item $\hexptyp{\cdot}{\Delta_e}{e_2}{\tau_2}$ \BY{assumption} \pflabel{[inr]e1-typ}
        \item $\isFinal{e_2}$ \BY{\autoref{lem:inl-final} on \pfref{eFinal}} \pflabel{[inr]e1-final}
        \end{pfsteps*}
        By inductive hypothesis on \pfref{[inr]e1-final} and \pfref{[inr]e1-typ} and \pfref{[inr]p1-typ}.
        \begin{pfsteps*}
        \item $\csatisfy{e_2}{\xi_2}$ iff $\hpatmatch{e_2}{p_2}{\theta}$ for some $\theta$ \pflabel{[inr]true-equiv}
        \item $\cmaysatisfy{e_2}{\xi_2}$ iff $\hmaymatch{e_2}{p_2}$ \pflabel{[inr]may-equiv}
        \end{pfsteps*}
        \begin{enumerate}
        \savelocalsteps{2}
        \item Prove $\csatisfy{\hinr{\tau_1}{e_2}}{\cinr{\xi_2}}$ implies $\hpatmatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}{\theta}$ for some $\theta$.
            \begin{pfsteps*}
            \item $\csatisfy{\hinr{\tau_1}{e_2}}{\cinr{\xi_2}}$ \BY{assumption} \pflabel{[inr1]satisfy}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:Satisfy} on \pfref{[inr1]satisfy}, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:CSInl})}]
                \begin{pfsteps*}
                \item $\csatisfy{e_2}{\xi_2}$ \BY{assumption} \pflabel{[inr1]satisfy1}
                \item $\hpatmatch{e_2}{p_2}{\theta_1}$ for some $\theta_1$ \BY{\pfref{[inr]true-equiv} on \pfref{[inr1]satisfy1}} \pflabel{[inr1]match1}
                \item $\hpatmatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}{\theta_1}$ \BY{\ruleref{rule:MInl} on \pfref{[inr1]match1}}
                \end{pfsteps*}
            \end{byCases}
        \restorelocalsteps{2}
        \item Prove $\hpatmatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}{\theta}$ implies $\csatisfy{\hinr{\tau_1}{e_2}}{\cinr{\xi_2}}$.
            \begin{pfsteps*}
            \item $\hpatmatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}{\theta}$ \BY{assumption} \pflabel{[inr2]match}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:match} on \pfref{[inr2]match}, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:MInl})}]
                \begin{pfsteps*}
                \item $\hpatmatch{e_2}{p_2}{\theta}$ \BY{assumption} \pflabel{[inr2]match1}
                \item $\csatisfy{e_2}{\xi_2}$ \BY{\pfref{[inr]true-equiv} on \pfref{[inr2]match1}} \pflabel{[inr2]satisfy1}
                \item $\csatisfy{\hinr{\tau_1}{e_2}}{\cinr{\xi_2}}$ \BY{\ruleref{rule:CSInl} on \pfref{[inr2]satisfy1}}
                \end{pfsteps*}
            \end{byCases}
        \restorelocalsteps{2}
        \item Prove $\cmaysatisfy{\hinr{\tau_1}{e_2}}{\cinr{\xi_2}}$ implies $\hmaymatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}$.
            \begin{pfsteps*}
            \item $\cmaysatisfy{\hinr{\tau_1}{e_2}}{\cinr{\xi_2}}$ \BY{assumption} \pflabel{[inr3]maysat}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:MaySatisfy} on \pfref{[inr3]maysat}, only two cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:CMSNotIntro})}]
                \begin{pfsteps*}
                \item $\notIntro{\hinr{\tau_1}{e_2}}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \autoref{lem:no-inl-notintro}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:CMSInl})}]
                \begin{pfsteps*}
                \item $\cmaysatisfy{e_2}{\xi_2}$ \BY{assumption} \pflabel{[inr3]maysat1}
                \item $\hmaymatch{e_2}{p_2}$ \BY{\pfref{[inr]may-equiv} on \pfref{[inr3]maysat1}} \pflabel{[inr3]maymatch1}
                \item $\hmaymatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}$ \BY{\ruleref{rule:MMInl} on \pfref{[inr3]maymatch1}}
                \end{pfsteps*}
            \end{byCases}
        \restorelocalsteps{2}
        \item Prove $\hmaymatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}$ implies $\cmaysatisfy{\hinr{\tau_1}{e_2}}{\cinr{\xi_2}}$.
            \begin{pfsteps*}
            \item $\hmaymatch{\hinr{\tau_1}{e_2}}{\hinrp{p_2}}$ \BY{assumption} \pflabel{[inr4]maymatch}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:maymatch} on \pfref{[inr4]maymatch}, only two cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:MMNotIntro})}]
                \begin{pfsteps*}
                \item $\notIntro{\hinr{\tau_1}{e_2}}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \autoref{lem:no-inl-notintro}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMInl})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_2}{p_2}$ \BY{assumption} \pflabel{[inr4]maymatch1}
                \item $\cmaysatisfy{e_2}{\xi_2}$ \BY{\pfref{[inr]may-equiv} on \pfref{[inr4]maymatch1}} \pflabel{[inr4]maysat1}
                \item $\cmaysatisfy{\hinr{\tau_1}{e_2}}{\cinr{\xi_2}}$ \BY{\ruleref{rule:CMSInl} on \pfref{[inr4]maysat1}}
                \end{pfsteps*}
            \end{byCases}
        \end{enumerate}
    \end{byCases}
\restorelocalsteps{0}
\item[\text{(\ref{rule:PTPair})}]
    \begin{pfsteps*}
    \item $p=\hpair{p_1}{p_2}$ \BY{assumption}
    \item $\xi=\cpair{\xi_1}{\xi_2}$ \BY{assumption}
    \item $\tau=\tprod{\tau_1}{\tau_2}$ \BY{assumption}
    \item $\Gamma=\Gamma_1\uplus \Gamma_2$ \BY{assumption}
    \item $\Delta=\Delta_1\uplus \Delta_2$ \BY{assumption}
    \item $\chpattyp{p_1}{\tau_1}{\xi_1}{\Gamma_1}{\Delta_1}$ \BY{assumption} \pflabel{[pair]p1-typ}
    \item $\chpattyp{p_2}{\tau_2}{\xi_2}{\Gamma_2}{\Delta_2}$ \BY{assumption} \pflabel{[pair]p2-typ}
    \end{pfsteps*}
    By rule induction over Rules (\ref{rules:TExp}) on \pfref{eTyp}, the following cases apply.
    \begin{byCases}
    \savelocalsteps{1}
    \item[\text{(\ref{rule:TEHole}),(\ref{rule:THole}),(\ref{rule:TAp}),(\ref{rule:TPrl}),(\ref{rule:TPrr}),(\ref{rule:TMatchZPre}),(\ref{rule:TMatchNZPre})}]
        \begin{pfsteps*}
        \item $e=\hehole{u},\hhole{e_0}{u},\hap{e_1}{e_2},\hprl{e_0},\hprr{e_0},\hmatch{e_0}{\zrules}$ \BY{assumption}
        \item $\notIntro{e}$ \BY{Rule (\ref{rule:NVEHole}),(\ref{rule:NVHole}),(\ref{rule:NVAp}),(\ref{rule:NVMatch}),(\ref{rule:NVPrl}),(\ref{rule:NVPrr})} \pflabel{[epair]notintro}
        \item $\isIndet{e}$ \BY{\autoref{lem:final-notintro-indet} on \pfref{eFinal} and \pfref{[epair]notintro}} \pflabel{[epair]indet}
        \item $\isIndet{\hprl{e}}$ \BY{Rule (\ref{rule:IPrl}) on \pfref{[epair]indet}} \pflabel{[epair]prl-indet}
        \item $\isFinal{\hprl{e}}$ \BY{Rule (\ref{rule:FIndet}) on \pfref{[epair]prl-indet}} \pflabel{[epair]prl-final}
        \item $\isIndet{\hprr{e}}$ \BY{Rule (\ref{rule:IPrr}) on \pfref{[epair]indet}} \pflabel{[epair]prr-indet}
        \item $\isFinal{\hprr{e}}$ \BY{Rule (\ref{rule:FIndet}) on \pfref{[epair]prr-indet}} \pflabel{[epair]prr-final}
        \item $\hexptyp{\cdot}{\Delta}{\hprl{e}}{\tau_1}$ \BY{Rule (\ref{rule:TPrl}) on \pfref{eTyp}} \pflabel{[epair]prl-typ}
        \item $\hexptyp{\cdot}{\Delta}{\hprr{e}}{\tau_2}$ \BY{Rule (\ref{rule:TPrr}) on \pfref{eTyp}} \pflabel{[epair]prr-typ}
        \end{pfsteps*}
        By inductive hypothesis on \pfref{[pair]p1-typ} and \pfref{[epair]prl-typ} and \pfref{[epair]prl-final} and by inductive hypothesis on \pfref{[pair]p2-typ} and \pfref{[epair]prr-typ} and \pfref{[epair]prr-final}.
        \begin{pfsteps*}
        \item $\csatisfy{\hprl{e}}{\xi_1}$ iff $\hpatmatch{\hprl{e}}{p_1}{\theta_1}$ for some $\theta_1$ \pflabel{[epair]true-equiv1}
        \item $\cmaysatisfy{\hprl{e}}{\xi_1}$ iff $\hmaymatch{\hprl{e}}{p_1}$ \pflabel{[epair]may-equiv1}
        \item $\csatisfy{\hprr{e}}{\xi_2}$ iff $\hpatmatch{\hprr{e}}{p_2}{\theta_2}$ for some $\theta_2$ \pflabel{[epair]true-equiv2}
        \item $\cmaysatisfy{\hprr{e}}{\xi_2}$ iff $\hmaymatch{\hprr{e}}{p_2}$ \pflabel{[epair]may-equiv2}
        \end{pfsteps*}
        \begin{enumerate}
        \savelocalsteps{2}
        \item Prove $\csatisfy{e}{\cpair{\xi_1}{\xi_2}}$ implies $\hpatmatch{e}{\hpair{p_1}{p_2}}{\theta}$ for some $\theta$.
            \begin{pfsteps*}
            \item $\csatisfy{e}{\cpair{\xi_1}{\xi_2}}$ \BY{assumption} \pflabel{[epair1]satisfy}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:Satisfy} on \pfref{[epair1]satisfy}, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:CSNotIntroPair})}]
                \begin{pfsteps*}
                \item $\csatisfy{\hprl{e}}{\xi_1}$ \BY{assumption} \pflabel{[epair1]satisfy1}
                \item $\csatisfy{\hprr{e}}{\xi_2}$ \BY{assumption} \pflabel{[epair1]satisfy2}
                \item $\hpatmatch{\hprl{e}}{p_1}{\theta_1}$ \BY{\pfref{[epair]true-equiv1} on \pfref{[epair1]satisfy1}} \pflabel{[epair1]match1}
                \item $\hpatmatch{\hprr{e}}{p_2}{\theta_2}$ \BY{\pfref{[epair]true-equiv2} on \pfref{[epair1]satisfy2}} \pflabel{[epair1]match2}
                \item $\hpatmatch{e}{\hpair{p_1}{p_2}}{\theta_1\uplus\theta_2}$ \BY{\ruleref{rule:MNotIntroPair} on \pfref{[epair]notintro} and \pfref{[epair1]match1} and \pfref{[epair1]match2}}
                \end{pfsteps*}
            \end{byCases}
        \restorelocalsteps{2}
        \item Prove $\hpatmatch{e}{\hpair{p_1}{p_2}}{\theta}$ implies $\csatisfy{e}{\cpair{\xi_1}{\xi_2}}$.
            \begin{pfsteps*}
            \item $\hpatmatch{e}{\hpair{p_1}{p_2}}{\theta}$ \BY{assumption} \pflabel{[epair2]match}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:match} on \pfref{[epair2]match}, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:MNotIntroPair})}]
                \begin{pfsteps*}
                \item $\theta=\theta_1\uplus\theta_2$ \BY{assumption}
                \item $\hpatmatch{\hprl{e}}{\xi_1}{\theta_1}$ \BY{assumption} \pflabel{[epair2]match1}
                \item $\hpatmatch{\hprr{e}}{\xi_2}{\theta_2}$ \BY{assumption} \pflabel{[epair2]match2}
                \item $\csatisfy{\hprl{e}}{\xi_1}$ \BY{\pfref{[epair]true-equiv1} on \pfref{[epair2]match1}} \pflabel{[epair2]satisfy1}
                \item $\csatisfy{\hprr{e}}{\xi_2}$ \BY{\pfref{[epair]true-equiv2} on \pfref{[epair2]match2}} \pflabel{[epair2]satisfy2}
                \item $\csatisfy{e}{\cpair{\xi_1}{\xi_2}}$ \BY{\ruleref{rule:CSNotIntroPair} on \pfref{[epair]notintro} and \pfref{[epair2]satisfy1} and \pfref{[epair2]satisfy2}}
                \end{pfsteps*}
            \end{byCases}
        \restorelocalsteps{2}
        \item Prove $\cmaysatisfy{e}{\cpair{\xi_1}{\xi_2}}$ implies $\hmaymatch{e}{\hpair{p_1}{p_2}}$.
            \begin{pfsteps*}
            \item $\cmaysatisfy{e}{\cpair{\xi_1}{\xi_2}}$ \BY{assumption} \pflabel{[epair2]satisfy}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:MaySatisfy} on \pfref{[epair2]satisfy}, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:CMSNotIntro})}]
                \begin{pfsteps*}
                \item $\refutable{\cpair{\xi_1}{\xi_2}}$ \BY{assumption} \pflabel{[epair3]rft}
                \end{pfsteps*}
                By rule induction over \rulesref{rules:xi-refutable} on \pfref{[epair3]rft}, only two cases apply.
                \begin{byCases}
                \savelocalsteps{3}
                \item[\text{(\ref{rule:RXPairL})}]
                    \begin{pfsteps*}
                    \item $\refutable{\xi_1}$ \BY{assumption} \pflabel{[epair3]rft1}
                    \item $\notIntro{\hprl{e}}$ \BY{\ruleref{rule:NVPrl}} \pflabel{[epair3]notintro1}
                    \item $\cmaysatisfy{\hprl{e}}{\xi_1}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[epair3]rft1} and \pfref{[epair3]notintro1}} \pflabel{[epair3]satisfy1}
                    \item $\hmaymatch{\hprl{e}}{p_1}$ \BY{\pfref{[epair]may-equiv1} on \pfref{[epair3]satisfy1}} \pflabel{[epair3]match1}
                    \end{pfsteps*}
                    By rule induction over \rulesref{rules:maymatch} on \pfref{[epair3]match1}, only three cases apply.
                    \begin{byCases}
                    \savelocalsteps{4}
                    \item[\text{(\ref{rule:MMEHole}),(\ref{rule:MMHole})}]
                        \begin{pfsteps*}
                        \item $p_1=\hehole{w},\hhole{p_0}{w}$ \BY{assumption}
                        \item $\refutable{p_1}$ \BY{\ruleref{rule:REHole} and \ruleref{rule:RHole}} \pflabel{[epair3]p-rft1}
                        \item $\refutable{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:RPairL} on \pfref{[epair3]p-rft1}} \pflabel{[epair3]p-rft}
                        \item $\hmaymatch{e}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:MMNotIntro} on \pfref{[epair]notintro} and \pfref{[epair3]p-rft}}
                        \end{pfsteps*}
                    \restorelocalsteps{4}
                    \item[\text{(\ref{rule:MMNotIntro})}]
                        \begin{pfsteps*}
                        \item $\refutable{p_1}$ \BY{assumption} \pflabel{[epair3]p-rft1'}
                        \item $\refutable{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:RPairL} on \pfref{[epair3]p-rft1'}} \pflabel{[epair3]p-rft'}
                        \item $\hmaymatch{e}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:MMNotIntro} on \pfref{[epair]notintro} and \pfref{[epair3]p-rft'}}
                        \end{pfsteps*}
                    \end{byCases}
                \restorelocalsteps{3}
                \item[\text{(\ref{rule:RXPairR})}]
                    \begin{pfsteps*}
                    \item $\refutable{\xi_2}$ \BY{assumption} \pflabel{[epair3']rft1}
                    \item $\notIntro{\hprr{e}}$ \BY{\ruleref{rule:NVPrl}} \pflabel{[epair3']notintro1}
                    \item $\cmaysatisfy{\hprr{e}}{\xi_2}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[epair3']rft1} and \pfref{[epair3']notintro1}} \pflabel{[epair3']satisfy1}
                    \item $\hmaymatch{\hprr{e}}{p_2}$ \BY{\pfref{[epair]may-equiv2} on \pfref{[epair3']satisfy1}} \pflabel{[epair3']match1}
                    \end{pfsteps*}
                    By rule induction over \rulesref{rules:maymatch} on \pfref{[epair3']match1}, only three cases apply.
                    \begin{byCases}
                    \savelocalsteps{4}
                    \item[\text{(\ref{rule:MMEHole}),(\ref{rule:MMHole})}]
                        \begin{pfsteps*}
                        \item $p_2=\hehole{w},\hhole{p_0}{w}$ \BY{assumption}
                        \item $\refutable{p_2}$ \BY{\ruleref{rule:REHole} and \ruleref{rule:RHole}} \pflabel{[epair3']p-rft1}
                        \item $\refutable{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:RPairR} on \pfref{[epair3']p-rft1}} \pflabel{[epair3']p-rft}
                        \item $\hmaymatch{e}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:MMNotIntro} on \pfref{[epair]notintro} and \pfref{[epair3']p-rft}}
                        \end{pfsteps*}
                    \restorelocalsteps{4}
                    \item[\text{(\ref{rule:MMNotIntro})}]
                        \begin{pfsteps*}
                        \item $\refutable{p_2}$ \BY{assumption} \pflabel{[epair3']p-rft1'}
                        \item $\refutable{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:RPairR} on \pfref{[epair3']p-rft1'}} \pflabel{[epair3']p-rft'}
                        \item $\hmaymatch{e}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:MMNotIntro} on \pfref{[epair]notintro} and \pfref{[epair3']p-rft'}}
                        \end{pfsteps*}
                    \end{byCases}
                \end{byCases}
            \end{byCases}
        \restorelocalsteps{2}
        \item Prove $\hmaymatch{e}{\hpair{p_1}{p_2}}$ implies $\cmaysatisfy{e}{\cpair{\xi_1}{\xi_2}}$.
            \begin{pfsteps*}
            \item $\hmaymatch{e}{\hpair{p_1}{p_2}}$ \BY{assumption} \pflabel{[epair4]match}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:maymatch} on \pfref{[epair4]match}, only one case applies.
            \begin{byCases}
            \item[\text{(\ref{rule:MMNotIntro})}]
                \begin{pfsteps*}
                \item $\refutable{\hpair{p_1}{p_2}}$ \BY{assumption} \pflabel{[epair4]rft}
                \end{pfsteps*}
                By rule induction over \rulesref{rules:p-refutable} on \pfref{[epair4]rft}, only two cases apply.
                \begin{byCases}
                \savelocalsteps{3}
                \item[\text{(\ref{rule:RPairL})}]
                    \begin{pfsteps*}
                    \item $\refutable{p_1}$ \BY{assumption} \pflabel{[epair4]rft1}
                    \item $\notIntro{\hprl{e}}$ \BY{\ruleref{rule:NVPrl}} \pflabel{[epair4]notintro1}
                    \item $\hmaymatch{\hprl{e}}{p_1}$ \BY{\ruleref{rule:MMNotIntro} on \pfref{[epair4]rft1} and \pfref{[epair4]notintro1}} \pflabel{[epair4]match1}
                    \item $\cmaysatisfy{\hprl{e}}{\xi_1}$ \BY{\pfref{[epair]may-equiv1} on \pfref{[epair4]match1}} \pflabel{[epair4]satisfy1}
                    \end{pfsteps*}
                    By rule induction over \rulesref{rules:MaySatisfy} on \pfref{[epair4]satisfy1}, only three cases apply.
                    \begin{byCases}
                    \savelocalsteps{4}
                    \item[\text{(\ref{rule:CMSUnknown})}]
                        \begin{pfsteps*}
                        \item $\xi_1=\cunknown$ \BY{assumption}
                        \item $\refutable{\xi_1}$ \BY{\ruleref{rule:RXUnknown}} \pflabel{[epair4]p-rft1}
                        \item $\refutable{\cpair{\xi_1}{\xi_2}}$ \BY{\ruleref{rule:RXPairL} on \pfref{[epair4]p-rft1}} \pflabel{[epair4]p-rft}
                        \item $\cmaysatisfy{e}{\cpair{\xi_1}{\xi_2}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[epair]notintro} and \pfref{[epair4]p-rft}}
                        \end{pfsteps*}
                    \restorelocalsteps{4}
                    \item[\text{(\ref{rule:CMSNotIntro})}]
                        \begin{pfsteps*}
                        \item $\refutable{\xi_1}$ \BY{assumption} \pflabel{[epair4]p-rft1'}
                        \item $\refutable{\cpair{\xi_1}{\xi_2}}$ \BY{\ruleref{rule:RXPairL} on \pfref{[epair4]p-rft1'}} \pflabel{[epair4]p-rft'}
                        \item $\cmaysatisfy{e}{\cpair{\xi_1}{\xi_2}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[epair]notintro} and \pfref{[epair4]p-rft'}}
                        \end{pfsteps*}
                    \end{byCases}
                \restorelocalsteps{3}
                \item[\text{(\ref{rule:RPairR})}]
                    \begin{pfsteps*}
                    \item $\refutable{p_2}$ \BY{assumption} \pflabel{[epair4']rft1}
                    \item $\notIntro{\hprr{e}}$ \BY{\ruleref{rule:NVPrl}} \pflabel{[epair4']notintro1}
                    \item $\hmaymatch{\hprr{e}}{p_2}$ \BY{\ruleref{rule:MMNotIntro} on \pfref{[epair4']rft1} and \pfref{[epair4']notintro1}} \pflabel{[epair4']satisfy1}
                    \item $\cmaysatisfy{\hprr{e}}{\xi_2}$ \BY{\pfref{[epair]may-equiv2} on \pfref{[epair4']satisfy1}} \pflabel{[epair4']match1}
                    \end{pfsteps*}
                    By rule induction over \rulesref{rules:MaySatisfy} on \pfref{[epair4']match1}, only three cases apply.
                    \begin{byCases}
                    \savelocalsteps{4}
                    \item[\text{(\ref{rule:CMSUnknown})}]
                        \begin{pfsteps*}
                        \item $\xi_2=\cunknown$ \BY{assumption}
                        \item $\refutable{\xi_2}$ \BY{\ruleref{rule:RXUnknown}} \pflabel{[epair4']p-rft1}
                        \item $\refutable{\cpair{\xi_1}{\xi_2}}$ \BY{\ruleref{rule:RXPairR} on \pfref{[epair4']p-rft1}} \pflabel{[epair4']p-rft}
                        \item $\cmaysatisfy{e}{\cpair{\xi_1}{\xi_2}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[epair]notintro} and \pfref{[epair4']p-rft}}
                        \end{pfsteps*}
                    \restorelocalsteps{4}
                    \item[\text{(\ref{rule:CMSNotIntro})}]
                        \begin{pfsteps*}
                        \item $\refutable{\xi_2}$ \BY{assumption} \pflabel{[epair4']p-rft1'}
                        \item $\refutable{\cpair{\xi_1}{\xi_2}}$ \BY{\ruleref{rule:RXPairR} on \pfref{[epair4']p-rft1'}} \pflabel{[epair4']p-rft'}
                        \item $\cmaysatisfy{e}{\cpair{\xi_1}{\xi_2}}$ \BY{\ruleref{rule:CMSNotIntro} on \pfref{[epair]notintro} and \pfref{[epair4']p-rft'}}
                        \end{pfsteps*}
                    \end{byCases}
                \end{byCases}
            \end{byCases}
        \end{enumerate}
    \restorelocalsteps{1}
    \item[\text{(\ref{rule:TPair})}]
        \begin{pfsteps*}
        \item $e=\hpair{e_1}{e_2}$ \BY{assumption}
        \item $\hexptyp{\cdot}{\Delta_e}{e_1}{\tau_1}$ \BY{assumption} \pflabel{[pair]e1-typ}
        \item $\hexptyp{\cdot}{\Delta_e}{e_2}{\tau_2}$ \BY{assumption} \pflabel{[pair]e2-typ}
        \item $\isFinal{e_1}$ \BY{\autoref{lem:pair-final} on \pfref{eFinal}} \pflabel{[pair]e1-final}
        \item $\isFinal{e_2}$ \BY{\autoref{lem:pair-final} on \pfref{eFinal}} \pflabel{[pair]e2-final}
        \end{pfsteps*}
        By inductive hypothesis on \pfref{[pair]e1-final} and \pfref{[pair]e1-typ} and \pfref{[pair]p1-typ} and by inductive hypothesis on \pfref{[pair]e2-final} and \pfref{[pair]e2-typ} and \pfref{[pair]p2-typ}.
        \begin{pfsteps*}
        \item $\csatisfy{e_1}{\xi_1}$ iff $\hpatmatch{e_1}{p_1}{\theta_1}$ for some $\theta_1$ \pflabel{[pair]true-equiv1}
        \item $\cmaysatisfy{e_1}{\xi_1}$ iff $\hmaymatch{e_1}{p_1}$ \pflabel{[pair]may-equiv1}
        \item $\csatisfy{e_2}{\xi_2}$ iff $\hpatmatch{e_2}{p_2}{\theta_2}$ for some $\theta_2$ \pflabel{[pair]true-equiv2}
        \item $\cmaysatisfy{e_2}{\xi_2}$ iff $\hmaymatch{e_2}{p_2}$ \pflabel{[pair]may-equiv2}
        \end{pfsteps*}
        
        \begin{enumerate}
        \savelocalsteps{2}
        \item Prove $\csatisfy{\hpair{e_1}{e_2}}{\cpair{\xi_1}{\xi_2}}$ implies $\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta}$ for some $\theta$.
            \begin{pfsteps*}
            \item $\csatisfy{\hpair{e_1}{e_2}}{\cpair{\xi_1}{\xi_2}}$ \BY{assumption} \pflabel{[pair1]satisfy}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:Satisfy} on \pfref{[pair1]satisfy}, only two cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:CSPair})}]
                \begin{pfsteps*}
                \item $\csatisfy{e_1}{\xi_1}$ \BY{assumption} \pflabel{[pair1]satisfy1}
                \item $\csatisfy{e_2}{\xi_2}$ \BY{assumption} \pflabel{[pair1]satisfy2}
                \item $\hpatmatch{e_1}{p_1}{\theta_1}$ for some $\theta_1$ \BY{\pfref{[pair]true-equiv1} on \pfref{[pair1]satisfy1}} \pflabel{[pair1]match1}
                \item $\hpatmatch{e_2}{p_2}{\theta_2}$ for some $\theta_2$ \BY{\pfref{[pair]true-equiv2} on \pfref{[pair1]satisfy2}} \pflabel{[pair1]match2}
                \item $\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta_1\uplus\theta_2}$ \BY{\ruleref{rule:MPair} on \pfref{[pair1]match1} and \pfref{[pair1]match2}}
                \end{pfsteps*}
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:CSNotIntroPair})}]
                \begin{pfsteps*}
                \item $\notIntro{\hpair{e_1}{e_2}}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \autoref{lem:no-pair-notintro}.
            \end{byCases}
        \restorelocalsteps{2}
        \item Prove $\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta}$ implies $\csatisfy{\hpair{e_1}{e_2}}{\cpair{\xi_1}{\xi_2}}$.
            \begin{pfsteps*}
            \item $\hpatmatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}{\theta}$ \BY{assumption} \pflabel{[pair2]match}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:match} on \pfref{[pair2]match}, only two cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:MPair})}]
                \begin{pfsteps*}
                \item $\hpatmatch{e_1}{p_1}{\theta_1}$ for some $\theta_1$ \BY{assumption}  \pflabel{[pair2]match1}
                \item $\hpatmatch{e_2}{p_2}{\theta_2}$ for some $\theta_2$ \BY{assumption} \pflabel{[pair2]match2}
                \item $\csatisfy{e_1}{\xi_1}$ \BY{\pfref{[pair]true-equiv1} on \pfref{[pair2]match1}} \pflabel{[pair2]satisfy1}
                \item $\csatisfy{e_2}{\xi_2}$ \BY{\pfref{[pair]true-equiv2} on \pfref{[pair2]match2}} \pflabel{[pair2]satisfy2}
                \item $\csatisfy{\hpair{e_1}{e_2}}{\cpair{\xi_1}{\xi_2}}$ \BY{\ruleref{rule:CSPair} on \pfref{[pair2]satisfy1} and \pfref{[pair2]satisfy2}}
                \end{pfsteps*}
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MNotIntroPair})}]
                \begin{pfsteps*}
                \item $\notIntro{\hpair{e_1}{e_2}}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \autoref{lem:no-pair-notintro}.
            \end{byCases}
        \restorelocalsteps{2}
        \item Prove $\cmaysatisfy{\hpair{e_1}{e_2}}{\cpair{\xi_1}{\xi_2}}$ implies $\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$.
            \begin{pfsteps*}
            \item $\cmaysatisfy{\hpair{e_1}{e_2}}{\cpair{\xi_1}{\xi_2}}$ \BY{assumption} \pflabel{[pair3]maysat}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:MaySatisfy} on \pfref{[pair3]maysat}, only four cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:CMSNotIntro})}]
                \begin{pfsteps*}
                \item $\notIntro{\hpair{e_1}{e_2}}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \autoref{lem:no-pair-notintro}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:CMSPair1})}]
                \begin{pfsteps*}
                \item $\cmaysatisfy{e_1}{\xi_1}$ \BY{assumption} \pflabel{[pair3]maysat1}
                \item $\csatisfy{e_2}{\xi_2}$ \BY{assumption} \pflabel{[pair3]satisfy2}
                \item $\hmaymatch{e_1}{p_1}$ \BY{\pfref{[pair]may-equiv1} on \pfref{[pair3]maysat1}} \pflabel{[pair3]maymatch1}
                \item $\hpatmatch{e_2}{p_2}{\theta_2}$ \BY{\pfref{[pair]true-equiv2} on \pfref{[pair3]satisfy2}} \pflabel{[pair3]match2}
                \item $\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:MMPairL} on \pfref{[pair3]maymatch1} and \pfref{[pair3]match2}}
                \end{pfsteps*}
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:CMSPair2})}]
                \begin{pfsteps*}
                \item $\csatisfy{e_1}{\xi_1}$ \BY{assumption} \pflabel{[pair3]satisfy1}
                \item $\cmaysatisfy{e_2}{\xi_2}$ \BY{assumption} \pflabel{[pair3]maysat2}
                \item $\hpatmatch{e_1}{p_1}{\theta_1}$ \BY{\pfref{[pair]true-equiv1} on \pfref{[pair3]satisfy1}} \pflabel{[pair3]match1}
                \item $\hmaymatch{e_2}{p_2}$ \BY{\pfref{[pair]may-equiv2} on \pfref{[pair3]maysat2}} \pflabel{[pair3]maymatch2}
                \item $\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:MMPairR} on \pfref{[pair3]match1} and \pfref{[pair3]maymatch2}}
                \end{pfsteps*}
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:CMSPair3})}]
                \begin{pfsteps*}
                \item $\cmaysatisfy{e_1}{\xi_1}$ \BY{assumption} \pflabel{[pair3]maysat1'}
                \item $\cmaysatisfy{e_2}{\xi_2}$ \BY{assumption} \pflabel{[pair3]maysat2'}
                \item $\hmaymatch{e_1}{p_1}$ \BY{\pfref{[pair]may-equiv1} on \pfref{[pair3]maysat1'}} \pflabel{[pair3]maymatch1'}
                \item $\hmaymatch{e_2}{p_2}$ \BY{\pfref{[pair]may-equiv2} on \pfref{[pair3]maysat2'}} \pflabel{[pair3]maymatch2'}
                \item $\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:MMPair} on \pfref{[pair3]maymatch1'} and \pfref{[pair3]maymatch2'}}
                \end{pfsteps*}
            \end{byCases}
        \restorelocalsteps{2}
        \item Prove $\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$ implies $\cmaysatisfy{\hpair{e_1}{e_2}}{\cpair{\xi_1}{\xi_2}}$.
            \begin{pfsteps*}
            \item $\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$ \BY{assumption} \pflabel{[pair4]maymatch}
            \end{pfsteps*}
            By rule induction over \rulesref{rules:maymatch} on \pfref{[pair4]maymatch}, only four cases apply.
            \begin{byCases}
            \savelocalsteps{3}
            \item[\text{(\ref{rule:MMNotIntro})}]
                \begin{pfsteps*}
                \item $\notIntro{\hpair{e_1}{e_2}}$ \BY{assumption}
                \end{pfsteps*}
                Contradicts \autoref{lem:no-pair-notintro}.
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPairL})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_1}{p_1}$ \BY{assumption} \pflabel{[pair4]maymatch1}
                \item $\hpatmatch{e_2}{p_2}{\theta_2}$ \BY{assumption} \pflabel{[pair4]match2}
                \item $\cmaysatisfy{e_1}{\xi_1}$ \BY{\pfref{[pair]may-equiv1} on \pfref{[pair4]maymatch1}} \pflabel{[pair4]maysat1}
                \item $\csatisfy{e_2}{\xi_2}$ \BY{\pfref{[pair]true-equiv2} on \pfref{[pair4]match2}} \pflabel{[pair4]satisfy2}
                \item $\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:CMSPair1} on \pfref{[pair4]maysat1} and \pfref{[pair4]satisfy2}}
                \end{pfsteps*}
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPairR})}]
                \begin{pfsteps*}
                \item $\hpatmatch{e_1}{p_1}{\theta_1}$ \BY{assumption} \pflabel{[pair4]match1}
                \item $\hmaymatch{e_2}{p_2}$ \BY{assumption} \pflabel{[pair4]maymatch2}
                \item $\csatisfy{e_1}{\xi_1}$ \BY{\pfref{[pair]true-equiv1} on \pfref{[pair4]match1}} \pflabel{[pair4]satisfy1}
                \item $\cmaysatisfy{e_2}{\xi_2}$ \BY{\pfref{[pair]may-equiv2} on \pfref{[pair4]maymatch2}} \pflabel{[pair4]maysat2}
                \item $\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:CMSPair2} on \pfref{[pair4]satisfy1} and \pfref{[pair4]maysat2}}
                \end{pfsteps*}
            \restorelocalsteps{3}
            \item[\text{(\ref{rule:MMPair})}]
                \begin{pfsteps*}
                \item $\hmaymatch{e_1}{p_1}$ \BY{assumption} \pflabel{[pair4]maymatch1'}
                \item $\hmaymatch{e_2}{p_2}$ \BY{assumption} \pflabel{[pair4]maymatch2'}
                \item $\cmaysatisfy{e_1}{\xi_1}$ \BY{\pfref{[pair]may-equiv1} on \pfref{[pair4]maymatch1'}} \pflabel{[pair4]maysat1'}
                \item $\cmaysatisfy{e_2}{\xi_2}$ \BY{\pfref{[pair]may-equiv2} on \pfref{[pair4]maymatch2'}} \pflabel{[pair4]maysat2'}
                \item $\hmaymatch{\hpair{e_1}{e_2}}{\hpair{p_1}{p_2}}$ \BY{\ruleref{rule:CMSPair3} on \pfref{[pair4]maysat1'} and \pfref{[pair4]maysat2'}}
                \end{pfsteps*}
            \end{byCases}
        \end{enumerate}
    \end{byCases}
\end{byCases}
\resetpfcounter
\end{proof}